Imputation of missing values
============================

.. currentmodule:: sklearn.impute

This module provides functionality for imputing missing values in datasets. Missing values can be replaced using various strategies including mean, median, most frequent value, or a constant value.

.. _simple_imputer:

SimpleImputer
-------------

.. autoclass:: SimpleImputer
   :members: fit, fit_transform, transform, get_feature_names_out
   :inherited-members:
   :exclude-members: set_output

The :class:`SimpleImputer` class provides basic strategies for imputing missing values. Missing values are replaced using statistics calculated along each column.

Parameters
~~~~~~~~~~
- **missing_values**: int, float, str, np.nan, None or pandas.NA, default=np.nan
    The placeholder value for missing data. All occurrences of this value will be imputed.

- **strategy**: str, default='mean'
    The imputation strategy to use:
    
    - "mean": Replace with column mean (numeric data only)
    - "median": Replace with column median (numeric data only)
    - "most_frequent": Replace with most frequent value (numeric or string data)
    - "constant": Replace with fill_value (numeric or string data)

- **fill_value**: str or numerical value, default=None
    Value to use for imputation when strategy="constant". For numeric data, defaults to 0. For string/object data, defaults to "missing_value".

- **copy**: bool, default=True
    If True, creates a copy of the input data. If False, imputation may be done in-place when possible.

- **add_indicator**: bool, default=False
    If True, a :class:`MissingIndicator` transform will stack onto the output of the imputer's transform.

- **keep_empty_features**: bool, default=False
    If True, features that consist exclusively of missing values are kept in the transformed output with their imputed value.

Attributes
~~~~~~~~~~
- **statistics_**: array of shape (n_features,)
    The imputation fill value for each feature.

- **indicator_**: :class:`MissingIndicator` or None
    Indicator used to add binary indicators for missing values. None if add_indicator=False.

- **n_features_in_**: int
    Number of features seen during fit.

- **feature_names_in_**: ndarray of shape (n_features_in_,)
    Names of features seen during fit.

Notes
~~~~~
- When using "most_frequent" strategy, ties are broken by selecting the smallest value.
- Inputs containing pd.NA are supported for pandas DataFrames with nullable integer dtypes.
- The imputer can handle both dense arrays and sparse matrices.

Examples
~~~~~~~~

>>> import numpy as np
>>> from sklearn.impute import SimpleImputer
>>> imp = SimpleImputer(missing_values=np.nan, strategy='mean')
>>> imp.fit([[1, 2], [np.nan, 3], [7, 6]])
SimpleImputer()
>>> X = [[np.nan, 2], [6, np.nan], [7, 6]]
>>> print(imp.transform(X))
[[4. 2.]
 [6. 3.666...]
 [7. 6.]]

Base Class
----------

.. autoclass:: _BaseImputer
   :members:
   :private-members:

The :class:`_BaseImputer` serves as the base class for all imputers, providing common functionality such as missing value indicator support.

Helper Functions
----------------

.. autofunction:: _check_inputs_dtype

Checks that the input data type is compatible with the specified missing values.

.. autofunction:: _most_frequent

Computes the most frequent value in a 1D array with optional extension values for tie-breaking.

See Also
--------
:class:`KNNImputer`: Multivariate imputer that estimates missing values using k-Nearest Neighbors.
:class:`IterativeImputer`: Multivariate imputer that estimates missing values using round-robin regression.

References
----------
.. [1] `Scikit-learn: Machine Learning in Python, Pedregosa et al., JMLR 12, pp. 2825-2830, 2011. <https://jmlr.org/papers/v12/pedregosa11a.html>`_

.. [2] `Statistical Analysis with Missing Data, Little and Rubin, Wiley, 2002. <https://www.wiley.com/en-us/Statistical+Analysis+with+Missing+Data%2C+3rd+Edition-p-9780470526798>`_