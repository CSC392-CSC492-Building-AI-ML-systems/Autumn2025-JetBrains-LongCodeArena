Working with User Security Roles
================================

The ftrack API provides functionality to manage and interact with user security roles. Security roles in ftrack define the permissions and access levels for users within the system.

Authentication and Session Setup
--------------------------------

To work with security roles, you must first establish an authenticated session with the ftrack server. The session requires:

- **server_url**: The URL of the ftrack server (can be set via FTRACK_SERVER environment variable)
- **api_key**: Your API key for authentication (can be set via FTRACK_API_KEY environment variable)
- **api_user**: The username to record operations against (can be set via FTRACK_API_USER environment variable)

Example session creation:

.. code-block:: python

    import ftrack_api
    
    session = ftrack_api.Session(
        server_url='https://your-ftrack-server.com',
        api_key='your-api-key',
        api_user='your-username'
    )

Role Management Operations
--------------------------

Once authenticated, you can perform various operations related to security roles:

**Querying Roles**
.. code-block:: python

    # Get all security roles
    all_roles = session.query('SecurityRole').all()
    
    # Find a specific role by name
    admin_role = session.query('SecurityRole where name is "Administrator"').one()

**Managing User Roles**
.. code-block:: python

    # Assign a role to a user
    user = session.query('User where username is "john.doe"').one()
    role = session.query('SecurityRole where name is "Artist"').one()
    
    user['security_roles'].append(role)
    session.commit()

**Checking Permissions**
.. code-block:: python

    # Check if user has a specific role
    user_has_role = any(role['name'] == 'Reviewer' for role in user['security_roles'])

Best Practices
--------------

- Always validate role assignments before committing changes
- Use specific role queries rather than loading all roles when possible
- Check existing user roles before making modifications
- Handle exceptions for permission-related operations

Error Handling
--------------

Common exceptions when working with security roles:
- ``ftrack_api.exception.ServerError``: When insufficient permissions
- ``ftrack_api.exception.NotFoundError``: When role or user doesn't exist
- ``ftrack_api.exception.ValidationError``: When role assignment is invalid

Note: The actual permission to modify security roles requires appropriate administrative privileges in the ftrack system.