# HDF5 File Reader Documentation

## Overview

The `HDF5Reader` class provides a flexible interface for reading and transforming HDF5 datasets. This documentation covers the transformation functions available for processing HDF5 data within the Masci-tools package.

## Transformation Functions

All transformation functions are designed to handle three different input types:
1. Raw h5py.Dataset objects
2. Numpy arrays (already extracted datasets)
3. Dictionaries of datasets (for processing multiple datasets simultaneously)

### Basic Transformations

#### get_first_element(dataset)
Returns the first element of the dataset.

**Parameters:**
- `dataset`: Input dataset to transform

**Returns:** First element of the dataset

#### index_dataset(dataset, index)
Returns the n-th element of the dataset.

**Parameters:**
- `dataset`: Input dataset to transform
- `index`: Index of the element to extract

**Returns:** Element at the specified index

#### slice_dataset(dataset, slice_arg)
Slices the dataset with the given slice argument.

**Parameters:**
- `dataset`: Input dataset to transform
- `slice_arg`: Slice to apply to the dataset

**Returns:** Sliced dataset

#### get_shape(dataset)
Returns the shape of the dataset.

**Parameters:**
- `dataset`: Input dataset

**Returns:** Shape of the dataset as a tuple or dictionary of shapes

#### get_name(dataset, full_path=False)
Returns the name of the dataset.

**Parameters:**
- `dataset`: Input dataset
- `full_path`: If True, returns the full path to the dataset

**Returns:** Name of the dataset (last path component or full path)

### Array Operations

#### tile_array(dataset, n_repeats)
Uses numpy.tile to repeat array n-times.

**Parameters:**
- `dataset`: Input dataset to transform
- `n_repeats`: Number of times to repeat the array

**Returns:** Dataset repeated n-times

#### repeat_array(dataset, n_repeats)
Uses numpy.repeat to repeat each element in array n-times.

**Parameters:**
- `dataset`: Input dataset to transform
- `n_repeats`: Number of times to repeat each element

**Returns:** Dataset with elements repeated n-times

### Group Operations

#### get_all_child_datasets(group, ignore=None, contains=None)
Retrieves all datasets contained in the given group.

**Parameters:**
- `group`: h5py group object to extract from
- `ignore`: str or iterable of strings - keys to ignore
- `contains`: str or iterable of strings - phrases that must be present in the key

**Returns:** Dictionary with contained datasets using their names as keys

## Error Handling

All transformations are wrapped in error handling that catches exceptions and re-raises them as `HDF5TransformationError` with a descriptive message indicating which transformation failed.

## Usage

Transformations are registered with the `HDF5Reader` class using the `@hdf5_transformation` decorator. The `attribute_needed` parameter indicates whether the transformation requires a previously processed attribute value.

```python
from masci_tools.io.parsers.hdf5.reader import HDF5Reader

# Use transformations through the HDF5Reader interface
reader = HDF5Reader()
result = reader.read_dataset('path/to/dataset', transformations=['get_first_element'])
```

## License

This code is part of the Masci-tools package, developed by Forschungszentrum JÃ¼lich GmbH, IAS-1/PGI-1, Germany. The code is hosted on GitHub at https://github.com/judftteam/masci-tools.