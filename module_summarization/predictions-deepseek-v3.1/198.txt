Nearest Neighbors
================

The `neighbors` module implements nearest neighbor algorithms for efficient querying of point distances and nearest neighbors.

Ball Tree
---------

The `BallTree` class is a binary tree data structure for organizing points in a multi-dimensional space, enabling efficient range and nearest neighbor queries. It is particularly effective for higher-dimensional data and supports various distance metrics.

Two implementations are provided for different data types:

- `BallTree64`: For data of type `np.float64`
- `BallTree32`: For data of type `np.float32`

Both classes inherit from their respective `BinaryTree` base classes and share the same interface and functionality, differing only in the internal data representation.

Supported Distance Metrics
~~~~~~~~~~~~~~~~~~~~~~~~~~

The following distance metrics are supported for each implementation:

- BrayCurtisDistance
- CanberraDistance
- ChebyshevDistance
- DiceDistance
- EuclideanDistance
- HammingDistance
- HaversineDistance
- JaccardDistance
- MahalanobisDistance
- ManhattanDistance
- MinkowskiDistance
- PyFuncDistance
- RogersTanimotoDistance
- RussellRaoDistance
- SEuclideanDistance
- SokalMichenerDistance
- SokalSneathDistance
- WMinkowskiDistance

Each metric is available with both 32-bit and 64-bit precision variants (suffixed with either '32' or '64').

Implementation Details
~~~~~~~~~~~~~~~~~~~~~~

The Ball Tree implementation uses the concept of "reduced distance" for optimization. The reduced distance is a computationally efficient quantity that preserves distance rankings. For example, the squared Euclidean distance is used as the reduced distance for the Euclidean metric.

Key internal functions include:

- `allocate_data()`: Allocates memory for node bounds arrays
- `init_node()`: Computes node centroids and radii during tree construction
- `min_dist()`: Computes the minimum distance between a point and a node
- `max_dist()`: Computes the maximum distance between a point and a node

The implementation supports weighted datasets when sample weights are provided, affecting the computation of node centroids and distances.

Usage
~~~~~

Typically, users will interact with the high-level `NearestNeighbors` interface, which automatically selects the appropriate algorithm and data type implementation based on the input data and parameters. The Ball Tree is particularly useful for:

- High-dimensional data queries
- Applications requiring custom distance metrics
- Cases where data structure construction time can be amortized over many queries

See the `NearestNeighbors` class documentation for more details on usage and parameter configuration.