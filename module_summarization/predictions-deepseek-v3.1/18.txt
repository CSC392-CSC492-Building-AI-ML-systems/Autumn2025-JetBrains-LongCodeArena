w_bins
======

Display information and statistics about binning in a WEST simulation, or modify the binning for the current iteration of a WEST simulation.

Synopsis
--------

.. code-block:: bash

    w_bins info [-h] [-n N_ITER] [--detail] [BINNING_OPTIONS]
    w_bins rebin [-h] [--confirm] [--detail] [-n N_ITER] [BINNING_OPTIONS] [TARGET_COUNT_OPTIONS]

Description
-----------

The ``w_bins`` tool provides two subcommands for working with binning in WEST simulations:

- ``info``: Display information about the current binning configuration
- ``rebin``: Rebuild the current iteration with new binning parameters

Both subcommands operate on a specified iteration (default: current iteration) and support various binning configuration options.

Subcommands
-----------

info
~~~~

Display information about binning for a specific iteration.

**Options:**

- ``-h, --help``: Show help message and exit
- ``-n N_ITER, --n-iter N_ITER``: Consider initial points of segment N_ITER (default: current iteration)
- ``--detail``: Display detailed per-bin information in addition to summary information

**Binning Options:** (See Binning Configuration section)

rebin
~~~~~

Rebuild current iteration with new binning. This command allows you to modify the binning scheme for a specific iteration and optionally commit the changes to the HDF5 file.

**Options:**

- ``-h, --help``: Show help message and exit
- ``--confirm``: Commit the revised iteration to HDF5; without this option, the effects of the new binning are only calculated and printed
- ``--detail``: Display detailed per-bin information in addition to summary information
- ``-n N_ITER, --n-iter N_ITER``: Consider initial points of segment N_ITER (default: current iteration)

**Binning Options:** (See Binning Configuration section)
**Target Count Options:** (See Target Count Configuration section)

Binning Configuration
---------------------

The binning options allow you to specify how the progress coordinate space should be divided into bins:

- ``--bins-from-file FILENAME``: Load bin boundaries from file (not available for rebin subcommand)
- ``--bins-from-system``: Use bin boundaries from system (default)
- ``--bins-from-function``: Use bin boundaries from function
- ``--bins-from-expr EXPR``: Use bin boundaries from expression
- ``--bins-from-expr-file FILENAME``: Use bin boundaries from expression file

Target Count Configuration
--------------------------

(For rebin subcommand only) Options to specify target counts for bins:

- ``--target-counts TARGET_COUNTS``: Target counts for each bin (comma-separated)
- ``--target-counts-from-file FILENAME``: Load target counts from file
- ``--target-counts-from-function``: Use target counts from function
- ``--target-counts-from-expr EXPR``: Use target counts from expression
- ``--target-counts-from-expr-file FILENAME``: Use target counts from expression file

Notes
-----

- The ``rebin`` command is not supported for the first iteration (use ``w_init`` instead)
- When using ``rebin`` without ``--confirm``, changes are calculated and displayed but not saved
- The tool requires access to the WEST HDF5 data file and appropriate permissions for modification operations
- Detailed output includes per-bin information such as population statistics and weight distributions

Examples
--------

Display bin information for iteration 100:

.. code-block:: bash

    w_bins info -n 100

Display detailed bin information for current iteration:

.. code-block:: bash

    w_bins info --detail

Test rebinning for iteration 50 without saving:

.. code-block:: bash

    w_bins rebin -n 50 --detail

Apply new binning to iteration 50 and save changes:

.. code-block:: bash

    w_bins rebin -n 50 --confirm

See Also
--------

- ``w_init`` - Initialize a new WEST simulation
- ``w_run`` - Run a WEST simulation
- ``w_assign`` - Assign trajectories to bins