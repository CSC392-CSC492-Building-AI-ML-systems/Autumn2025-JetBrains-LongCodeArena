w_run
=====

The ``w_run`` command is used to start or continue a WESTPA simulation. It initializes the necessary components, such as the work manager, simulation manager, system driver, data manager, WE driver, and propagator, then executes the simulation run.

Synopsis
--------

.. code-block:: bash

   w_run [--oneseg] [WESTPA options] [work manager options]

Description
-----------

The ``w_run`` command performs the following steps:

1. Parses command-line arguments, including WESTPA-specific options and work manager configuration.
2. Initializes the work manager based on the provided arguments.
3. Loads the simulation manager, system driver, data manager, WE driver, and propagator from the WESTPA runtime configuration.
4. Sets necessary cross-references between these components.
5. Executes the simulation within the context of the work manager:
   - On the master process: prepares the run, executes the simulation, and finalizes the run, with appropriate error and interrupt handling.
   - On worker processes: runs the work manager to process tasks.

Options
-------

--oneseg
   If provided, only one segment is propagated. This is useful for debugging propagators.

In addition to the above, ``w_run`` accepts all standard WESTPA configuration options and work manager options. These are added automatically via ``westpa.rc.add_args()`` and ``work_managers.environment.add_wm_args()``.

Error Handling
--------------

The command handles interruptions and exceptions gracefully:

- Keyboard interrupts (e.g., Ctrl-C) result in a clean shutdown with an appropriate status message.
- Other exceptions are caught, logged with a traceback, and trigger a shutdown.

Examples
--------

To start a simulation with default settings:

.. code-block:: bash

   w_run

To run only one segment for debugging:

.. code-block:: bash

   w_run --oneseg

To run with a specific work manager and additional options:

.. code-block:: bash

   w_run --work-manager=threads --n-workers=4

See Also
--------

- The WESTPA documentation for overall configuration and setup.
- ``westpa.work_managers`` for details on available work managers and their options.