w_multi_west
============

Tool designed to combine multiple WESTPA simulations while accounting for reweighting.

Synopsis
--------

.. code-block:: bash

   w_multi_west [options] [SIMULATION_DIRECTORIES...]

Description
-----------

The ``w_multi_west`` tool is designed to combine data from multiple WESTPA simulation trajectories while properly handling reweighting across different simulation runs. It aggregates data from multiple west.h5 files and produces a combined output file with proper statistical treatment of weighted ensembles.

Options
-------

Input/Output Options
~~~~~~~~~~~~~~~~~~~~

``-o, --output-file OUTPUT_FILE``
    Specify the name of the output file to store results in (default: 'multi.h5').

``-W, --west, --WEST_H5FILE WEST_H5FILE``
    Specify the name of the main HDF5 file inside each simulation directory (default: 'west.h5').

``-a, --aux AUX_DATASET``
    Names of additional auxiliary datasets to be combined. Can be specified multiple times.

``-aa, --auxall``
    Combine all auxiliary datasets (default: False).

``-nr, --no-reweight``
    Do not perform reweighting (default: False).

``-ib, --ibstates``
    Attempt to combine ibstates dataset (default: False).

Progress Options
~~~~~~~~~~~~~~~~

The tool includes standard progress indicator options through the ``--quiet``, ``--verbose``, and ``--progress`` flags for controlling output verbosity during execution.

Implementation Details
----------------------

The tool works by:

1. Opening multiple WESTPA HDF5 files from different simulation directories
2. Processing iteration data while maintaining proper weight accounting
3. Handling bin mapping across different simulations using hash-based bin topology identification
4. Supporting combination of auxiliary datasets and initial state information
5. Providing options for reweighting control and statistical aggregation

The implementation includes specialized data handling for:

- Bin mapper retrieval using hash-based lookup from binning tables
- Initial state data type conversion and preservation
- Weighted ensemble statistics aggregation
- Memory management through garbage collection

The tool is built on the WESTMultiTool framework and includes progress indication capabilities for monitoring long-running combination operations.

Note: The tool assumes compatible initial states across simulations by default, but provides options for handling cases where this assumption may not hold.