.. _rand_augment:

RandAugment
===========

The ``rand_augment`` module implements the RandAugment data augmentation scheme as described in the paper "RandAugment: Practical automated data augmentation with a reduced search space" (https://arxiv.org/abs/1909.13719).

Overview
--------

RandAugment is a automated data augmentation approach that randomly samples and applies ``n`` augmentation operations from a predefined set, each with magnitude ``m``. This module provides a simplified interface for applying RandAugment transformations to image and video data in DALI pipelines.

Functions
---------

.. autofunction:: nvidia.dali.auto_aug.rand_augment.rand_augment

.. autofunction:: nvidia.dali.auto_aug.rand_augment.apply_rand_augment

Parameters
----------

The main ``rand_augment`` function accepts the following parameters:

- ``data``: Input batch of samples (images of HWC layout or videos of FHWC layout, uint8 type)
- ``n``: Number of randomly sampled operations to apply per sample
- ``m``: Magnitude/strength of each operation (integer between 0 and num_magnitude_bins-1)
- ``num_magnitude_bins``: Number of bins for magnitude discretization (default: 31)
- ``shape``: Optional image/frame dimensions for translation magnitude scaling
- ``fill_value``: Padding value for affine transformations (default: 128)
- ``interp_type``: Interpolation method for affine operations
- ``max_translate_abs``: Maximum absolute translation in pixels (when shape not provided)
- ``max_translate_rel``: Maximum relative translation as fraction of shape
- ``seed``: Random seed for operation sampling and magnitude negation
- ``monotonic_mag``: Whether to use monotonic magnitude ranges (default: True)
- ``excluded``: List of operation names to exclude from the default suite

Supported Augmentations
-----------------------

The default RandAugment suite includes various image transformations such as:

- Identity
- AutoContrast
- Equalize
- Rotate
- Solarize
- Color
- Posterize
- Contrast
- Brightness
- Sharpness
- ShearX/Y
- TranslateX/Y

Usage Examples
--------------

Basic usage with images:

.. code-block:: python

    import nvidia.dali as dali
    from nvidia.dali.auto_aug import rand_augment
    
    @dali.pipeline_def
    def pipeline():
        images = dali.fn.readers.file(file_root=image_dir)
        decoded = dali.fn.decoders.image(images, device='mixed')
        augmented = rand_augment(decoded, n=2, m=10)
        return augmented

Advanced usage with custom parameters:

.. code-block:: python

    augmented = rand_augment(
        data=images,
        n=3,
        m=15,
        shape=(224, 224),
        fill_value=0,
        interp_type=dali.types.INTERP_LINEAR,
        excluded=['Solarize', 'Posterize']
    )

Notes
-----

- The module supports both monotonic and non-monotonic magnitude ranges for compatibility with different implementations
- Translation magnitude can be specified in absolute pixels or relative to image shape
- Custom augmentation suites can be created and applied using ``apply_rand_augment`` directly
- The implementation is optimized for performance on NVIDIA GPUs through DALI's accelerated image processing pipeline