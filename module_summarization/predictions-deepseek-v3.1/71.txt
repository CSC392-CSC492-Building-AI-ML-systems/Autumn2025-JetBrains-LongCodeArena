.. _kernel_ridge:

Kernel Ridge
============

.. currentmodule:: sklearn.kernel_ridge

The :mod:`sklearn.kernel_ridge` module implements kernel ridge regression.

.. autoclass:: KernelRidge
   :members:
   :inherited-members:
   :exclude-members: _get_kernel, _parameter_constraints
   :show-inheritance:

Kernel ridge regression (KRR) combines ridge regression (linear least squares with l2-norm regularization) with the kernel trick. It learns a linear function in the space induced by the respective kernel and the data. For non-linear kernels, this corresponds to a non-linear function in the original space.

The form of the model learned by KRR is identical to support vector regression (SVR), but uses squared error loss instead of epsilon-insensitive loss. Fitting a KRR model can be done in closed-form and is typically faster for medium-sized datasets, though the learned model is non-sparse and thus slower at prediction-time than SVR.

This estimator has built-in support for multi-variate regression (when y is a 2d-array of shape [n_samples, n_targets]).

Examples
--------
>>> from sklearn.kernel_ridge import KernelRidge
>>> import numpy as np
>>> n_samples, n_features = 10, 5
>>> rng = np.random.RandomState(0)
>>> y = rng.randn(n_samples)
>>> X = rng.randn(n_samples, n_features)
>>> krr = KernelRidge(alpha=1.0)
>>> krr.fit(X, y)
KernelRidge(alpha=1.0)

See Also
--------
:class:`sklearn.gaussian_process.GaussianProcessRegressor` : Gaussian Process regressor providing automatic kernel hyperparameters tuning and predictions uncertainty.

:class:`sklearn.linear_model.Ridge` : Linear ridge regression.

:class:`sklearn.linear_model.RidgeCV` : Ridge regression with built-in cross-validation.

:class:`sklearn.svm.SVR` : Support Vector Regression accepting a large variety of kernels.

References
----------
* Kevin P. Murphy "Machine Learning: A Probabilistic Perspective", The MIT Press chapter 14.4.3, pp. 492-493

Notes
-----
This implementation is based on the closed-form solution for kernel ridge regression and supports both precomputed kernels and various kernel functions through the pairwise metrics module.