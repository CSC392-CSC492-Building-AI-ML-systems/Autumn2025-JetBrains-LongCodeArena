Encoding Media
==============

The ftrack API provides support for encoding media through the session's encoding functionality. This allows for the conversion and processing of media files, such as images and videos, to be stored and managed within the ftrack system.

Authentication
--------------

Media encoding operations require a valid session with the ftrack server. The session must be authenticated using an API key and user, which can be provided during session initialization or through environment variables:

.. code-block:: python

    import ftrack_api

    session = ftrack_api.Session(
        server_url='https://your-ftrack-server',
        api_key='your-api-key',
        api_user='your-username'
    )

If not provided explicitly, the session will attempt to retrieve these values from the environment variables ``FTRACK_SERVER``, ``FTRACK_API_KEY``, and ``FTRACK_API_USER``.

Basic Usage
-----------

To encode media, you typically need to:

1. Create a media object or locate an existing one
2. Prepare the media file for encoding
3. Use the session's encoding methods to process the media

Example:

.. code-block:: python

    # Create a new media component
    media_component = session.create('Component', {
        'name': 'example_media',
        'file_type': '.mp4'
    })
    
    # Encode the media (pseudo-code - actual method may vary)
    encoding_job = session.encode_media(
        component=media_component,
        source_path='/path/to/source/file.mov',
        preset='h264_high_quality'
    )
    
    # Wait for encoding to complete
    encoding_job.wait()

Supported Formats
-----------------

The ftrack API supports encoding to various media formats through configurable presets. Common formats include:

- H.264 MP4
- ProRes MOV
- WebM
- Image sequences (PNG, JPEG, EXR)

Encoding Options
----------------

When encoding media, you can specify various options through encoding presets:

- Resolution and aspect ratio
- Bitrate and quality settings
- Frame rate conversion
- Audio encoding parameters
- Thumbnail generation

Error Handling
--------------

Media encoding operations may raise exceptions for various reasons:

- Unsupported file formats
- Invalid encoding parameters
- Server connectivity issues
- Insufficient permissions

Always wrap encoding operations in appropriate exception handling:

.. code-block:: python

    try:
        encoding_job = session.encode_media(...)
        encoding_job.wait()
    except ftrack_api.exception.ServerError as error:
        print(f"Encoding failed: {error}")
    except ftrack_api.exception.NotFoundError as error:
        print(f"Media component not found: {error}")

Best Practices
--------------

- Always verify source file existence before encoding
- Use appropriate encoding presets for your use case
- Monitor encoding progress for large files
- Clean up temporary files after encoding completion
- Implement retry logic for transient network issues

Note: The specific encoding methods and their signatures may vary depending on your ftrack API version and server configuration. Always consult the latest API documentation for your specific implementation.