=================
Filter Classes
=================

The filter system provides a way to subscribe to and monitor various types of
blockchain events including new blocks, transactions, logs, and whisper messages.

Base Filter Class
-----------------

.. autoclass:: Filter
   :members:
   :inherited-members:
   :show-inheritance:

   The base Filter class provides the core functionality for all filter types.
   It runs as a greenlet and continuously polls for changes.

   **Methods**:

   .. automethod:: watch
   .. automethod:: stop_watching
   .. automethod:: format_entry
   .. automethod:: is_valid_entry

   **Attributes**:

   - ``filter_id``: The unique identifier for this filter
   - ``web3``: Web3 instance reference
   - ``callbacks``: List of callback functions to be executed on new entries
   - ``running``: Boolean indicating if the filter is actively watching
   - ``stopped``: Boolean indicating if the filter has been stopped
   - ``poll_interval``: Optional custom polling interval

Specialized Filter Classes
--------------------------

Block Filter
~~~~~~~~~~~~

.. autoclass:: BlockFilter
   :show-inheritance:

   Monitors new blocks being added to the blockchain.

Transaction Filter
~~~~~~~~~~~~~~~~~~

.. autoclass:: TransactionFilter
   :show-inheritance:

   Monitors new transactions being added to the blockchain.

Log Filter
~~~~~~~~~~

.. autoclass:: LogFilter
   :members: get, set_data_filters
   :inherited-members:
   :show-inheritance:

   Monitors event logs that match specific criteria. Supports data filtering
   using regular expressions.

   **Additional Methods**:

   .. automethod:: get
   .. automethod:: set_data_filters

Past Log Filter
~~~~~~~~~~~~~~~

.. autoclass:: PastLogFilter
   :show-inheritance:

   Retrieves and processes historical log entries that match the filter criteria.

Whisper Filter
~~~~~~~~~~~~~~

.. autoclass:: ShhFilter
   :show-inheritance:

   Monitors whisper messages using the Whisper protocol.

Utility Functions
-----------------

.. autofunction:: construct_event_filter_params

   Constructs filter parameters for event filtering based on ABI and arguments.

.. autofunction:: construct_data_filter_regex

   Creates a regular expression pattern for data filtering in log entries.

Constants
---------

.. data:: ZERO_32BYTES

   Regular expression pattern matching 32 bytes of zeros: ``[a-f0-9]{64}``

Usage Example
-------------

.. code-block:: python

   # Create a filter for new blocks
   block_filter = BlockFilter(web3, filter_id)
   block_filter.watch(lambda block: print(f"New block: {block['number']}"))
   
   # Create a log filter with data filtering
   log_filter = LogFilter(web3, filter_id, data_filter_set=data_filters)
   log_filter.watch(lambda log: print(f"New log: {log}"))

Notes
-----

- All filters must be properly stopped using ``stop_watching()`` to clean up resources
- Filters run in separate greenlets for asynchronous operation
- Custom polling intervals can be set via the ``poll_interval`` attribute
- Data filtering for logs uses regular expression matching on the data field