.. _async:

Asynchronous Plans
==================

This module provides plans for asynchronous data acquisition and scanning operations, primarily used in the Bluesky framework for experimental control and data collection.

.. currentmodule:: bluesky.plans

.. autofunction:: count

.. autofunction:: list_scan

.. autofunction:: rel_list_scan

Functions
---------

.. py:function:: count(detectors, num=1, delay=None, *, per_shot=None, md=None)
   :noindex:

   Take one or more readings from detectors.

   :param detectors: List of 'readable' objects
   :type detectors: list
   :param num: Number of readings to take (default is 1). If None, capture data until canceled.
   :type num: integer, optional
   :param delay: Time delay in seconds between successive readings (default is 0)
   :type delay: iterable or scalar, optional
   :param per_shot: Hook for customizing action of inner loop (messages per step)
   :type per_shot: callable, optional
   :param md: Additional metadata
   :type md: dict, optional
   :returns: Generator yielding bluesky messages

   The per_shot parameter expects a callable with signature::
   
      def f(detectors: Iterable[OphydObj]) -> Generator[Msg]:
         ...

   If ``delay`` is an iterable, it must have at least ``num - 1`` entries or the plan will raise a ``ValueError`` during iteration.

.. py:function:: list_scan(detectors, *args, per_step=None, md=None)
   :noindex:

   Scan over one or more variables in steps simultaneously (inner product).

   :param detectors: List of 'readable' objects
   :type detectors: list
   :param \\*args: Motor and position list pairs in the format: motor, [point1, point2,...]
   :param per_step: Hook for customizing action of inner loop (messages per step)
   :type per_step: callable, optional
   :param md: Additional metadata
   :type md: dict, optional
   :returns: Generator yielding bluesky messages
   :raises ValueError: If number of arguments is not even or if position lists have different lengths

   The per_step parameter expects a callable with signature::
   
      f(detectors, motor, step) -> plan (a generator)

   Motors can be any 'settable' object (motor, temperature controller, etc.)

   .. seealso:: :func:`rel_list_scan`, :func:`list_grid_scan`, :func:`rel_list_grid_scan`

.. py:function:: rel_list_scan(detectors, *args, per_step=None, md=None)
   :noindex:

   Scan over one variable in steps relative to current position.

   :param detectors: List of 'readable' objects
   :type detectors: list
   :param \\*args: Motor and relative position list pairs
   :param per_step: Hook for customizing action of inner loop (messages per step)
   :type per_step: callable, optional
   :param md: Additional metadata
   :type md: dict, optional
   :returns: Generator yielding bluesky messages

   Points in the position lists are relative to the current location of each motor.

   .. seealso:: :func:`list_scan`, :func:`list_grid_scan`, :func:`rel_list_grid_scan`

Notes
-----

These plans utilize various decorators and utilities from the Bluesky framework including:

- Stage and run decorators for device management and metadata handling
- Plan patterns for organizing scan logic
- Message generators for experimental control flow

The functions return generators that yield :class:`bluesky.utils.Msg` objects, which are processed by the Bluesky RunEngine to execute the experimental procedures.