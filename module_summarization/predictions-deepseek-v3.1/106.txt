hyperexpand
==========

The ``hyperexpand`` module provides functionality to expand hypergeometric (and Meijer G) functions into named special functions. The algorithm uses lookup tables of hypergeometric functions and their properties to perform these expansions.

Algorithm Basis
---------------
The expansion algorithm is based on the paper:

- Kelly B. Roach. Meijer G Function Representations. In: Proceedings of the 1997 International Symposium on Symbolic and Algebraic Computation, pages 205-211, New York, 1997. ACM.

A more detailed description is available in the Sphinx documentation.

Key Extensions for Meijer G Functions
-------------------------------------

- Scaling: :math:`z^{\rho} G(ap, bq; z) = G(ap + \rho, bq + \rho; z)`
- Shift operators:
  - :math:`A_J = b_J - D` for :math:`J = 1,\dots, n`
  - :math:`B_J = 1 - a_j + D` for :math:`J = 1,\dots, m`
  - :math:`C_J = -b_J + D` for :math:`J = m+1,\dots, q`
  - :math:`D_J = a_J - 1 - D` for :math:`J = n+1,\dots, p`
- Order reduction via polynomial simplification and index theorems.
- Concept of "suitable" index quadruples and reachability via shift operators.

Module Components
-----------------

The module includes:

- ``FormulaCollection``: A collection of predefined expansion formulae.
- ``add_formulae``: Function to populate the knowledge base with expansion rules.
- Support for various special functions (e.g., Bessel, gamma, error functions).

Example Expansions
------------------

Below are some of the expansion formulae implemented:

.. math::
  \operatorname{hyper}{\left(\left\{  \right\},\left\{  \right\},z \right)} = e^{z}

.. math::
  \operatorname{hyper}{\left(\left\{ a \right\},\left\{  \right\},z \right)} = \begin{cases} 1 & \text{for}\: z = 0 \\\left(- z + 1\right)^{- a} & \text{otherwise} \end{cases}

.. math::
  \operatorname{hyper}{\left(\left\{ a,a - \frac{1}{2} \right\},\left\{ 2 a \right\},z \right)} = \frac{2^{2 a - 1} \left(\sqrt{- z + 1} + 1\right)^{- 2 a + 1}}{\sqrt{- z + 1}}

.. math::
  \operatorname{hyper}{\left(\left\{ 1,1 \right\},\left\{ 2 \right\},z \right)} = - \frac{\log{\left(- z + 1 \right)}}{z}

.. math::
  \operatorname{hyper}{\left(\left\{ \frac{1}{2},1 \right\},\left\{ \frac{3}{2} \right\},z \right)} = \frac{\operatorname{atanh}{\left(\sqrt{z} \right)}}{\sqrt{z}}

(Additional expansions are implemented in the code.)

Implementation Notes
--------------------

- The module uses symbolic manipulation from SymPy core and functions.
- Hand-built routines are used to match and instantiate formulas due to the complexity of deciding reachability between index quadruples.
- Parameters are often handled using dummy symbols to avoid conflicts.

See the source code and the associated paper for more in-depth information.