`plothist`
========

The `plothist` command is used to generate plots from histogram data stored in HDF5 files, typically produced by WESTPA simulations. It supports one-dimensional and two-dimensional histogram visualization with various scaling options and output formats.

Command Line Usage
------------------

.. code-block:: bash

   w_plothist [options] input.h5 [DIMENSION]

Required Arguments
------------------

**input.h5**
  HDF5 file containing histogram data to be plotted.

Optional Arguments
------------------

**DIMENSION**
  Plot specification for a given dimension, formatted as ``INT[:[LB,UB]:LABEL]`` where:
  
  - ``INT``: Zero-based integer identifying the dimension in the histogram
  - ``LB``, ``UB``: Lower and upper bounds for plotting (optional)
  - ``LABEL``: Label for the plot axis (optional)
  
  Default: dimension 0 with full range.

Input Options
-------------

These options control input data handling and selection.

**--firstdim DIMENSION**
  Alternative way to specify the dimension to plot (same format as above).

Plot Options
------------

**--title TITLE**
  Set the top-of-graph title to TITLE.

**--linear**
  Plot the histogram on a linear scale.

**--energy**
  Plot on an inverted natural log scale (free energy scale). This is the default.

**--log10**
  Plot the histogram on a base-10 log scale.

**--zero-energy E**
  Set the zero of energy to E, which can be a numeric value, "min", or "max". Default: "min".

**--range LB,UB**
  Set the ordinate range for plotting. For 1-D plots, this controls the Y-axis range. For 2-D plots, this controls the colorbar range.

**--postprocess-function MODULE.FUNCTION**
  Specify a function to be called just prior to saving the plot. The function should accept parameters ``(hist, midpoints, binbounds)`` and modify the plot using pyplot's stateful interface.

Output Options
--------------

**-o, --output, --plot-output PLOT_OUTPUT**
  Save plot to PLOT_OUTPUT. Format is determined by file extension (default: PDF). Set to empty string to suppress plotting. Default: "hist.pdf".

**--hdf5-output HDF5_OUTPUT**
  Store plot data in HDF5_OUTPUT.

**--plot-contour**
  For 2D plots, superimpose a contour plot over the heatmap.

Examples
--------

Plot dimension 0 with default energy scaling:

.. code-block:: bash

   w_plothist hist.h5

Plot dimension 1 with specific range and linear scale:

.. code-block:: bash

   w_plothist hist.h5 1:[-5,5]:RMSD --linear --range 0,100

Plot with custom title and energy zero point:

.. code-block:: bash

   w_plothist hist.h5 --title "Free Energy Surface" --zero-energy -2.5

Notes
-----

- The command automatically detects available iteration ranges from the input HDF5 file
- Multiple dimensions can be specified for 2D plotting
- Divide-by-zero errors in logarithmic calculations are automatically suppressed
- The tool supports both uniform and non-uniform histogram binning through matplotlib's NonUniformImage