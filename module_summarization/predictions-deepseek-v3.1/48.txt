`discretemod.rst`
==============

Zero-Inflated Count Models
--------------------------

This module provides implementations of zero-inflated count models for handling overdispersed count data with excess zeros. The models combine a binary process for zero inflation with standard count distributions.

Available Models
----------------

- ``ZeroInflatedPoisson``: Zero-inflated Poisson model
- ``ZeroInflatedGeneralizedPoisson``: Zero-inflated generalized Poisson model  
- ``ZeroInflatedNegativeBinomialP``: Zero-inflated negative binomial model

GenericZeroInflated Class
-------------------------

The ``GenericZeroInflated`` class serves as the base class for all zero-inflated models, providing common functionality for parameter estimation and inference.

Parameters
~~~~~~~~~~

**endog** : array_like
    Endogenous response variable (dependent variable)

**exog** : array_like  
    Exogenous design matrix for the count model

**exog_infl** : array_like or None, optional
    Explanatory variables for the binary inflation model (mixing probability model). If None, a constant is used.

**offset** : array_like, optional
    Offset added to linear prediction with coefficient equal to 1

**exposure** : array_like, optional  
    Log(exposure) added to linear prediction with coefficient equal to 1

**inflation** : {'logit', 'probit'}, default 'logit'
    Model for zero inflation - either Logit or Probit

**missing** : str, optional  
    Missing value handling method

Attributes
~~~~~~~~~~

**endog** : array
    Reference to endogenous response variable

**exog** : array
    Reference to exogenous design matrix

**exog_infl** : array  
    Reference to zero-inflation exogenous design matrix

**k_inflate** : int
    Number of parameters in inflation model

**k_exog** : int
    Number of parameters in main count model

Methods
~~~~~~~

**loglike(params)**
    Log-likelihood of the zero-inflated model

**loglikeobs(params)**  
    Log-likelihood for each observation of the model

**fit(start_params=None, method='bfgs', maxiter=35, full_output=1, disp=1, callback=None, cov_type='nonrobust', cov_kwds=None, use_t=None, **kwargs)**
    Fit the model using maximum likelihood estimation

Model Specification
-------------------

The zero-inflated models combine two processes:

1. A binary process that generates structural zeros with probability w_i
2. A count process that generates counts (including zeros) from the main distribution

The log-likelihood function is:

.. math::
   \ln L = \sum_{y_i=0} \ln(w_i + (1-w_i) \cdot P_{main}) + \sum_{y_i>0} (\ln(1-w_i) + L_{main})

where:
- :math:`P_{main}` is the PDF of the main count model
- :math:`L_{main}` is the log-likelihood of the main count model
- :math:`w_i` is the inflation probability from the binary model

Usage Example
-------------

.. code-block:: python

   from statsmodels.discrete.discrete_model import ZeroInflatedPoisson
   import numpy as np
   
   # Example data
   endog = np.random.randint(0, 10, 100)
   exog = np.random.randn(100, 2)
   exog_infl = np.random.randn(100, 1)
   
   # Fit model
   model = ZeroInflatedPoisson(endog, exog, exog_infl=exog_infl)
   results = model.fit()
   print(results.summary())

Notes
-----

- The module handles both logit and probit link functions for the zero-inflation component
- Supports offset and exposure variables
- Uses maximum likelihood estimation with various optimization methods
- Provides robust covariance matrix options