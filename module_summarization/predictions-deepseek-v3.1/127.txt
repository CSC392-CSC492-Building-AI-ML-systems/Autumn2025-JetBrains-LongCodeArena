.. _kernels:

Built-in Kernels
================

The ``astropy.convolution`` module provides several built-in kernel classes that can be used for convolution operations. These kernels are designed to work with the convolution functions and support various astronomical data processing needs.

Available Kernel Classes
-----------------------

Kernel
^^^^^^
The base kernel class that provides common functionality for all kernels. This class should not be instantiated directly but serves as the parent class for specific kernel implementations.

Kernel1D
^^^^^^^^
Base class for 1-dimensional kernels. Provides the framework for 1D convolution operations and should be subclassed for specific 1D kernel types.

Kernel2D
^^^^^^^^
Base class for 2-dimensional kernels. Provides the framework for 2D convolution operations and should be subclassed for specific 2D kernel types.

Convolution
^^^^^^^^^^^
A specialized class that handles convolution operations using the provided kernels. This class integrates with the modeling system and supports various boundary handling options.

Key Features
------------

- **Normalization**: Kernels support maximum normalization through ``MAX_NORMALIZATION`` constant
- **Boundary Handling**: Multiple boundary options including ``None``, ``"fill"``, ``"wrap"``, and ``"extend"``
- **Performance Optimization**: Automatic optimization of array sizes for FFT operations using either SciPy's ``next_fast_len`` or a precomputed list of optimal sizes
- **Unit Support**: Proper handling of astropy units through quantity attribute stripping
- **Masked Array Support**: Handling of masked arrays and NaN values with various treatment options

Utility Functions
-----------------

The module includes several utility functions:

- ``_next_fast_lengths()``: Finds optimal array sizes for FFT performance
- ``_copy_input_if_needed()``: Handles input array preparation including masking and NaN treatment
- ``has_even_axis()``: Checks for even-sized kernel axes
- ``raise_even_kernel_exception()``: Handles exceptions for even-sized kernels

Note: The actual specific kernel implementations (Gaussian, Box, etc.) are typically defined in separate files and would be documented elsewhere in the module documentation.