Stochastic Gradient Descent
==========================

This module provides an optimized implementation of Stochastic Gradient Descent (SGD) and its variants, including SAGA algorithm support. The implementation uses fused types for both float32 and float64 precision, with Cython optimizations for performance.

Implementation Details
----------------------

The SGD implementation features:

- Support for both single (float32) and double (float64) precision floating point operations
- Multinomial logistic loss function with efficient logsumexp computation
- Soft thresholding operator for L1 regularization
- Optimized sequential dataset access patterns
- Thread-safe operations with nogil where appropriate

Loss Functions
--------------

### MultinomialLogLoss

The multinomial logistic regression loss function implements:

.. math::
   \text{loss} = w \left( \text{logsumexp}(prediction) - prediction[y] \right)

where:
- $prediction = XW + b$ (linear prediction)
- $y$ is the true class label (0 to n_classes-1)
- $w$ is the sample weight

The gradient computation follows:

.. math::
   \frac{\partial \text{loss}}{\partial prediction_c} = w \left( p[c] - \delta_{y,c} \right)

where $p[c] = \frac{\exp(prediction[c])}{\sum_j \exp(prediction[j])}$ is the softmax probability.

Utility Functions
-----------------

### logsumexp
Computes the logarithm of the sum of exponentials of array elements while minimizing numerical overflow/underflow:

.. math::
   \text{logsumexp}(x) = \log\left(\sum_{i=1}^n \exp(x_i)\right)

### soft_thresholding
Applies soft thresholding operator for proximal gradient methods:

.. math::
   \text{soft\_thresholding}(x, \lambda) = \text{sign}(x) \max(|x| - \lambda, 0)

Data Types Support
------------------

The implementation supports two data types through fused types:

- ``float32``: Single precision floating point (np.float32)
- ``float64``: Double precision floating point (np.float64)

References
----------

Based on:

Bishop, C. M. (2006). Pattern Recognition and Machine Learning. Springer. (Chapter 4.3.4)

Authors
-------

- Danny Sullivan
- Tom Dupre la Tour  
- Arthur Mensch
- Arthur Imbert
- Joan Massich

License
-------

BSD 3-Clause License