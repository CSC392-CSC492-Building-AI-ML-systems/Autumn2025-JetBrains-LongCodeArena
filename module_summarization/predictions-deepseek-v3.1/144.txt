# Scheduling Policies in Dask Distributed

The Dask distributed scheduler uses several policies to determine task and worker preferences during scheduling. These policies help optimize task execution, data locality, and overall cluster performance.

## Task Selection Policies

The scheduler employs various strategies to prioritize which tasks should be executed next:

### Default Task Priority
Tasks are typically prioritized based on:
- **Depth-first scheduling**: Prefer tasks that are deeper in the computation graph
- **Data locality**: Prefer tasks that can reuse existing data in worker memory
- **Critical path**: Prioritize tasks on the critical path of the computation

### Work Stealing
When workers become idle, the WorkStealing extension (`distributed.stealing.WorkStealing`) allows busy workers to transfer tasks to idle workers, improving overall cluster utilization.

## Worker Selection Policies

The scheduler uses several criteria to determine which worker should execute a task:

### Data Locality
- Prefer workers that already have the task's dependencies in memory
- Consider network topology and data transfer costs

### Resource Awareness
- Match task requirements with worker resources (CPU, memory, GPU)
- Consider current worker load and availability

### Worker State Management
The `WorkerState` class (not shown in provided code) tracks:
- Current tasks being processed
- Data stored in memory
- Resource utilization metrics
- Network characteristics

## Configuration and Extensions

The scheduler supports various extensions that influence scheduling policies:

```python
DEFAULT_EXTENSIONS = {
    "stealing": WorkStealing,  # Enables work stealing between workers
    "amm": ActiveMemoryManagerExtension,  # Manages memory usage
    "shuffle": ShuffleSchedulerPlugin,  # Handles shuffle operations
    # ... other extensions
}
```

## Customization

Users can customize scheduling behavior through:
- Dask configuration settings
- Custom scheduler plugins
- Resource constraints and annotations
- Task priorities and dependencies

The scheduling policies aim to minimize data transfer, maximize resource utilization, and reduce overall computation time while maintaining fairness across clients and workers.