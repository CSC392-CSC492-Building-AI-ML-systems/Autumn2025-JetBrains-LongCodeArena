.. _metadata:

Metadata
========

This document describes the metadata structure generated by various plans in the bluesky framework. The metadata is stored in a dictionary and provides contextual information about the execution of data collection plans.

General Structure
-----------------

All plans generate a metadata dictionary with the following base structure:

- ``detectors``: List of detector names involved in the plan
- ``plan_name``: Name of the executed plan
- ``plan_args``: Dictionary of arguments passed to the plan
- ``hints``: Dictionary containing hints for data processing/visualization

Common Fields
-------------

The following fields are commonly found across different plans:

- ``num_points``: Total number of data points collected
- ``num_intervals``: Number of intervals between points (typically num_points - 1)
- ``motors``: List of motor names (for scanning plans)
- ``plan_pattern``: Pattern type used for the scan
- ``plan_pattern_module``: Module containing the pattern implementation
- ``plan_pattern_args``: Arguments used for the pattern generation

Plan-Specific Metadata
----------------------

count
~~~~~

The count plan generates metadata with:
- Time-based hint dimensions: ``[('time',), 'primary']``
- Includes detector names and count configuration

list_scan
~~~~~~~~~

The list_scan plan generates additional metadata:
- Motor position lists and their lengths
- Inner product pattern information (``inner_list_product``)
- Dimension hints based on motor field information
- Validation of equal list lengths for all motors

Hints System
------------

The hints system provides guidance for data processing:
- ``dimensions``: Specifies the primary dimensions of the data
- Motor-specific fields are automatically included from motor objects
- Custom hints can be provided via the ``md`` parameter and are merged with defaults

Metadata Inheritance
--------------------

User-provided metadata (via the ``md`` parameter) is merged with the automatically generated metadata, with user values taking precedence when there are key conflicts. The hints dictionary follows a similar merging strategy where user hints update the default hints.