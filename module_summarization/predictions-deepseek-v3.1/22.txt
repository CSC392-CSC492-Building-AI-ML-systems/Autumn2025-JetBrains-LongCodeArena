w_fluxanl
========

The ``w_fluxanl`` tool extracts fluxes into pre-defined target states from WEST data, performs averaging, and constructs confidence intervals. Monte Carlo bootstrapping is used to account for the correlated and possibly non-Gaussian statistical error in flux measurements.

All non-graphical output (including that to the terminal and HDF5) assumes that the propagation/resampling period ``tau`` is equal to unity; to obtain results in familiar units, divide all fluxes and multiply all correlation lengths by the true value of ``tau``.

Usage
-----

::

    w_fluxanl [options]

Options
-------

The tool accepts the following options in addition to the standard WESTPA command-line arguments:

**Input/Output Options**

- ``-o, --output``: Specify the output HDF5 file (default: ``fluxanl.h5``)
- Additional iteration range selection options through ``IterRangeSelection``

**Analysis Parameters**

- ``--alpha``: Significance level for confidence intervals (default: 0.05)
- ``--autocorrel-alpha``: Significance level for autocorrelation analysis
- ``--n-sets``: Number of bootstrap data sets to generate
- ``--evol``: Calculate time-evolving fluxes
- ``--evol-step``: Step size for time-evolving flux calculation

Implementation Details
----------------------

The tool handles two different HDF5 file formats:

1. **File version < 7**: Extracts fluxes from recycling tables in iteration groups
2. **File version ≥ 7**: Extracts recycling information from "new_weights" groups in the iteration following recycling events

Output Data Structure
---------------------

The tool outputs several data types:

**Flux Entry Data Type (fluxentry_dtype)**
- ``n_iter``: Iteration number
- ``flux``: Flux value (weight_dtype)
- ``count``: Count of recycling events (unsigned integer)

**Target Index Data Type (target_index_dtype)**
- ``target_label``: Target state label
- ``mean_flux``: Mean flux value
- ``mean_flux_ci_lb``: Lower bound of confidence interval
- ``mean_flux_ci_ub``: Upper bound of confidence interval
- ``mean_flux_correl_len``: Correlation length

The results are stored in an HDF5 file with a structure organized by target states, containing both raw flux data and statistical analysis results.

Notes
-----

- The tool automatically detects the HDF5 file version and uses the appropriate extraction method
- For file versions ≥ 7, the tool traces recycling events through the new_weights data structure
- Missing data for particular targets in specific iterations is handled using sentinel values
- The bootstrap analysis accounts for temporal correlation in the flux data