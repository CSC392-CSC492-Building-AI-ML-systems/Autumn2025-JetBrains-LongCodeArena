.. _permutation_importance:

Permutation Importance
=====================

Permutation feature importance is a model inspection technique that measures the importance
of features by evaluating the decrease in a model score when a single feature value is randomly
shuffled. This procedure breaks the relationship between the feature and the target, thus
the drop in the model score is indicative of how much the model depends on the feature.

.. currentmodule:: sklearn.inspection

.. autofunction:: permutation_importance

Parameters
----------
estimator : estimator object
    An estimator that has been fitted and is compatible with ``scoring``.

X : array-like of shape (n_samples, n_features)
    Data on which permutation importance will be computed.

y : array-like of shape (n_samples,) or (n_samples, n_outputs) or None
    Target values for supervised problems. None for unsupervised problems.

scoring : str, callable, list, tuple, or dict, default=None
    Scorer to use. If None, the estimator's default scorer is used.

n_repeats : int, default=5
    Number of times to permute a feature.

n_jobs : int, default=None
    Number of jobs to run in parallel. None means 1.

random_state : int, RandomState instance or None, default=None
    Pseudo-random number generator to control the permutations.

sample_weight : array-like of shape (n_samples,), default=None
    Sample weights.

max_samples : int or float, default=1.0
    Maximum number of samples to draw from X to compute feature importance.
    If float, it represents a fraction of the total number of samples.

Returns
-------
result : :class:`~sklearn.utils.Bunch`
    Dictionary-like object with the following attributes:

    importances_mean : ndarray of shape (n_features,)
        Mean of feature importance over ``n_repeats``.

    importances_std : ndarray of shape (n_features,)
        Standard deviation over ``n_repeats``.

    importances : ndarray of shape (n_features, n_repeats)
        Raw permutation importance scores.

Notes
-----
This implementation can be used with any fitted estimator that has a ``fit`` method
and works with the provided scoring function. The permutation importance is computed
by randomly shuffling each feature and calculating the change in the model's performance.

Examples
--------
>>> from sklearn.ensemble import RandomForestClassifier
>>> from sklearn.inspection import permutation_importance
>>> from sklearn.datasets import make_classification
>>> X, y = make_classification(random_state=0)
>>> clf = RandomForestClassifier(random_state=0).fit(X, y)
>>> result = permutation_importance(clf, X, y, n_repeats=10, random_state=0)
>>> result.importances_mean
array([0.05..., 0.02..., 0.02..., ...])

See Also
--------
:func:`partial_dependence` : Partial dependence plots.
:func:`plot_partial_dependence` : Plot partial dependence.

References
----------
.. [1] L. Breiman, "Random Forests", Machine Learning, 45(1), 5-32, 2001.