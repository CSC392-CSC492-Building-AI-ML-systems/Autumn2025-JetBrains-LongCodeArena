`PinholeCamera`
==============

.. currentmodule:: kornia.geometry

.. autoclass:: PinholeCamera
   :members:
   :undoc-members:
   :show-inheritance:
   :exclude-members: _check_valid, _check_valid_params, _check_valid_shape

Class that represents a Pinhole Camera model.

The PinholeCamera class encapsulates both intrinsic and extrinsic camera parameters in batch form, enabling efficient parallel operations using PyTorch. The class provides properties to access various camera parameters and matrices in different formats.

Parameters
----------
intrinsics : torch.Tensor
    Tensor with shape :math:`(B, 4, 4)` containing the full 4x4 camera calibration matrix

extrinsics : torch.Tensor  
    Tensor with shape :math:`(B, 4, 4)` containing the full 4x4 rotation-translation matrix

height : torch.Tensor
    Tensor with shape :math:`(B)` containing the image height

width : torch.Tensor
    Tensor with shape :math:`(B)` containing the image width

.. note::
    We assume that the class attributes are in batch form in order to take advantage of PyTorch parallelism to boost computing performance.

Properties
----------
intrinsics : torch.Tensor
    The full 4x4 intrinsics matrix of shape :math:`(B, 4, 4)`

extrinsics : torch.Tensor
    The full 4x4 extrinsics matrix of shape :math:`(B, 4, 4)`

batch_size : int
    The batch size of the storage

fx : torch.Tensor
    Focal length in the x-direction of shape :math:`(B)`

fy : torch.Tensor  
    Focal length in the y-direction of shape :math:`(B)`

cx : torch.Tensor
    x-coordinate of the principal point of shape :math:`(B)`

cy : torch.Tensor
    y-coordinate of the principal point of shape :math:`(B)`

tx : torch.Tensor
    x-coordinate of the translation vector of shape :math:`(B)` (with setter)

ty : torch.Tensor
    y-coordinate of the translation vector of shape :math:`(B)` (with setter)  

tz : torch.Tensor
    z-coordinate of the translation vector of shape :math:`(B)` (with setter)

rt_matrix : torch.Tensor
    3x4 rotation-translation matrix of shape :math:`(B, 3, 4)`

camera_matrix : torch.Tensor
    3x3 camera matrix containing the intrinsics of shape :math:`(B, 3, 3)`

rotation_matrix : torch.Tensor
    3x3 rotation matrix from the extrinsics of shape :math:`(B, 3, 3)`

translation_vector : torch.Tensor
    Translation vector from the extrinsics of shape :math:`(B, 3, 1)`

Example
-------
>>> intrinsics = torch.eye(4).unsqueeze(0)  # Bx4x4
>>> extrinsics = torch.eye(4).unsqueeze(0)  # Bx4x4  
>>> height = torch.tensor([480])
>>> width = torch.tensor([640])
>>> camera = PinholeCamera(intrinsics, extrinsics, height, width)
>>> camera.fx
tensor([1.])
>>> camera.batch_size
1