.. _operations:

Operations
==========

This module defines the core operation classes used by Alembic migrations. These classes represent database schema operations that can be invoked during migration execution.

Base Operation Class
--------------------

.. autoclass:: MigrateOperation
   :members:
   :undoc-members:
   :show-inheritance:

   The base class for all migration operations. Provides the foundation for operation extensibility and customization.

Constraint Operations
---------------------

AddConstraintOp
~~~~~~~~~~~~~~~

.. autoclass:: AddConstraintOp
   :members:
   :undoc-members:
   :show-inheritance:

   Represents an operation to add a constraint to a database table. This is an abstract base class that must be subclassed for specific constraint types.

DropConstraintOp
~~~~~~~~~~~~~~~~

.. autoclass:: DropConstraintOp
   :members: drop_constraint, batch_drop_constraint
   :undoc-members:
   :show-inheritance:

   Represents an operation to drop a constraint from a database table. Supports both individual and batch operations.

   **Methods:**

   .. automethod:: drop_constraint
      :noindex:

      Drop a constraint of the given name, typically via DROP CONSTRAINT.

      :param constraint_name: name of the constraint
      :param table_name: table name
      :param type\_: optional, required on MySQL. Can be 'foreignkey', 'primary', 'unique', or 'check'
      :param schema: Optional schema name to operate within

   .. automethod:: batch_drop_constraint
      :noindex:

      Issue a "drop constraint" instruction using the current batch migration context. The batch form omits the table_name and schema arguments.

Operation Registration
----------------------

Operations are registered with the operations dispatcher using class decorators:

- ``@Operations.register_operation("operation_name")``
- ``@BatchOperations.register_operation("operation_name", "batch_operation_name")``

This allows operations to be invoked through the migration context's operations object.