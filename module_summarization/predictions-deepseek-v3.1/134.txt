`annihilation.rst`
============

Alchemical Transformations
==========================

Overview
--------
Alchemical transformations are computational methods used in molecular dynamics to calculate free energy differences between two states by gradually mutating one system into another. This is achieved through a hybrid system that interpolates between the "old" (initial) and "new" (final) states using a coupling parameter, lambda (λ). At λ=0, the system behaves like the old state; at λ=1, it behaves like the new state.

Key Concepts
------------
- **Hybrid Topology**: A combined system containing atoms from both the old and new states, classified into four groups:
  - **unique_old_atoms**: Present only in the old system; interactions are on at λ=0 and off at λ=1.
  - **unique_new_atoms**: Present only in the new system; interactions are off at λ=0 and on at λ=1.
  - **core_atoms**: Mapped atoms in changing residues; interactions transition from old to new behavior with λ.
  - **environment_atoms**: Mapped atoms in unchanged residues; interactions remain always on and unmodified.

- **Softcore Potentials**: Modified nonbonded potentials (Lennard-Jones and electrostatics) that prevent singularities when atoms are created or annihilated, using parameters like `softcore_alpha` to control softcore behavior.

- **Force Interpolation**: Specific forces (bonds, angles, torsions, sterics, electrostatics) are scaled with λ using custom functions, allowing smooth transition between states.

Implementation
--------------
The `HybridTopologyFactory` class constructs the hybrid system, handling:
- Atom mapping between old, new, and hybrid systems.
- Position interpolation for hybrid coordinates.
- Force field term modifications to support alchemical changes.
- Optional features like RMSD restraints and torsion flattening.

Parameters
----------
Critical parameters include:
- `softcore_alpha`: Controls softcore steric interactions.
- `bond_softening_constant` / `angle_softening_constant`: Scale force constants for bonds/angles involving unique atoms.
- `softcore_LJ_v2` / `softcore_electrostatics`: Enable advanced softcore models.
- `functions`: Custom λ-dependent scaling functions for different force types.

Applications
------------
Used in free energy calculations (e.g., relative binding affinities, solvation free energies) to efficiently compute thermodynamic differences by avoiding high-energy intermediates.

References
----------
Based on methods from:
- Gapsys et al., *J. Chem. Theory Comput.* 2012, 8(7), 2373–2382 (softcore potentials).

Note: This API is experimental and subject to change.