w_ntop
=====

Select walkers from bins. An assignment file mapping walkers to
bins at each timepoint is required (see ``w_assign --help`` for further
information on generating this file). By default, high-weight walkers are
selected (hence the name ``w_ntop``: select the N top-weighted walkers from
each bin); however, minimum weight walkers and randomly-selected walkers
may be selected instead.

Output Format
-------------

The output file (-o/--output, by default "ntop.h5") contains the following
datasets:

``/n_iter`` [iteration]
  *(Integer)* Iteration numbers for each entry in other datasets.

``/n_segs`` [iteration][bin]
  *(Integer)* Number of segments in each bin/state in the given iteration.
  This will generally be the same as the number requested with
  ``--n/--count`` but may be smaller if the requested number of walkers
  does not exist.

``/seg_ids`` [iteration][bin][segment]
  *(Integer)* Matching segments in each iteration for each bin.
  For an iteration ``n_iter``, only the first ``n_iter`` entries are
  valid. For example, the full list of matching seg_ids in bin 0 in the
  first stored iteration is ``seg_ids[0][0][:n_segs[0]]``.

``/weights`` [iteration][bin][segment]
  *(Floating-point)* Weights for each matching segment in ``/seg_ids``.

Command-line Options
--------------------

Input Options
~~~~~~~~~~~~~

``-a ASSIGNMENTS, --assignments ASSIGNMENTS``
  Use assignments from the given ASSIGNMENTS file (default: assign.h5).

Selection Options
~~~~~~~~~~~~~~~~~

``-n COUNT, --count COUNT``
  Select COUNT walkers from each iteration for each bin (default: 1).

``-t TIMEPOINT, --timepoint TIMEPOINT``
  Base selection on the given TIMEPOINT within each iteration. Default (-1)
  corresponds to the last timepoint.

``--highweight``
  Select COUNT highest-weight walkers from each bin.

``--lowweight``
  Select COUNT lowest-weight walkers from each bin.

``--random``
  Select COUNT walkers randomly from each bin.

Output Options
~~~~~~~~~~~~~~

``-o OUTPUT, --output OUTPUT``
  Write output to OUTPUT (default: ntop.h5).

Standard Options
~~~~~~~~~~~~~~~~

Standard options for iteration range selection and progress indication are
also supported. See the general WESTPA documentation for details.