ImPACT Reconstructor
===================

The ImPACT (Image Pixel-wise fit for Atmospheric Cherenkov Telescopes) reconstructor is a maximum-likelihood based method for reconstructing the geometry, energy, and depth of shower maximum of gamma-ray induced air showers. It uses a comparison between observed camera images and pre-generated template images from simulated air showers.

Overview
--------

The ImPACT reconstructor implements the template-based image fitting method described in Parsons & Hinton (2014). This approach uses a library of image templates to perform a maximum likelihood fit for:

- Shower axis direction
- Primary particle energy
- Height of shower maximum (Xmax)

The method compares predicted images from simulated templates with observed camera images to find the most likely shower parameters.

Key Components
--------------

### Template System

The reconstructor uses telescope-specific template libraries stored in compressed files:

- CHEC: GCT_05deg_ada.template.gz, GCT_05deg_time.template.gz
- LSTCam: LST_05deg.template.gz, LST_05deg_time.template.gz  
- NectarCam: MST_05deg.template.gz, MST_05deg_time.template.gz
- FlashCam: MST_xm_full.fits

### Atmospheric Profile

Uses atmospheric thickness and altitude profile functions for the Paranal site to convert between height above ground and depth of shower maximum.

### Priors

The reconstructor incorporates prior knowledge through:

- **Energy prior**: Power-law prior on energy reconstruction
- **Xmax prior**: Gaussian prior on shower depth based on expected gamma-ray elongation rates

API Reference
-------------

### Main Class

.. autoclass:: ImPACTReconstructor
   :members:
   :special-members: __init__

### Utility Functions

.. autofunction:: guess_shower_depth

.. autofunction:: energy_prior

.. autofunction:: xmax_prior

Configuration Options
---------------------

The reconstructor accepts several configuration parameters:

- ``root_dir``: Directory containing template files
- ``minimiser``: Optimization algorithm to use ('minuit' or others)
- ``prior``: Prior configuration string
- ``template_scale``: Scaling factor for templates
- ``xmax_offset``: Offset for Xmax reconstruction
- ``use_time_gradient``: Whether to use timing information

Units Convention
----------------

For computational efficiency, the class uses fixed units internally:

- Angular units: radians
- Distance units: meters  
- Energy units: TeV

References
----------

Parsons, R. D., & Hinton, J. A. (2014). A Monte Carlo template based analysis for air-shower imaging atmospheric Cherenkov telescopes. Astroparticle Physics, 56, 26-34.