isotonic
=========

.. currentmodule:: sklearn.isotonic

The :mod:`sklearn.isotonic` module implements isotonic regression, a technique for fitting a non-decreasing (or non-increasing) function to data.

.. _isotonic_regression:

Isotonic Regression
-------------------

Isotonic regression is a method for fitting a free-form line to a sequence of observations under the constraint that the fitted function must be non-decreasing (or non-increasing). It is a non-parametric regression technique that does not assume any particular form for the target function.

The solution to the isotonic regression problem is a piecewise constant function that minimizes the sum of squared errors between the observed and predicted values, subject to the monotonicity constraint.

Functions
---------

.. autofunction:: check_increasing

.. autofunction:: isotonic_regression

Classes
-------

.. autoclass:: IsotonicRegression
   :members:
   :inherited-members:

Examples
--------

>>> import numpy as np
>>> from sklearn.isotonic import IsotonicRegression
>>> X = np.arange(5)
>>> y = [1, 2, 1.5, 3.5, 2.5]
>>> ir = IsotonicRegression()
>>> ir.fit(X, y)
IsotonicRegression()
>>> ir.predict([0.5, 1.5, 2.5])
array([1.25, 1.25, 2.  ])

Mathematical Formulation
------------------------

Given input data :math:`x_1, x_2, ..., x_n` and response values :math:`y_1, y_2, ..., y_n`, isotonic regression solves the optimization problem:

.. math:: \min_{\hat{y}_1, \hat{y}_2, ..., \hat{y}_n} \sum_{i=1}^n w_i (y_i - \hat{y}_i)^2

subject to :math:`\hat{y}_i \leq \hat{y}_j` whenever :math:`x_i \leq x_j` (for increasing regression) or :math:`\hat{y}_i \geq \hat{y}_j` whenever :math:`x_i \leq x_j` (for decreasing regression).

References
----------

- "Active set algorithms for isotonic regression; A unifying framework" by Michael J. Best and Nilotpal Chakravarti
- `Isotonic regression (Wikipedia) <https://en.wikipedia.org/wiki/Isotonic_regression>`_

See Also
--------

:class:`~sklearn.linear_model.LinearRegression` : Ordinary least squares Linear Regression.

:class:`~sklearn.svm.SVR` : Epsilon-Support Vector Regression.

:class:`~sklearn.tree.DecisionTreeRegressor` : A decision tree regressor.

Notes
-----

The implementation uses the pool adjacent violators algorithm (PAVA) which has a time complexity of O(n).