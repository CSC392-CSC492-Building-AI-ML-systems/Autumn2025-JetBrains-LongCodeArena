`w_pdist` – Time-Resolved Probability Distribution Calculation
================================================================

Overview
--------
The `w_pdist` tool calculates time-resolved, multi-dimensional probability distributions from weighted ensemble (WE) simulation data. It supports both built-in and user-defined datasets, provides flexible histogram binning options, and outputs results in HDF5 format for further analysis or visualization.

Source Data Specification
-------------------------
Source data can be provided in one of two ways:

1. **Custom Function (--construct-dataset)**
   - Specify a Python function in `MODULE.FUNCTION` format
   - Function signature: `function(n_iter, iter_group)`
   - Must return data indexable as `[segment][timepoint][dimension]`

2. **Dataset Specifications (--dsspecs)**
   - Space-separated list of dataset specifications
   - Format: `NAME[,file=FILENAME,slice=SLICE]`
   - Default file: `west.h5`
   - Slice examples: `[0:2]` (first two elements), `[:,1]` (second column)

If neither option is specified, the tool defaults to using the `pcoord` dataset.

Histogram Binning Options
-------------------------
Bin configuration accepts three formats via `-b/--bins`:

1. **Single integer** (e.g., `-b 100`)
   - Uniform bins in all dimensions

2. **Comma-separated integers** (e.g., `-b 50,100`)
   - Dimension-specific uniform bin counts

3. **Explicit bin boundaries** (e.g., `-b "[[0,1,2,3], [0.0,0.5,1.0]]"`)
   - Custom non-uniform bins using Python eval syntax
   - `np` module available (e.g., `np.arange(0,10,0.1)`)

*Note:* The first two modes require data range scanning, which may be computationally expensive for large datasets.

Output Format
-------------
Output file (default: `pdist.h5`) contains:

- `histograms`: Normalized probability distributions (iteration × dimension axes)
- `binbounds_*`: Bin boundaries for each dimension
- `midpoints_*`: Bin midpoints for each dimension
- `n_iter`: Iteration numbers corresponding to histogram axes

Parallel Processing
-------------------
- Enabled by default for improved performance
- Use `--serial` flag for serial processing (recommended for small datasets)

Related Tools
-------------
Output files are compatible with `plothist` for visualization and further processing.

Command-Line Options
--------------------
Run `w_pdist --help` for complete option listing.