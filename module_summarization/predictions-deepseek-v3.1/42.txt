Generating Schema
=================

Tortoise ORM provides utilities to generate and apply SQL schema for your models. This is useful for initializing your database with the necessary tables and constraints.

Functions
---------

.. py:function:: get_schema_sql(client, safe)

   Generates the SQL schema for the given database client.

   :param BaseDBAsyncClient client: The database client to generate schema SQL for.
   :param bool safe: When set to True, creates tables only if they do not already exist.
   :returns: The generated SQL schema as a string.
   :rtype: str

.. py:function:: generate_schema_for_client(client, safe)

   Generates and applies the SQL schema directly to the given database client.

   :param BaseDBAsyncClient client: The database client to generate and apply the schema for.
   :param bool safe: When set to True, creates tables only if they do not already exist.
   :returns: None

Usage Example
-------------

To generate the schema SQL without executing it:

.. code-block:: python

   from tortoise import Tortoise
   from tortoise.schema import get_schema_sql

   async def init():
       await Tortoise.init(
           db_url='sqlite://db.sqlite3',
           modules={'models': ['app.models']}
       )
       sql_schema = get_schema_sql(Tortoise.get_connection('default'), safe=True)
       print(sql_schema)

To generate and apply the schema directly:

.. code-block:: python

   from tortoise import Tortoise
   from tortoise.schema import generate_schema_for_client

   async def init():
       await Tortoise.init(
           db_url='sqlite://db.sqlite3',
           modules={'models': ['app.models']}
       )
       await generate_schema_for_client(Tortoise.get_connection('default'), safe=True)

Notes
-----

- The ``safe=True`` parameter ensures idempotent operations by using ``CREATE TABLE IF NOT EXISTS`` syntax
- Schema generation is database-backend specific and uses each backend's schema generator
- The generated SQL includes tables, indexes, constraints, and relationships based on your Tortoise models
- For production use, consider using proper database migration tools instead of schema generation