w_red
=====

The ``w_red`` command calculates rate constants from WESTPA simulations, with optional Reactive Ensemble Dynamics (RED) correction for non-Markovian effects.

Overview
--------

This tool extracts rate constants between specified initial and final states from WESTPA HDF5 output files. It supports both raw rate calculations and RED-corrected rates that account for non-exponential waiting time distributions.

Usage
-----

.. code-block:: bash

    w_red [options] <directh5_path> <istate> <fstate>

Required Arguments
------------------

- ``directh5_path``: Path to WESTPA direct.h5 file containing kinetics data
- ``istate``: Index of initial state (integer)
- ``fstate``: Index of final state (integer)

Options
-------

- ``--n-iters N``: Number of iterations to include in calculation (default: all available)
- ``--report-interval N``: Reporting interval in steps (default: 20)
- ``--n-steps-iter N``: Number of steps per iteration (default: 1000)
- ``--red``: Apply RED correction (default: False)
- ``--callback FUNCTION``: Callback function for additional processing

RED Correction
--------------

The RED correction factor accounts for non-Markovian effects by considering the distribution of event durations. The correction is calculated as:

.. math::
    
    \text{correction} = \frac{\theta}{\int_0^\theta \int_0^t \tilde{f}(\tau) d\tau dt}

where:
- $\theta$ is the maximum duration time
- $\tilde{f}(\tau)$ is the normalized duration distribution weighted by $1/(\theta-\tau)$

The correction factor multiplies the raw rate to give the RED-corrected rate.

Output
------

Returns either:
- Raw rate constant (default)
- RED-corrected rate constant (with ``--red`` flag)

The rate is returned as a floating-point value representing the rate constant in units of inverse time (scaled by the provided timestep parameters).

Dependencies
------------

- h5py
- numpy
- westpa

See Also
--------

- WESTPA documentation: https://westpa.github.io/westpa
- Reactive Ensemble Dynamics theory: Reference literature on non-Markovian rate corrections