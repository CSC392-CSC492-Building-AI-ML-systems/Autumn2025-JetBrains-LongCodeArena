w_direct
========

The ``w_direct`` command calculates state-to-state kinetics by tracing trajectories in WESTPA simulations. It consists of two main subcommands: ``init`` and ``kinetics``.

Subcommands
-----------

init
~~~~

The ``w_direct init`` subcommand calculates state-to-state rates and transition event durations by tracing trajectories. It requires a bin assignment file (typically "assign.h5") with trajectory labeling.

**Output Format:**
The output file (default: "direct.h5") contains these datasets:

- ``/conditional_fluxes`` [iteration][state][state]: Floating-point macrostate-to-macrostate fluxes (not normalized by initial macrostate population)
- ``/conditional_arrivals`` [iteration][stateA][stateB]: Integer count of trajectories arriving at state B given departure from state A
- ``/total_fluxes`` [iteration][state]: Floating-point total flux into each macrostate
- ``/arrivals`` [iteration][state]: Integer count of trajectories arriving at each state
- ``/duration_count`` [iteration]: Integer count of event durations per iteration
- ``/durations`` [iteration][event duration]: Structured array containing:
  - ``istate``: Integer initial state of transition
  - ``fstate``: Integer final state of transition
  - ``duration``: Floating-point duration of transition (tau units)
  - ``weight``: Floating-point weight at end of transition (not normalized)

kinetics
~~~~~~~~

The ``w_direct kinetics`` subcommand calculates average rates/fluxes and associated errors from the data generated by ``w_direct init``. It requires both assignment data ("assign.h5") and kinetics data ("direct.h5").

**Output Format:**
The output file contains these datasets:

- ``/avg_rates`` [state,state]: Structured state-to-state rates
- ``/avg_total_fluxes`` [state]: Structured total fluxes into each state
- ``/avg_conditional_fluxes`` [state,state]: Structured state-to-state fluxes

When using evolution mode (``--evolution-mode``), additional datasets include:

- ``/rate_evolution`` [window][state][state]: Structured rate evolution data

Usage Notes
-----------

- State-to-state fluxes from ``w_direct init`` require normalization by initial macrostate population to obtain proper rates
- The ``w_direct kinetics`` command performs this normalization while accounting for statistical fluctuations and correlations
- Total fluxes (into a given state) require no additional normalization
- Both subcommands support iteration range specification and confidence interval calculation