# PlotData Class Documentation

## Overview

The `PlotData` class provides a flexible interface for handling data in various formats (dictionaries, pandas DataFrames, Bokeh ColumnDataSource objects) to support plotting functions. It enables iteration over multiple data sets with automatic key expansion and consistent data access patterns.

## Key Features

- **Multi-format support**: Works with dictionaries, pandas DataFrames, and Bokeh ColumnDataSource objects
- **Automatic iteration**: Expands single keys to multiple data series when lists are provided
- **Data consistency**: Optional validation for same data dimensions across entries
- **Flexible data access**: Named tuple interface for accessing plot data columns

## Usage

### Basic Example

```python
from masci_tools.vis.data import PlotData
import numpy as np

# Create sample data
x = np.linspace(-10,10,100)
data = {'x': x, 'y1': np.sin(x), 'y2': np.cos(x), 'y3': x**2}

# Initialize PlotData with x and multiple y columns
p = PlotData(data, x='x', y=['y1', 'y2', 'y3'])

# Iterate over data sets
for entry in p:
    print(entry.x)  # 'x' data
    print(entry.y)  # 'y1', then 'y2', then 'y3'
```

## Class Initialization

### Parameters

- `data`: Data source object(s) - can be a single object or list of objects that support bracket indexing (dict, DataFrame, ColumnDataSource)
- `use_column_source`: Boolean indicating whether to use Bokeh ColumnDataSource format
- `same_length`: Boolean indicating whether to validate same dimensions across all data entries
- `strict_data_keys`: Boolean preventing addition of new data keys after initialization
- `copy_data`: Boolean indicating whether to create a copy of the input data
- `**kwargs`: Column specifications using named parameters (e.g., x='x_column', y='y_column')

### Column Specification

Columns can be specified as:
- Single values: `x='energy'` - uses the same column for all data sets
- Lists: `y=['dos_up', 'dos_down']` - iterates through multiple columns

## Properties

- `data_keys`: Returns tuple of registered data keys for this instance

## Methods

### `add_data_key(data_key, keys=None)`

Adds a new column of data keys to the PlotData instance.

**Parameters:**
- `data_key`: String name of the new data key to add
- `keys`: Optional index into data or list of indices to initialize values

**Raises:**
- `ValueError` if strict_data_keys is True or if data_key already exists

## Data Format Support

The class supports the following data container types:
- Python dictionaries
- pandas DataFrames
- Bokeh ColumnDataSource objects (if Bokeh is installed)

## Data Handling

- Automatic copying of data when `copy_data=True`
- Normalization of dictionary entries when `same_length=True`
- Consistent interface across different data source types
- Optional Bokeh integration for web-based plotting

## Error Handling

The class includes validation for:
- Data type compatibility
- Dimension matching between data sources and column specifications
- Key existence checks when strict mode is enabled

This class enables plotting functions to accept data in multiple formats while maintaining a consistent interface for data access and iteration.