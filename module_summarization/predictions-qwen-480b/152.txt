Executing Notebooks
===================

The ``nbconvert`` library provides functionality for executing Jupyter notebooks programmatically. This is particularly useful for automating notebook execution, testing notebook code, or integrating notebook execution into larger workflows.

Execute Preprocessor
--------------------

The primary interface for executing notebooks is the ``ExecutePreprocessor`` class, which allows you to run all code cells in a notebook and capture their outputs.

.. autoclass:: nbconvert.preprocessors.ExecutePreprocessor
   :members:
   :undoc-members:
   :show-inheritance:

The preprocessor modifies the notebook in-place by executing each code cell and updating the cell outputs with the results. It supports various execution environments and can be configured with different kernel options.

Basic Usage
~~~~~~~~~~~

To execute a notebook:

.. code-block:: python

    import nbformat
    from nbconvert.preprocessors import ExecutePreprocessor

    # Read the notebook
    with open('notebook.ipynb') as f:
        nb = nbformat.read(f, as_version=4)

    # Create and configure the preprocessor
    ep = ExecutePreprocessor(timeout=600, kernel_name='python3')

    # Execute the notebook
    ep.preprocess(nb, {'metadata': {'path': '.'}})

    # Save the executed notebook
    with open('executed_notebook.ipynb', 'w') as f:
        nbformat.write(nb, f)

Execution Resources
~~~~~~~~~~~~~~~~~~~

The ``preprocess`` method accepts a ``resources`` dictionary that can contain metadata used during execution. For example, setting the execution path:

.. code-block:: python

    resources = {
        'metadata': {
            'path': '/path/to/notebook/directory'
        }
    }
    ep.preprocess(nb, resources)

Language Detection
------------------

Notebooks may contain cells in languages other than the primary kernel language through magic commands like ``%%R`` or ``%%bash``. The ``HighlightMagicsPreprocessor`` detects these language extensions and tags cells appropriately for syntax highlighting.

.. autoclass:: nbconvert.preprocessors.HighlightMagicsPreprocessor
   :members:
   :undoc-members:
   :show-inheritance:

This preprocessor identifies cells using magic language extensions and adds metadata to enable proper syntax highlighting in converted outputs.

Legacy Function
---------------

.. autofunction:: nbconvert.preprocessors.execute.executenb

Note: This function is deprecated. Use ``nbclient.execute`` directly instead.