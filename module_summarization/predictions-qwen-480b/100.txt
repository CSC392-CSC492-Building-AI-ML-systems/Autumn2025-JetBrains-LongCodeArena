# Managers

This module provides a set of classes for managing requests to Ethereum nodes and handling transaction signing and sending. The main components include request managers for synchronous and asynchronous communication, wrapper classes for extending functionality, and mixins for handling raw transaction operations.

## RequestManager

The `RequestManager` class handles communication with Ethereum nodes through a provider interface.

### Methods

#### `__init__(provider)`
Initialize the request manager with a provider.

- `provider`: The provider instance used to make requests to the Ethereum node.

#### `setProvider(provider)`
Update the provider used by the manager.

- `provider`: The new provider instance.

#### `request_blocking(method, params)`
Make a synchronous request using the provider.

- `method`: The RPC method name to call.
- `params`: The parameters to pass to the method.
- Returns: The result of the RPC call.
- Raises: `ValueError` if the response contains an error.

#### `request_async(method, params)`
Initiate an asynchronous request.

- `method`: The RPC method name to call.
- `params`: The parameters to pass to the method.
- Returns: A request ID for later retrieval of the result.

#### `receive_blocking(request_id, timeout=None)`
Retrieve the result of an asynchronous request.

- `request_id`: The ID of the request to retrieve.
- `timeout`: Optional timeout in seconds.
- Returns: The result of the RPC call.
- Raises: `KeyError` if the request ID is not found, `ValueError` if the response contains an error.

#### `receive_async(request_id, *args, **kwargs)`
Placeholder for callback-based asynchronous handling.

- Raises: `NotImplementedError` as this pattern is not implemented.

## ManagerWrapper

The `ManagerWrapper` class provides a base wrapper for extending request manager functionality.

### Methods

#### `__init__(wrapped_manager)`
Initialize the wrapper with a wrapped manager instance.

- `wrapped_manager`: The manager instance to wrap.

#### Properties
- `provider`: Returns the provider from the wrapped manager.
- `pending_requests`: Returns the pending requests from the wrapped manager.

#### `setProvider(provider)`
Delegate provider setting to the wrapped manager.

- `provider`: The new provider instance.

#### `request_blocking(*args, **kwargs)`
Delegate synchronous requests to the wrapped manager.

#### `request_async(*args, **kwargs)`
Delegate asynchronous requests to the wrapped manager.

#### `receive_blocking(*args, **kwargs)`
Delegate blocking receive operations to the wrapped manager.

#### `receive_async(*args, **kwargs)`
Delegate asynchronous receive operations to the wrapped manager.

## BaseSendRawTransactionMixin

The `BaseSendRawTransactionMixin` extends manager functionality with raw transaction handling capabilities. This mixin manages nonce tracking, transaction signing, and automatic conversion of transaction sending methods.

### Attributes
- `_known_transactions`: Dictionary tracking known transaction hashes by address.
- `_known_nonces`: Dictionary tracking known nonces by address.

### Methods

#### `__init__(*args, **kwargs)`
Initialize the mixin with default collections for tracking transactions and nonces.

#### `_get_nonces_and_cleanup(addr, chain_nonce)`
Retrieve and clean up tracked nonces for an address.

- `addr`: The address to check.
- `chain_nonce`: The current chain nonce for cleanup.
- Yields: Valid nonces that are still relevant.

#### `get_chain_nonce(addr)`
Retrieve the current transaction count (nonce) for an address.

- `addr`: The address to query.
- Returns: The current nonce as a decimal.

#### `get_nonce(addr)`
Calculate the next available nonce for an address.

- `addr`: The address to calculate nonce for.
- Returns: The next available nonce.

#### `get_transaction_signature(serialized_txn)`
Abstract method for transaction signing.

- `serialized_txn`: The transaction to sign.
- Raises: `NotImplementedError` as this must be implemented by subclasses.

#### `sign_and_serialize_transaction(transaction)`
Sign and serialize a transaction.

- `transaction`: The transaction dictionary to sign.
- Returns: The signed and serialized transaction bytes.

#### `construct_full_transaction(base_transaction)`
Build a complete transaction with default values.

- `base_transaction`: The base transaction dictionary.
- Returns: A complete transaction dictionary with defaults for missing fields.

#### `request_blocking(method, params)`
Override to handle transaction sending methods by converting them to raw transactions.

- `method`: The RPC method name.
- `params`: The method parameters.
- Returns: The result of the transaction sending operation.