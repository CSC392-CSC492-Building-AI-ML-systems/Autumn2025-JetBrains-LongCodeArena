.. _w_multi_west:

``w_multi_west``: Combine Multiple WESTPA Simulations
=====================================================

The ``w_multi_west`` tool is designed to combine multiple WESTPA simulation datasets into a single output file, while properly accounting for reweighting and data consistency. This is particularly useful when running independent simulations (e.g., replicas or different conditions) that need to be analyzed together.

Usage
-----

.. code-block:: bash

    w_multi_west [options]

Description
-----------

``w_multi_west`` reads multiple WESTPA HDF5 files (typically named ``west.h5``), combines their data, and writes the merged results into a new HDF5 file. It handles per-iteration summaries, binning data, auxiliary datasets, and initial states, ensuring that weights are correctly adjusted during the merge process.

Command-Line Options
--------------------

.. program:: w_multi_west

.. option:: -o FILE, --output-file FILE

    The name of the output file to store the combined results in. Default: ``multi.h5``.

.. option:: -W FILE, --west FILE, --WEST_H5FILE FILE

    The name of the main WESTPA HDF5 file inside each simulation directory. Default: ``west.h5``.

.. option:: -a NAME, --aux NAME

    Names of additional auxiliary datasets to be combined. Can be specified multiple times.

.. option:: -aa, --auxall

    Combine all available auxiliary datasets. Default: False.

.. option:: -nr, --no-reweight

    Do not perform reweighting during the merge. Default: False.

.. option:: -ib, --ibstates

    Attempt to combine the ``ibstates`` dataset. Default: False.

.. option:: --help

    Show help message and exit.

Examples
--------

Combine all simulations listed in the default configuration using default settings:

.. code-block:: bash

    w_multi_west

Combine simulations and save the result to a custom output file:

.. code-block:: bash

    w_multi_west -o combined.h5

Include all auxiliary datasets during the merge:

.. code-block:: bash

    w_multi_west -aa

Combine simulations without performing reweighting:

.. code-block:: bash

    w_multi_west -nr

Combine simulations and include the ``ibstates`` dataset:

.. code-block:: bash

    w_multi_west -ib

Notes
-----

- The tool assumes that binning and system definitions are consistent across simulations.
- Reweighting is performed by default to ensure proper statistical weighting of trajectories from different simulations.
- The tool supports progress indication for long-running operations.

See Also
--------

- :ref:`w_assign`
- :ref:`w_direct`
- :ref:`w_reweight`