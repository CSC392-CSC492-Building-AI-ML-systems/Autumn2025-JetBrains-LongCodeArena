Working with Assignments and Allocations
========================================

In ftrack, assignments and allocations are used to manage resource planning and scheduling. They allow you to assign tasks to users and allocate resources over time, providing a comprehensive view of your project's resource utilization.

Assignments
-----------

An assignment represents the relationship between a task and a user. It indicates that a specific user is responsible for completing a task. Assignments are typically created when you want to delegate work to team members.

To create an assignment, you need to specify the task and the user. The assignment can also include additional metadata such as the assignment type, which can be used to categorize assignments (e.g., "Creative Work", "Management", etc.).

Allocations
-----------

An allocation represents a user's availability over a period of time. It defines when a user is allocated to work on tasks and how much of their time is available. Allocations are used in conjunction with assignments to calculate resource utilization and identify potential over- or under-allocation of resources.

Allocations can be created for specific time periods and can include metadata such as the allocation type, which can be used to categorize allocations (e.g., "Project Work", "Vacation", etc.).

Working with Assignments and Allocations
----------------------------------------

To work with assignments and allocations in the ftrack API, you can use the session object to query, create, update, and delete assignment and allocation entities.

### Querying Assignments and Allocations

To query assignments and allocations, you can use the session's query method. For example, to retrieve all assignments for a specific task, you can use the following code:

```python
task = session.query('Task where name is "My Task"').one()
assignments = session.query(
    'Assignment where context_id is "{0}"'.format(task['id'])
).all()
```

Similarly, to retrieve all allocations for a specific user, you can use the following code:

```python
user = session.query('User where username is "my_user"').one()
allocations = session.query(
    'Allocation where user_id is "{0}"'.format(user['id'])
).all()
```

### Creating Assignments and Allocations

To create an assignment, you can use the session's create method. For example, to create an assignment for a task and user, you can use the following code:

```python
task = session.query('Task where name is "My Task"').one()
user = session.query('User where username is "my_user"').one()

assignment = session.create('Assignment', {
    'context': task,
    'resource': user,
    'assignment_type': 'Creative Work'
})
session.commit()
```

To create an allocation, you can use a similar approach:

```python
user = session.query('User where username is "my_user"').one()

allocation = session.create('Allocation', {
    'resource': user,
    'start': datetime.datetime(2023, 1, 1),
    'end': datetime.datetime(2023, 1, 31),
    'allocation_type': 'Project Work',
    'value': 1.0  # Full time allocation
})
session.commit()
```

### Updating Assignments and Allocations

To update an assignment or allocation, you can modify its attributes and then commit the changes. For example, to update an assignment's type:

```python
assignment = session.query('Assignment where id is "assignment_id"').one()
assignment['assignment_type'] = 'Management'
session.commit()
```

Similarly, to update an allocation's value:

```python
allocation = session.query('Allocation where id is "allocation_id"').one()
allocation['value'] = 0.5  # Half time allocation
session.commit()
```

### Deleting Assignments and Allocations

To delete an assignment or allocation, you can use the session's delete method. For example, to delete an assignment:

```python
assignment = session.query('Assignment where id is "assignment_id"').one()
session.delete(assignment)
session.commit()
```

Similarly, to delete an allocation:

```python
allocation = session.query('Allocation where id is "allocation_id"').one()
session.delete(allocation)
session.commit()
```

By using assignments and allocations effectively, you can gain better visibility into your project's resource planning and ensure that your team's workload is balanced and manageable.