.. _w_run:

``w_run``: Run WESTPA Simulation
================================

The ``w_run`` command is used to start or continue a WESTPA (Weighted Ensemble Simulation Toolkit with Parallelization and Analysis) simulation. It initializes the simulation environment, loads necessary drivers, and manages the execution of the weighted ensemble algorithm using the specified work manager.

Usage
-----

.. code-block:: bash

    w_run [OPTIONS]

Description
-----------

``w_run`` begins by parsing command-line arguments to configure the WESTPA runtime environment and work manager settings. It then initializes and runs the simulation loop, which includes segment propagation, recycling, and weight redistribution according to the WESTPA algorithm.

Options
-------

.. option:: --oneseg

    Propagate only one segment. This is useful for debugging propagators without running the full simulation.

.. option:: --work-manager <WORK_MANAGER>

    Specify the work manager to use for parallel execution. See :ref:`work_managers` for available options and configuration details.

.. option:: --n-workers <N>

    Number of worker processes to use (if applicable to the selected work manager).

Signal Handling
---------------

The ``w_run`` command installs a signal handler for SIGINT (Ctrl+C) to allow graceful shutdown of the simulation. If interrupted, the simulation will finalize the current iteration and exit cleanly.

Error Handling
--------------

If an exception occurs during the simulation, ``w_run`` will log the error message and traceback, then shut down the simulation environment gracefully.

Examples
--------

To start or continue a WESTPA simulation with default settings:

.. code-block:: bash

    w_run

To run only a single segment for debugging purposes:

.. code-block:: bash

    w_run --oneseg

To run the simulation with a specific work manager and number of workers:

.. code-block:: bash

    w_run --work-manager threads --n-workers 4

See Also
--------

- :ref:`westpa_config` for configuration file documentation
- :ref:`work_managers` for details on parallel execution options
- :ref:`w_init` for initializing WESTPA simulations