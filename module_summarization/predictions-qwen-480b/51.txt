.. _gee_example:

Generate Example for Generalized Estimating Equations (GEE)
==========================================================

The following example demonstrates how to use the Generalized Estimating Equations (GEE) module in statsmodels to fit a model with a specified family and link function. This example uses the ``GEE`` class along with a family from the ``family`` module, such as ``Gaussian``, ``Binomial``, or ``Poisson``, to model correlated data.

Example
-------

Suppose we have repeated measurements data and want to fit a GEE model using an exchangeable correlation structure. Here's how you can generate an example dataset and fit a GEE model:

.. code-block:: python

    import numpy as np
    import pandas as pd
    import statsmodels.api as sm
    from statsmodels.genmod.generalized_estimating_equations import GEE
    from statsmodels.genmod.families import Gaussian
    from statsmodels.genmod.families.links import Identity

    # Generate example data
    np.random.seed(42)
    n_groups = 50
    n_obs_per_group = 4
    n_obs = n_groups * n_obs_per_group

    # Explanatory variables
    x1 = np.random.normal(size=n_obs)
    x2 = np.random.normal(size=n_obs)

    # Group indicator
    groups = np.repeat(np.arange(n_groups), n_obs_per_group)

    # Simulate response variable with some correlation within groups
    linear_pred = x1 + 0.5 * x2
    errors = np.random.normal(scale=0.5, size=n_obs)
    # Introduce correlation by adding group-level random effects
    group_effects = np.repeat(np.random.normal(scale=0.3, size=n_groups), n_obs_per_group)
    y = linear_pred + errors + group_effects

    # Create DataFrame
    data = pd.DataFrame({
        'y': y,
        'x1': x1,
        'x2': x2,
        'groups': groups
    })

    # Define the GEE model
    family = Gaussian(link=Identity())
    model = GEE.from_formula("y ~ x1 + x2", groups="groups", data=data, family=family, cov_struct=sm.cov_struct.Exchangeable())

    # Fit the model
    result = model.fit()

    # Print the results
    print(result.summary())

In this example:

- We generate a dataset with repeated measurements across different groups.
- A GEE model is defined using a Gaussian family with an identity link function.
- The correlation structure is assumed to be exchangeable.
- The model is fitted using the ``fit()`` method, and the results are printed.

This approach allows modeling of correlated data while specifying the appropriate distribution and link function for the response variable.