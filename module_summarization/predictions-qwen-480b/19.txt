```
w_crawl
=======

The ``w_crawl`` command is a tool for crawling through a weighted ensemble dataset, executing a specified function for each iteration. This is useful for postprocessing trajectories, cleaning up datasets, or performing any task that can be described as "do X for iteration N, then do something with the result." Tasks are parallelized by iteration, and no guarantees are made about the order of evaluation.

Usage
-----

.. code-block:: bash

    w_crawl [options] task_callable

Arguments
---------

``task_callable`` (required)
    A function to run on each iteration, specified as ``module.function``.

Options
-------

``-c``, ``--crawler-instance``
    Use ``CRAWLER_INSTANCE`` (specified as ``module.instance``) as an instance of ``WESTPACrawler`` to coordinate the calculation. This is required only if initialization, finalization, or task result processing is needed.

``--first-iter``
    The first iteration to process (default: 1).

``--last-iter``
    The last iteration to process (default: the last iteration in the dataset).

``-W``, ``--west-data``
    Path to the WESTPA data file (default: read from the environment variable ``WESTPA_H5FILE`` or ``west.h5`` in the current directory).

``--max-queue-length``
    Maximum number of tasks to queue at one time (default: 16).

Task Options
------------

The ``task_callable`` function must accept two arguments:

1. ``n_iter``: The iteration number.
2. ``iter_group``: The iteration group from the WESTPA data file.

The function should return any result that will be passed to the ``process_iter_result`` method of the ``WESTPACrawler`` instance.

Crawler Instance
----------------

The optional ``WESTPACrawler`` instance allows customization of the crawling process. It provides hooks for initialization, finalization, and result processing:

- ``initialize(iter_start, iter_stop)``: Called before any tasks are executed.
- ``process_iter_result(n_iter, result)``: Called with the result of each task.
- ``finalize()``: Called after all tasks have been executed.

If no crawler instance is provided, a default ``WESTPACrawler`` is used, which performs no actions in these hooks.

Examples
--------

Run a function ``my_module.my_function`` on each iteration:

.. code-block:: bash

    w_crawl my_module.my_function

Use a custom crawler instance ``my_module.MyCrawler`` to process results:

.. code-block:: bash

    w_crawl -c my_module.MyCrawler my_module.my_function
```