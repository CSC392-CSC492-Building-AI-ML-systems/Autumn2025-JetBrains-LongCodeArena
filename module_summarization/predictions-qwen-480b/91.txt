RandAugment
===========

.. currentmodule:: nvidia.dali.auto_aug.rand_augment

The RandAugment module implements the RandAugment data augmentation technique as described in
`RandAugment: Practical automated data augmentation with a reduced search space <https://arxiv.org/abs/1909.13719>`_.
This method applies a fixed number of randomly selected image transformations with a fixed magnitude,
providing a simple yet effective approach to improve model generalization.

Functions
---------

.. autofunction:: rand_augment

.. autofunction:: apply_rand_augment

.. autofunction:: get_rand_augment_suite

.. autofunction:: get_rand_augment_non_monotonic_suite

Overview
--------

RandAugment simplifies the augmentation process by reducing the search space to just two parameters:

- ``n``: Number of augmentation operations to apply
- ``m``: Magnitude (strength) of each operation

The technique randomly selects ``n`` operations from a predefined set and applies them to the input
data with magnitude ``m``. The magnitude is discretized into ``num_magnitude_bins`` bins.

Usage Example
-------------

.. code-block:: python

    from nvidia.dali.auto_aug import rand_augment
    
    # Apply RandAugment with 2 operations and magnitude 10
    augmented_data = rand_augment(
        data=input_images,
        n=2,
        m=10,
        num_magnitude_bins=31
    )

Key Parameters
--------------

The main parameters for RandAugment include:

- ``data``: Input batch of images or video frames
- ``n``: Number of operations to apply
- ``m``: Magnitude of operations (0 to num_magnitude_bins-1)
- ``num_magnitude_bins``: Discretization of magnitude space
- ``shape``: Optional shape information for relative transformations
- ``fill_value``: Padding value for geometric transformations
- ``interp_type``: Interpolation method for geometric operations

Translation Control
-------------------

Translation operations can be controlled in two ways:

1. **Absolute translation** (when shape not provided):
   - ``max_translate_abs``: Maximum pixel shift

2. **Relative translation** (when shape provided):
   - ``max_translate_rel``: Maximum shift as fraction of image dimensions

Monotonic vs Non-Monotonic Magnitude
------------------------------------

The ``monotonic_mag`` parameter controls how operation strength changes with magnitude bins:

- ``monotonic_mag=True`` (default): Strength increases with magnitude
- ``monotonic_mag=False``: Some operations (posterize, solarize) decrease in strength; 
  enhancement operations use a bidirectional range

Customization
-------------

Operations can be customized through:

- ``excluded``: List of operations to exclude from the default suite
- ``apply_rand_augment``: Direct application with custom augmentation lists
- Custom augmentation suites via ``get_rand_augment_suite`` and 
  ``get_rand_augment_non_monotonic_suite``

Supported Operations
--------------------

The default RandAugment suite includes common image transformations such as:

- Geometric: translate, rotate, shear
- Color: brightness, contrast, color, sharpness
- Other: posterize, solarize, equalize, invert

Each operation is designed to work within the RandAugment framework with discretized magnitudes.