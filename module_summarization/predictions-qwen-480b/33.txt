```
w_select
========

Select dynamics segments matching various criteria. This requires a
user-provided predicate function. By default, only matching segments are
stored. If the ``-a``/``--include-ancestors`` option is given, then matching segments
and their ancestors will be stored.

Predicate function
------------------

Segments are selected based on a predicate function, which must be callable
as ``predicate(n_iter, iter_group)`` and return a collection of segment IDs
matching the predicate in that iteration.

The predicate may be inverted by specifying the ``-v``/``--invert`` command-line
argument.

Output format
-------------

The output file (``-o``/``--output``, by default ``select.h5``) contains the following
datasets:

``/n_iter`` [iteration]
  *(Integer)* Iteration numbers for each entry in other datasets.

``/n_segs`` [iteration]
  *(Integer)* Number of segment IDs matching the predicate (or inverted
  predicate, if ``-v``/``--invert`` is specified) in the given iteration.

``/seg_ids`` [iteration][segment]
  *(Integer)* Matching segments in each iteration. For an iteration
  ``n_iter``, only the first ``n_iter`` entries are valid. For example,
  the full list of matching seg_ids in the first stored iteration is
  ``seg_ids[0][:n_segs[0]]``.

``/weights`` [iteration][segment]
  *(Floating-point)* Weights for each matching segment in ``/seg_ids``.

Command-line arguments
----------------------

.. program:: w_select

.. option:: -h, --help

  Show help message and exit.

.. option:: -p MODULE.FUNCTION, --predicate-function MODULE.FUNCTION

  Use the given predicate function to match segments. This function
  should take an iteration number and the HDF5 group corresponding to that
  iteration and return a sequence of seg_ids matching the predicate, as in
  ``match_predicate(n_iter, iter_group)``.

.. option:: -v, --invert

  Invert the match predicate.

.. option:: -a, --include-ancestors

  Include ancestors of matched segments in output.

.. option:: -o OUTPUT, --output OUTPUT

  Write output to OUTPUT (default: ``select.h5``).
```