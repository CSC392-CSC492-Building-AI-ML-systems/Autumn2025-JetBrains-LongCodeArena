```
Plothist
========

The ``plothist`` command is used to generate plots from histogram data stored in HDF5 files. It supports various plot types, including 1-D line plots and 2-D heatmaps, and allows customization of plot scales, ranges, titles, and output formats.

Usage
-----

.. code-block:: bash

    plothist [options] input [DIMENSION]

Arguments
---------

- **input**: HDF5 file containing histogram data.
- **DIMENSION** (optional): Specifies the dimension to plot, in the format ``INT[:[LB,UB]:LABEL]``:
    - ``INT``: Zero-based integer identifying the dimension.
    - ``LB,UB``: Optional lower and upper bounds for plotting.
    - ``LABEL``: Optional label for the plot axis.

Options
-------

Input Options
~~~~~~~~~~~~~

- **DIMENSION**: See above for format and usage.

Output Options
~~~~~~~~~~~~~~

- ``-o``, ``--output``, ``--plot-output`` *PLOT_OUTPUT*:
    Store the plot as *PLOT_OUTPUT*. The format is determined by the file extension. To suppress plotting, set to an empty string (e.g., ``--plot-output=''``). Default: ``hist.pdf``.

- ``--hdf5-output`` *HDF5_OUTPUT*:
    Store plot data in the specified HDF5 file.

- ``--plot-contour``:
    Superimpose a contour plot over the heatmap for 2-D plots.

Plot Options
~~~~~~~~~~~~

- ``--title`` *TITLE*:
    Include *TITLE* as the top-of-graph title.

Scale Options (mutually exclusive)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

- ``--linear``:
    Plot the histogram on a linear scale.

- ``--energy``:
    Plot the histogram on an inverted natural log scale, corresponding to (free) energy. This is the default.

- ``--zero-energy`` *E*:
    Set the zero of energy to *E*, which may be a scalar, ``min``, or ``max``. Default: ``min``.

- ``--log10``:
    Plot the histogram on a base-10 log scale.

Range Options
~~~~~~~~~~~~~

- ``--range`` *LB,UB*:
    Plot histogram ordinates over the given range. For 1-D plots, this affects the Y axis. For 2-D plots, it affects the colorbar axis. Default: full range.

Postprocessing Options
~~~~~~~~~~~~~~~~~~~~~~

- ``--postprocess-function`` *module.function*:
    Names a function that will be called just prior to saving the plot. The function is called as ``postprocess(hist, midpoints, binbounds)``, where:
        - ``hist``: The histogram that was plotted.
        - ``midpoints``: Bin midpoints for each dimension.
        - ``binbounds``: Bin boundaries for each dimension (or ``None`` for 1-D plots).
    The plot must be modified in place using the ``pyplot`` stateful interface.

Description
-----------

The ``plothist`` command reads histogram data from an HDF5 file and generates plots based on the specified dimensions and options. It supports 1-D and 2-D histograms, with options to customize the scale (linear, energy, log10), range, and appearance of the plot.

For 2-D histograms, a heatmap is generated, and optionally, a contour plot can be superimposed. The energy scale is particularly useful for visualizing free energy landscapes, where the zero point can be set to the minimum, maximum, or a specific value.

The command also allows for postprocessing of the plot via a user-defined function, enabling further customization before the plot is saved.

Examples
--------

Plot a 1-D histogram from the first dimension with default settings:

.. code-block:: bash

    plothist data.h5

Plot a 2-D histogram with custom axis labels and a specific range:

.. code-block:: bash

    plothist data.h5 0:0,10:Distance 1:0,5:Angle --range 0,100 --output plot.png

Plot a histogram on an energy scale with a custom title and zero point set to the maximum:

.. code-block:: bash

    plothist data.h5 --energy --zero-energy max --title "Free Energy Landscape" --output energy_plot.pdf

Superimpose a contour plot on a 2-D heatmap:

.. code-block:: bash

    plothist data.h5 0 1 --plot-contour --output contour_plot.pdf
```