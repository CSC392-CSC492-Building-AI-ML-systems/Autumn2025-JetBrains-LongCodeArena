Overview
--------

This module implements the Multiple Imputation through Chained 
Equations (MICE) approach to handling missing data in statistical data 
analyses. The approach has the following steps:

0. Impute each missing value with the mean of the observed values of 
the same variable.

1. For each variable in the data set with missing values (termed the 
'focus variable'), do the following:

1a. Fit an 'imputation model', which is a regression model for the 
focus variable, regressed on the observed and (current) imputed values 
of some or all of the other variables.

1b. Impute the missing values for the focus variable.  Currently this 
imputation must use the 'predictive mean matching' (pmm) procedure.

2. Once all variables have been imputed, fit the 'analysis model' to 
the data set.

3. Repeat steps 1-2 multiple times and combine the results using a 
'combining rule' to produce point estimates of all parameters in the 
analysis model and standard errors for them.

The imputations for each variable are based on an imputation model 
that is specified via a model class and a formula for the regression 
relationship.  The default model is OLS, with a formula specifying 
main effects for all other variables.

The MICE procedure can be used in one of two ways:

* If the goal is only to produce imputed data sets, the MICEData class 
can be used to wrap a data frame, providing facilities for doing the 
imputation.  Summary plots are available for assessing the performance 
of the imputation.

* If the imputed data sets are to be used to fit an additional 
'analysis model', a MICE instance can be used.  After specifying the 
MICE instance and running it, the results are combined using the 
`combine` method.  Results and various summary plots are then 
available.

Terminology
-----------

The primary goal of the analysis is usually to fit and perform 
inference using an 'analysis model'. If an analysis model is not 
specified, then imputed datasets are produced for later use.

The MICE procedure involves a family of imputation models.  There is 
one imputation model for each variable with missing values.  An 
imputation model may be conditioned on all or a subset of the 
remaining variables, using main effects, transformations, 
interactions, etc. as desired.

A 'perturbation method' is a method for setting the parameter estimate 
in an imputation model.  The 'gaussian' perturbation method first fits 
the model (usually using maximum likelihood, but it could use any 
statsmodels fit procedure), then sets the parameter vector equal to a 
draw from the Gaussian approximation to the sampling distribution for 
the fit.  The 'bootstrap' perturbation method sets the parameter 
vector equal to a fitted parameter vector obtained when fitting the 
conditional model to a bootstrapped version of the data set.

Class structure
---------------

There are two main classes in the module:

* 'MICEData' wraps a Pandas dataframe, incorporating information about 
  the imputation model for each variable with missing values. It can 
  be used to produce multiply imputed data sets that are to be further 
  processed or distributed to other researchers.  A number of plotting 
  procedures are provided to visualize the imputation results and 
  missing data patterns.  The `history_func` hook allows any features 
  of interest of the imputed data sets to be saved for further 
  analysis.

* 'MICE' takes both a 'MICEData' object and an analysis model 
  specification.  It runs the multiple imputation, fits the analysis 
  models, and combines the results to produce a `MICEResults` object. 
  The summary method of this results object can be used to see the key 
  estimands and inferential quantities.

Notes
-----

By default, to conserve memory 'MICEData' saves very little 
information from one iteration to the next.  The data set passed by 
the user is copied on entry, but then is over-written each time new 
imputations are produced.  If using 'MICE', the fitted 
analysis models and results are saved.  MICEData includes a 
`history_callback` hook that allows arbitrary information from the 
intermediate datasets to be saved for future use.

References
----------

JL Schafer: 'Multiple Imputation: A Primer', Stat Methods Med Res, 
1999.

TE Raghunathan et al.: 'A Multivariate Technique for Multiply 
Imputing Missing Values Using a Sequence of Regression Models', Survey 
Methodology, 2001.

SAS Institute: 'Predictive Mean Matching Method for Monotone Missing 
Data', SAS 9.2 User's Guide, 2014.

A Gelman et al.: 'Multiple Imputation with Diagnostics (mi) in R: 
Opening Windows into the Black Box', Journal of Statistical Software, 
2009.