# HDF5 Parser Documentation

## Overview

This module provides a collection of predefined transformations for the `HDF5Reader` class, which is designed to parse and process HDF5 files. The transformations are flexible functions that can handle various data types and structures commonly found in HDF5 files.

## Key Features

- **Flexible Data Handling**: Transformations can process `h5py.Dataset` objects, numpy arrays, and dictionaries
- **Extensible Design**: New transformations can be easily registered using decorators
- **Error Handling**: Graceful error handling with clear error messages
- **Attribute Processing**: Support for transformations that depend on previously processed attributes

## Available Transformations

### Basic Dataset Operations

#### `get_first_element(dataset)`
Retrieves the first element of a dataset.

**Parameters:**
- `dataset`: The dataset to transform

**Returns:** First element of the dataset

#### `index_dataset(dataset, index)`
Retrieves the n-th element of a dataset.

**Parameters:**
- `dataset`: The dataset to transform
- `index`: The index position to retrieve

**Returns:** Element at the specified index

#### `slice_dataset(dataset, slice_arg)`
Slices a dataset using the provided slice argument.

**Parameters:**
- `dataset`: The dataset to transform
- `slice_arg`: The slice to apply to the dataset

**Returns:** Sliced portion of the dataset

### Dataset Information

#### `get_shape(dataset)`
Retrieves the shape of a dataset.

**Parameters:**
- `dataset`: The dataset to get the shape from

**Returns:** Shape of the dataset

#### `get_name(dataset, full_path=False)`
Retrieves the name of a dataset.

**Parameters:**
- `dataset`: The dataset to get the name from
- `full_path`: If True, returns the full path; otherwise returns just the name

**Returns:** Name of the dataset

### Array Manipulation

#### `tile_array(dataset, n_repeats)`
Repeats an array n-times using numpy.tile.

**Parameters:**
- `dataset`: The dataset to transform
- `n_repeats`: Number of times to repeat the array

**Returns:** Dataset repeated n-times

#### `repeat_array(dataset, n_repeats)`
Repeats each element in an array n-times using numpy.repeat.

**Parameters:**
- `dataset`: The dataset to transform
- `n_repeats`: Number of times to repeat each element

**Returns:** Dataset with elements repeated n-times

### Group Operations

#### `get_all_child_datasets(group, ignore=None, contains=None)`
Retrieves all datasets contained within a given group.

**Parameters:**
- `group`: h5py object to extract from
- `ignore`: String or iterable of strings to ignore specific keys
- `contains`: String or iterable of strings that must be present in keys

**Returns:** Dictionary with contained datasets keyed by their names

## Transformation Framework

### Decorator System

Transformations are registered using the `@hdf5_transformation` decorator:

```python
@hdf5_transformation(attribute_needed=False)
def my_transformation(dataset):
    # transformation logic here
    pass
```

**Parameters:**
- `attribute_needed`: Boolean indicating if the transformation requires previously processed attribute values

### Error Handling

All transformations are wrapped with error handling that raises `HDF5TransformationError` with descriptive messages when failures occur.

## Data Type Support

Transformations handle three main data types:

1. **h5py.Dataset**: Raw HDF5 dataset objects that may need conversion to numpy arrays
2. **numpy.ndarray**: Already converted numpy arrays
3. **dict**: Dictionaries containing multiple datasets, allowing for batch processing

When a transformation receives a dictionary, it can either:
- Apply the transformation to all keys in the dictionary
- Process each key-value pair individually

## Usage Examples

```python
# Get first element of a dataset
result = get_first_element(dataset)

# Slice a dataset
sliced_data = slice_dataset(dataset, slice(0, 10))

# Get all child datasets from a group
child_datasets = get_all_child_datasets(group, ignore=['temp', 'backup'])
```

## License Information

This code is part of the Masci-tools package, developed by Forschungszentrum JÃ¼lich GmbH. All rights reserved. For licensing details, see the LICENSE.txt file or visit http://judft.de/.