Pipelines and composite estimators
==================================

.. currentmodule:: sklearn.pipeline

Many machine learning tasks involve chaining multiple algorithms together, such as preprocessing steps followed by a classifier or regressor. Scikit-learn provides utilities in the :mod:`sklearn.pipeline` module to facilitate building and managing such composite estimators.

Pipeline
--------

The :class:`Pipeline` class is a powerful tool for chaining multiple estimators into a single estimator. This is particularly useful for workflows that involve several processing steps, such as feature scaling, dimensionality reduction, and classification.

A pipeline is defined by a list of steps, where each step is a tuple consisting of a name and an estimator. All steps except the last one must be transformers (i.e., they must implement both `fit` and `transform` methods). The last step can be any estimator, typically one that implements `fit` and `predict` methods, such as a classifier or regressor.

Caching transformers
^^^^^^^^^^^^^^^^^^^^

To avoid refitting transformers that are computationally expensive, pipelines support caching through the `memory` parameter. When enabled, the fitted transformers are cached to disk, and subsequent fittings will reuse the cached results if the data and parameters have not changed.

Parameter setting
^^^^^^^^^^^^^^^^^

Parameters of individual steps in a pipeline can be set or accessed using the syntax `step_name__parameter_name`. This allows for fine-tuning individual components of the pipeline, such as setting the regularization parameter of a classifier or the number of components in a dimensionality reduction step.

.. rubric:: Example

The following example demonstrates how to construct and use a pipeline that combines standard scaling and support vector classification:

    >>> from sklearn.svm import SVC
    >>> from sklearn.preprocessing import StandardScaler
    >>> from sklearn.datasets import make_classification
    >>> from sklearn.model_selection import train_test_split
    >>> from sklearn.pipeline import Pipeline
    >>> X, y = make_classification(random_state=0)
    >>> X_train, X_test, y_train, y_test = train_test_split(X, y,
    ...                                                     random_state=0)
    >>> pipe = Pipeline([('scaler', StandardScaler()), ('svc', SVC())])
    >>> # The pipeline can be used as any other estimator
    >>> # and avoids leaking the test set into the train set
    >>> pipe.fit(X_train, y_train).score(X_test, y_test)
    0.88
    >>> # An estimator's parameter can be set using '__' syntax
    >>> pipe.set_params(svc__C=10).fit(X_train, y_train).score(X_test, y_test)
    0.76

Composite estimators
--------------------

In addition to pipelines, scikit-learn provides other utilities for building composite estimators. These include:

- :class:`FeatureUnion`: Combines the output of multiple transformers into a single transformer. This is useful for combining features from different sources or using multiple feature extraction methods.
- :func:`make_pipeline`: A convenience function for creating pipelines without explicitly naming each step. The names are automatically generated based on the class names of the estimators.
- :func:`make_union`: A convenience function for creating feature unions without explicitly naming each transformer.

These tools allow for flexible and modular construction of machine learning workflows, enabling users to build complex models from simple building blocks.