.. _augmentations_module:

Augmentations Module
====================

This module provides a standard suite of image augmentations commonly used by AutoAugment policies such as ImageNet, RandAugment, and TrivialAugmentWide. These augmentations are implemented using DALI (NVIDIA Data Loading Library) operators for high-performance data processing.

Each augmentation is decorated with the ``@augmentation`` decorator, which manages the computation of transformation parameters based on magnitude bins. This allows for flexible and dynamic augmentation strength adjustments during training.

.. note::
   This module requires NumPy to be installed, as it is used internally for parameter calculations.

Core Concepts
-------------

The ``@augmentation`` decorator modifies the behavior of augmentation functions to accept magnitude-based parameters instead of direct transformation values. When an augmented function is called:

- It expects a batch of samples as the first positional argument.
- Instead of explicit parameters, it receives ``magnitude_bin`` and ``num_magnitude_bins``.
- The actual parameter is computed as: ``mag_to_param(magnitudes[magnitude_bin] * ((-1) ** random_sign))``, where ``magnitudes`` is a linear space between ``mag_range[0]`` and ``mag_range[1]``.

Customizing Augmentations
-------------------------

You can easily adjust the behavior of existing augmentations by creating new instances with modified parameters. For example:

.. code-block:: python

   # Increase shear_x magnitude range from 0.3 to 0.5
   my_shear_x = shear_x.augmentation(mag_range=(0, 0.5))

Available Augmentations
-----------------------

Shear
^^^^^

.. autofunction:: shear_x(data, shear, fill_value=128, interp_type=None)

.. autofunction:: shear_y(data, shear, fill_value=128, interp_type=None)

Translation
^^^^^^^^^^^

.. autofunction:: translate_x(data, rel_offset, shape, fill_value=128, interp_type=None)

.. autofunction:: translate_x_no_shape(data, offset, fill_value=128, interp_type=None)

.. autofunction:: translate_y(data, rel_offset, shape, fill_value=128, interp_type=None)

.. autofunction:: translate_y_no_shape(data, offset, fill_value=128, interp_type=None)

Rotation
^^^^^^^^

.. autofunction:: rotate(data, angle, fill_value=128, interp_type=None, rotate_keep_size=True)

Brightness and Contrast
^^^^^^^^^^^^^^^^^^^^^^^

.. autofunction:: brightness(data, parameter)

.. autofunction:: contrast(data, parameter)

Helper Functions
----------------

.. autofunction:: shift_enhance_range(magnitude)

These functions support the core augmentation operations by converting magnitude values into appropriate parameter ranges for DALI operators.