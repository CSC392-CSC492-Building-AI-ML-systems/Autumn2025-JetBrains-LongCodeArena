FITS Headers
============

In the FITS (Flexible Image Transport System) format, headers play a crucial role in describing the structure and metadata of the data units within a FITS file. Each Header is composed of a series of 80-character keyword records that contain key-value pairs along with optional comments. These headers precede each data unit (Primary Array, Image Extension, or Table Extension) in a FITS file.

Header Structure
----------------

Each header record in a FITS file is an 80-character string structured as follows:

- Characters 1–8: Keyword name (uppercase letters, digits, hyphens, and underscores)
- Character 9: Equals sign ``=`` (for keyword-value pairs)
- Characters 11–30: Value field (format depends on data type)
- Character 31: Forward slash ``/`` (separator for comments)
- Characters 32–80: Comment field (optional)

Special Keywords
----------------

There are several reserved keywords with specific meanings:

- ``SIMPLE``: Indicates if the file conforms to the FITS standard (Primary Header only)
- ``BITPIX``: Bits per data value (e.g., 8, 16, 32, -32, -64)
- ``NAXIS``: Number of array dimensions
- ``NAXISn``: Size of the nth dimension
- ``EXTEND``: Indicates if extensions are present (Primary Header only)
- ``XTENSION``: Identifies the extension type (Extension Headers only)
- ``PCOUNT``: Parameter count (number of bytes following the data)
- ``GCOUNT``: Group count (for random groups; usually 1)
- ``END``: Marks the end of the header

Header Verification
-------------------

The FITS header verification system ensures that headers conform to the FITS standard. The verification process can handle various issues through configurable options:

Verification Options
^^^^^^^^^^^^^^^^^^^^

- ``ignore``: Ignore all verification issues
- ``warn``: Issue warnings for verification problems (default behavior)
- ``exception``: Raise exceptions for verification problems
- ``fix``: Automatically fix issues where possible and report others
- ``silentfix``: Fix issues silently without reporting
- ``fix+ignore``: Fix issues and ignore unfixable errors
- ``fix+warn``: Fix issues and warn about unfixable errors
- ``fix+exception``: Fix issues and raise exceptions for unfixable errors
- ``silentfix+ignore``: Silently fix issues and ignore remaining errors
- ``silentfix+warn``: Silently fix issues and warn about remaining errors
- ``silentfix+exception``: Silently fix issues and raise exceptions for remaining errors

Verification Methods
^^^^^^^^^^^^^^^^^^^^

The verification system provides the following capabilities:

- Automatic detection of header formatting issues
- Fixing of common problems such as incorrect keyword formatting
- Reporting of unfixable errors through warnings or exceptions
- Hierarchical error reporting for complex header structures

Error Handling
--------------

The verification system uses two main exception classes for handling header issues:

- ``VerifyError``: Raised for serious verification problems that prevent proper header interpretation
- ``VerifyWarning``: Issued for less severe issues that may not affect functionality but violate FITS standards

When verification detects issues, it can either attempt to fix them automatically (for supported cases) or report them according to the selected verification option. The system uses zero-based indexing in all error reports for consistency with Python conventions.

Header Extensions
-----------------

FITS headers support various extension types including:

- Image Extensions: For multi-dimensional array data
- ASCII Table Extensions: For tabular data in ASCII format
- Binary Table Extensions: For tabular data in binary format
- Random Groups: For specialized data groupings

Each extension type has specific required and optional keywords that define its structure and content. The ``XTENSION`` keyword identifies the extension type, and additional keywords provide the necessary metadata for proper interpretation of the extension data.