Examples and Usage
==================

Field Definition
----------------

Fields in Tortoise ORM are used to define the structure of your models. Each field corresponds to a column in the database table and defines the type of data that can be stored in that column.

Basic Field Usage
^^^^^^^^^^^^^^^^^

Here's a basic example of how to define fields in a model:

.. code-block:: python3

    from tortoise.models import Model
    from tortoise.fields import IntField, CharField, BooleanField, DatetimeField

    class User(Model):
        id = IntField(pk=True)
        username = CharField(max_length=50, unique=True)
        email = CharField(max_length=100)
        is_active = BooleanField(default=True)
        created_at = DatetimeField(auto_now_add=True)

In this example:
- ``id`` is an integer primary key field
- ``username`` is a character field with maximum length of 50 characters and must be unique
- ``email`` is a character field with maximum length of 100 characters
- ``is_active`` is a boolean field with a default value of True
- ``created_at`` is a datetime field that automatically sets to the current time when a record is created

Field Parameters
^^^^^^^^^^^^^^^^

All fields accept common parameters:

.. code-block:: python3

    class ExampleModel(Model):
        # Basic field with common parameters
        name = CharField(
            max_length=100,
            null=False,              # Cannot be NULL in database
            default="Unknown",       # Default value
            unique=True,             # Must be unique across table
            index=True,              # Create database index
            description="User name"  # Field description
        )
        
        # Primary key field
        id = IntField(pk=True)
        
        # Field with source_field (database column name)
        db_column = CharField(max_length=50, source_field="actual_db_column_name")

Field Types
-----------

Tortoise ORM provides various field types for different data types:

String Fields
^^^^^^^^^^^^^

.. code-block:: python3

    class StringExample(Model):
        # Character field with maximum length
        name = CharField(max_length=100)
        
        # Text field for longer content
        description = TextField()
        
        # Fixed length character field
        code = CharField(max_length=10, index=True)

Numeric Fields
^^^^^^^^^^^^^^

.. code-block:: python3

    class NumericExample(Model):
        # Integer fields
        small_number = SmallIntField()
        regular_number = IntField()
        big_number = BigIntField()
        
        # Decimal field for precise calculations
        price = DecimalField(max_digits=10, decimal_places=2)
        
        # Float field
        rating = FloatField()

Date and Time Fields
^^^^^^^^^^^^^^^^^^^^

.. code-block:: python3

    class DateTimeExample(Model):
        # Date only
        birth_date = DateField()
        
        # Time only
        meeting_time = TimeField()
        
        # Date and time
        created_at = DatetimeField(auto_now_add=True)
        updated_at = DatetimeField(auto_now=True)

Boolean and Binary Fields
^^^^^^^^^^^^^^^^^^^^^^^^^

.. code-block:: python3

    class MiscExample(Model):
        # Boolean field
        is_active = BooleanField(default=True)
        
        # Binary field for storing bytes
        data = BinaryField()

Relationship Fields
^^^^^^^^^^^^^^^^^^^

.. code-block:: python3

    class Author(Model):
        id = IntField(pk=True)
        name = CharField(max_length=100)

    class Book(Model):
        id = IntField(pk=True)
        title = CharField(max_length=200)
        
        # Foreign key relationship
        author = ForeignKeyField('models.Author', related_name='books')
        
        # Many-to-many relationship
        categories = ManyToManyField('models.Category', related_name='books')

Custom Field Implementation
---------------------------

You can create custom fields by extending the base Field class:

.. code-block:: python3

    from tortoise.fields import Field
    from pypika.terms import Term

    class CustomField(Field):
        """
        Example of a custom field implementation
        """
        field_type = str
        SQL_TYPE = "VARCHAR(255)"
        
        def __init__(self, custom_param=None, **kwargs):
            super().__init__(**kwargs)
            self.custom_param = custom_param
            
        def to_db_value(self, value, instance) -> str:
            # Convert Python value to database value
            if value is None:
                return value
            return str(value).upper()
            
        def to_python_value(self, value) -> str:
            # Convert database value to Python value
            if value is None:
                return value
            return str(value).lower()

    class ModelWithCustomField(Model):
        id = IntField(pk=True)
        custom_data = CustomField(custom_param="example")

Database-Specific Field Configuration
-------------------------------------

You can override field behavior for specific database backends:

.. code-block:: python3

    class CustomField(Field):
        SQL_TYPE = "VARCHAR(255)"
        
        class _db_sqlite:
            SQL_TYPE = "TEXT"
            
        class _db_postgres:
            SQL_TYPE = "VARCHAR(255) COLLATE \"C\""

Field Validation and Constraints
--------------------------------

Fields can include validation and constraints:

.. code-block:: python3

    class ValidatedModel(Model):
        # Field with validation in to_python_value
        email = CharField(max_length=100)
        
        def to_python_value(self, value):
            if value and "@" not in value:
                raise ValueError("Invalid email format")
            return value

Usage in Queries
----------------

Fields are used in queries to filter, order, and manipulate data:

.. code-block:: python3

    # Create a new record
    user = await User.create(username="john", email="john@example.com")
    
    # Filter by field
    active_users = await User.filter(is_active=True)
    
    # Order by field
    users_by_name = await User.all().order_by('username')
    
    # Update specific fields
    await User.filter(id=1).update(email="newemail@example.com")
    
    # Access field values
    print(user.username)  # Access field value
    print(user.created_at)  # Access auto-generated timestamp

Field Descriptions and Documentation
------------------------------------

Fields can include descriptions that appear in model documentation:

.. code-block:: python3

    class DocumentedModel(Model):
        id = IntField(pk=True, description="Primary key identifier")
        name = CharField(
            max_length=100, 
            description="Human-readable name of the entity"
        )
        created_at = DatetimeField(
            auto_now_add=True,
            description="Timestamp when record was created"
        )