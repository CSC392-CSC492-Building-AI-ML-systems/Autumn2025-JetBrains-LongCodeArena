Geometric Image Transformations
===============================

This module provides classes and functions for performing geometric image transformations, particularly focusing on the pinhole camera model and related operations.

Pinhole Camera Model
--------------------

.. autoclass:: kornia.geometry.PinholeCamera
   :members:
   :undoc-members:
   :show-inheritance:

The :class:`PinholeCamera` class represents a pinhole camera model that encapsulates both intrinsic and extrinsic camera parameters. It provides convenient access to various camera properties and transformation matrices.

Camera Parameters
^^^^^^^^^^^^^^^^^

The pinhole camera model uses two main types of parameters:

1. **Intrinsic Parameters**: Internal camera parameters that define how the camera projects 3D points onto the image plane.
2. **Extrinsic Parameters**: External parameters that define the camera's position and orientation in the world coordinate system.

Intrinsic Matrix
^^^^^^^^^^^^^^^^

The intrinsic matrix (also called camera matrix) is a 3x3 matrix that contains the internal parameters of the camera:

.. math::
    K = \begin{bmatrix}
    f_x & 0 & c_x \\
    0 & f_y & c_y \\
    0 & 0 & 1
    \end{bmatrix}

Where:
- :math:`f_x`, :math:`f_y`: focal lengths in pixel units
- :math:`c_x`, :math:`c_y`: principal point coordinates (usually the image center)

In the :class:`PinholeCamera` class, the full 4x4 intrinsic matrix is stored, which extends the 3x3 camera matrix:

.. math::
    K_{4x4} = \begin{bmatrix}
    f_x & 0 & c_x & 0 \\
    0 & f_y & c_y & 0 \\
    0 & 0 & 1 & 0 \\
    0 & 0 & 0 & 1
    \end{bmatrix}

Extrinsic Matrix
^^^^^^^^^^^^^^^^

The extrinsic matrix is a 4x4 transformation matrix that describes the camera's position and orientation in the world coordinate system:

.. math::
    E = \begin{bmatrix}
    R & t \\
    0 & 1
    \end{bmatrix}

Where:
- :math:`R`: 3x3 rotation matrix
- :math:`t`: 3x1 translation vector

Properties
^^^^^^^^^^

The :class:`PinholeCamera` class provides the following properties for accessing camera parameters:

**Intrinsic Parameters:**
- :attr:`fx`, :attr:`fy`: focal lengths in x and y directions
- :attr:`cx`, :attr:`cy`: principal point coordinates

**Extrinsic Parameters:**
- :attr:`tx`, :attr:`ty`, :attr:`tz`: translation vector components
- :attr:`rotation_matrix`: 3x3 rotation matrix
- :attr:`translation_vector`: 3x1 translation vector

**Transformation Matrices:**
- :attr:`camera_matrix`: 3x3 intrinsic matrix
- :attr:`rt_matrix`: 3x4 rotation-translation matrix
- :attr:`intrinsics`: full 4x4 intrinsic matrix
- :attr:`extrinsics`: full 4x4 extrinsic matrix

Batch Processing
^^^^^^^^^^^^^^^^

The :class:`PinholeCamera` class is designed to work with batches of cameras, allowing for parallel processing of multiple camera configurations. All tensor inputs and outputs have a batch dimension :math:`B` as their first dimension.

Example Usage
^^^^^^^^^^^^^

Creating a pinhole camera with batch size 1:

.. code-block:: python

    import torch
    import kornia

    # Create camera parameters
    intrinsics = torch.eye(4).unsqueeze(0)  # Batch size 1
    extrinsics = torch.eye(4).unsqueeze(0)  # Batch size 1
    height = torch.tensor([480.0])
    width = torch.tensor([640.0])

    # Create pinhole camera
    camera = kornia.geometry.PinholeCamera(intrinsics, extrinsics, height, width)

    # Access camera properties
    fx = camera.fx  # Focal length in x direction
    cx = camera.cx  # Principal point x-coordinate

Geometric Transformations
-------------------------

The module also provides functions for performing geometric transformations on points and images:

.. autofunction:: kornia.geometry.transform_points

.. autofunction:: kornia.geometry.linalg.inverse_transformation

These functions work with the camera model to transform points between different coordinate systems and perform inverse transformations when needed.