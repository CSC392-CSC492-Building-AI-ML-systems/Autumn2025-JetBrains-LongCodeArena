Asynchronous Plans
==================

.. module:: bluesky.plans

This document outlines the asynchronous plans available in the Bluesky framework. These plans are designed to allow for non-blocking execution of experimental procedures, enabling more complex and responsive experimental workflows.

Plans
-----

count
~~~~~

.. autofunction:: bluesky.plans.count

Takes one or more readings from detectors. This plan supports both a fixed number of readings and continuous acquisition until manually canceled. Delays between readings can be specified either as a scalar or an iterable of delays.

list_scan
~~~~~~~~~

.. autofunction:: bluesky.plans.list_scan

Performs a scan over one or more variables in steps simultaneously. The scan uses an inner product approach where each motor moves to corresponding positions from their respective lists. This plan ensures that all position lists are of equal length and stages the necessary metadata for the scan.

rel_list_scan
~~~~~~~~~~~~~

.. autofunction:: bluesky.plans.rel_list_scan

Executes a scan over one or more variables in steps relative to their current positions. Similar to `list_scan`, but the positions provided are relative offsets rather than absolute positions. This allows for scans centered around the current motor positions without needing to know the exact starting coordinates.

Supporting Functions
--------------------

These functions provide the underlying mechanisms that support the execution of the asynchronous plans.

scan_nd
~~~~~~~

.. autofunction:: bluesky.plans.scan_nd

A multidimensional scan that moves motors to positions specified by a cycler. This function is used internally by other scan plans to execute the actual movement and data acquisition steps.

plan_patterns.inner_list_product
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. autofunction:: bluesky.plan_patterns.inner_list_product

Generates a cycler that represents the inner product of multiple lists. This is used to create the sequence of motor positions for multidimensional scans where each motor's positions are paired with corresponding positions from other motors.

Utilities
---------

bps.one_shot
~~~~~~~~~~~~

.. autofunction:: bluesky.plan_stubs.one_shot

A basic plan stub that triggers detectors and reads their values. This is the default action performed during each step of a `count` plan.

bpp.stage_decorator
~~~~~~~~~~~~~~~~~~~

.. autofunction:: bluesky.preprocessors.stage_decorator

A decorator that stages and unstages objects (such as detectors and motors) around the execution of a plan. This ensures that devices are properly prepared before use and cleaned up afterward.

bpp.run_decorator
~~~~~~~~~~~~~~~~~

.. autofunction:: bluesky.preprocessors.run_decorator

A decorator that wraps a plan with run open and close messages. This is essential for data acquisition systems to know when a new run starts and ends, facilitating proper data handling and storage.

Msg
~~~

.. autoclass:: bluesky.utils.Msg

A message object that represents a single command in a plan. Messages are yielded by plans and processed by the RunEngine to perform actions such as moving motors, triggering detectors, or opening/closing runs.

These components together form the foundation of asynchronous experimental planning in Bluesky, allowing for flexible and powerful control over scientific instruments.