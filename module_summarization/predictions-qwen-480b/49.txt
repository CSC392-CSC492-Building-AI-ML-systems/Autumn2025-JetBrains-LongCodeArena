Duration Models
===============

This module provides tools for analyzing duration data, particularly in the context of survival analysis and cumulative incidence functions. It includes functions for estimating survival and cumulative incidence functions, along with their standard errors, under various conditions including right censoring and competing risks.

Key Features
------------

- Estimation of survival functions using Kaplan-Meier methods.
- Computation of cumulative incidence functions for competing risks.
- Support for frequency weights in estimation.
- Standard error calculations using Greenwood's formula and Tsiatis' method.
- Handling of entry times for delayed entry (left truncation).
- Graphical utilities for visualizing results.

Functions
---------

.. autofunction:: _calc_survfunc_right

    Calculate the survival function and its standard error for a single group.

    Parameters:
        time (array_like): An array of times (censoring times or event times).
        status (array_like): Indicates which event occurred at each time; 0 indicates censoring.
        weights (array_like, optional): Optional frequency weights.
        entry (array_like, optional): Entry times for delayed entry.
        compress (bool, optional): If True, only return times where events occurred.
        retall (bool, optional): If True, also return standard errors and other statistics.

    Returns:
        tuple: Survival probabilities, standard errors (if requested), unique times, rank times, risk set sizes, and death counts.

.. autofunction:: _calc_incidence_right

    Calculate the cumulative incidence function and its standard error for competing risks.

    Parameters:
        time (array_like): An array of times (censoring times or event times).
        status (array_like): Indicates which event occurred at each time; 0 indicates censoring.
        weights (array_like, optional): Optional frequency weights.

    Returns:
        tuple: Cumulative incidence probabilities, standard errors (if available), and unique times.

Classes
-------

.. autoclass:: CumIncidenceRight

    Estimation and inference for a cumulative incidence function.

    Parameters:
        time (array_like): An array of times (censoring times or event times).
        status (array_like): If status >= 1 indicates which event occurred at time t. If status = 0, the subject was censored at time t.
        title (str, optional): Optional title used for plots and summary output.
        freq_weights (array_like, optional): Optional frequency weights.
        exog (array_like, optional): Optional covariates used to account for violations of independent censoring.
        bw_factor (float, optional): Band-width multiplier for kernel-based estimation (used if exog is provided).
        dimred (bool, optional): If True, use dimensionality reduction in modeling.

    Attributes:
        time (ndarray): The input time values.
        status (ndarray): The input status values.
        weights (ndarray): The input frequency weights, if provided.
        exog (ndarray): The input covariates, if provided.
        title (str): The title for plots and summaries.
        bw_factor (float): Bandwidth factor for kernel estimation.
        dimred (bool): Whether dimensionality reduction is applied.

    Methods:
        fit(): Estimate the cumulative incidence function.
        plot(): Plot the cumulative incidence function.
        summary(): Return a summary of the fitted model.

Usage Examples
--------------

Estimating a Survival Function
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. code-block:: python

    import numpy as np
    from statsmodels.duration import _calc_survfunc_right

    # Example data
    time = np.array([1, 2, 3, 4, 5])
    status = np.array([1, 0, 1, 1, 0])

    # Estimate survival function
    sp, se, utime, rtime, n, d = _calc_survfunc_right(time, status)

Estimating Cumulative Incidence with Competing Risks
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. code-block:: python

    from statsmodels.duration import _calc_incidence_right

    # Example data with competing risks
    time = np.array([1, 2, 3, 4, 5])
    status = np.array([1, 0, 2, 1, 0])  # 0 = censored, 1 = cause 1, 2 = cause 2

    # Estimate cumulative incidence
    ip, se, utime = _calc_incidence_right(time, status)

Fitting a Cumulative Incidence Model
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. code-block:: python

    from statsmodels.duration import CumIncidenceRight

    # Example data
    time = np.array([1, 2, 3, 4, 5])
    status = np.array([1, 0, 2, 1, 0])

    # Fit model
    model = CumIncidenceRight(time, status)
    model.fit()

    # Plot results
    model.plot()

    # Print summary
    print(model.summary())