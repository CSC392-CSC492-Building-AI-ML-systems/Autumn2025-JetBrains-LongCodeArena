# Supporting Data to Plotting Functions

The `PlotData` class provides a flexible interface for handling data in plotting functions. It allows plotting functions to accept data in multiple formats while maintaining a consistent way to access and iterate over the data.

## Overview

This module enables plotting functions to work with various data structures including:
- Python dictionaries
- Pandas DataFrames
- Bokeh ColumnDataSource (when available)
- Lists of the above data structures

The key benefit is that plotting functions can accept data in multiple formats without requiring users to restructure their data, while still providing a unified interface for data access.

## Core Functionality

### Data Flexibility
The `PlotData` class supports:
- **Single data sources**: A single dictionary, DataFrame, or ColumnDataSource
- **Multiple data sources**: A list of dictionaries, DataFrames, or ColumnDataSources
- **Mixed key types**: Individual keys or lists of keys for each data dimension

### Automatic Data Expansion
When lists of keys are provided for any dimension, the class automatically expands the data to create multiple plot sets. For example, if you provide a list of y-keys with a single x-key, it will create separate plot entries for each y-key paired with the same x-data.

## Usage Example

```python
from masci_tools.vis.data import PlotData
import numpy as np

# Example data
x = np.linspace(-10, 10, 100)
data = {'x': x, 'y1': np.sin(x), 'y2': np.cos(x), 'y3': x**2}

# Create PlotData instance
p = PlotData(data, x='x', y=['y1', 'y2', 'y3'])

# Iterate over the data sets
for entry in p:
    print(entry.x)  # 'x' entry
    print(entry.y)  # 'y1' then 'y2' and finally 'y3'
```

## Key Features

### Multiple Data Dimensions
The class supports various data dimensions including:
- `x`, `y`: Primary plot coordinates
- `z`: Additional dimension (e.g., for 3D plots)
- `color`: Color mapping data
- `size`: Size mapping data

### Data Validation
- **Length checking**: Optional validation that all dictionary entries have the same length
- **Type checking**: Validation of supported data holder types
- **Consistency checking**: Ensures proper matching between data sources and key specifications

### Flexible Data Access
- **Named tuple interface**: Data entries are accessed through named attributes
- **Iterable interface**: The class can be iterated over to access each plot set
- **Dynamic key addition**: New data keys can be added after initialization (unless in strict mode)

## Advanced Features

### Copy Control
The class provides options for controlling data copying:
- `copy_data`: Whether to create copies of the input data
- `strict_data_keys`: Whether to prevent adding new data keys after initialization

### Bokeh Integration
When Bokeh is available, the class seamlessly works with `ColumnDataSource` objects, providing the same interface as with dictionaries and DataFrames.

### Same-Length Enforcement
The `same_length` parameter ensures that all entries in dictionary data sources have consistent dimensions, which is useful for preventing runtime errors in plotting functions.

## Data Structure Support

### Dictionaries
Python dictionaries are the most basic supported data structure. Keys correspond to column names, and values contain the data.

### Pandas DataFrames
DataFrames provide structured data access with built-in data type handling and additional functionality.

### Bokeh ColumnDataSource
When available, ColumnDataSource objects provide efficient data handling for Bokeh-based visualizations.

### Lists of Data Sources
Multiple data sources can be provided as a list, allowing for complex multi-dataset visualizations.

## Error Handling

The class includes comprehensive error checking for:
- Invalid data types
- Mismatched dimensions between data sources and key specifications
- Inconsistent list lengths when using multiple keys
- Attempts to add new data keys in strict mode

This robust error handling ensures that plotting functions receive properly formatted data, reducing the likelihood of runtime errors in the visualization code.