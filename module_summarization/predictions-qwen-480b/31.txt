```
w_red
=====

The ``w_red`` command calculates rate constants from WESTPA simulation data, with optional correction for reweighting and recycling (RED) to improve statistical accuracy. It reads kinetic information from the primary WESTPA HDF5 file and computes both raw and RED-corrected rates as a function of simulation iteration.

Usage
-----

.. code-block:: bash

    w_red [options]

Description
-----------

``w_red`` processes the output of a WESTPA simulation to extract rate constants between defined macrostates. It supports two modes of operation:

- **Raw Rates**: Direct calculation of rate constants from flux and population data.
- **RED-Corrected Rates**: Applies a correction factor based on the distribution of trajectory durations to account for recycling and reweighting effects.

The command operates on the main WESTPA HDF5 file (typically named ``west.h5``) and outputs rate estimates that can be used for further analysis or plotting.

Options
-------

``--help``
    Show help message and exit.

``-W``, ``--west-config``
    Path to the WESTPA configuration file (default: ``west.cfg``).

``--red``
    Enable RED correction when calculating rate constants.

``--istate``
    Initial macrostate index (0-based).

``--fstate``
    Final macrostate index (0-based).

``--output``
    Output file for rate data (default: ``rates.dat``).

Examples
--------

Calculate raw rate constants between macrostates 0 and 1:

.. code-block:: bash

    w_red --istate 0 --fstate 1

Calculate RED-corrected rate constants:

.. code-block:: bash

    w_red --red --istate 0 --fstate 1

Output Format
-------------

The output file (by default ``rates.dat``) contains columns corresponding to:

1. Iteration number
2. Raw rate constant
3. RED-corrected rate constant (if enabled)

Each row corresponds to the rate estimate at that iteration of the simulation.

See Also
--------

- :ref:`w_assign`
- :ref:`w_pdist`
- :ref:`w_trace`
```