Operations Module
=================

This module provides the core operations framework for database migration operations in SQLAlchemy Alembic. It defines the base classes and concrete implementations for various database schema modification operations.

Base Operation Classes
----------------------

MigrateOperation
^^^^^^^^^^^^^^^^

.. class:: MigrateOperation

   Base class for migration command and organization objects.

   This system is part of the operation extensibility API.

   .. attribute:: info

      A dictionary that may be used to store arbitrary information
      along with this :class:`.MigrateOperation` object.

   .. method:: reverse()

      Returns the reverse operation of this operation.

   .. method:: to_diff_tuple()

      Returns a tuple representation of this operation for diffing purposes.

AddConstraintOp
^^^^^^^^^^^^^^^

.. class:: AddConstraintOp

   Represent an add constraint operation.

   .. method:: constraint_type

      Property that returns the type of constraint.

   .. method:: from_constraint(constraint)

      Create an AddConstraintOp from a SQLAlchemy constraint object.

   .. method:: to_constraint(migration_context=None)

      Convert this operation back to a SQLAlchemy constraint object.

   .. method:: reverse()

      Returns the reverse operation (DropConstraintOp).

   .. method:: to_diff_tuple()

      Returns a tuple representation for diffing.

DropConstraintOp
^^^^^^^^^^^^^^^^

.. class:: DropConstraintOp

   Represent a drop constraint operation.

   .. method:: __init__(constraint_name, table_name, type_=None, *, schema=None, _reverse=None)

      Initialize a DropConstraintOp.

      :param constraint_name: Name of the constraint
      :param table_name: Name of the table
      :param type_: Type of constraint ('foreignkey', 'primary', 'unique', or 'check')
      :param schema: Optional schema name
      :param _reverse: Optional reverse operation

   .. method:: drop_constraint(operations, constraint_name, table_name, type_=None, *, schema=None)

      Drop a constraint of the given name, typically via DROP CONSTRAINT.

      :param constraint_name: name of the constraint
      :param table_name: table name
      :param type_: optional, required on MySQL. Can be 'foreignkey', 'primary', 'unique', or 'check'
      :param schema: Optional schema name to operate within

   .. method:: batch_drop_constraint(operations, constraint_name, type_=None)

      Issue a "drop constraint" instruction using the current batch migration context.

Constraint Operations
---------------------

The operations system supports various constraint operations:

- **Foreign Key Constraints**: Manage foreign key relationships between tables
- **Unique Constraints**: Ensure uniqueness across specified columns
- **Primary Key Constraints**: Define primary key constraints for tables
- **Check Constraints**: Add validation rules for column values

Operation Registration
----------------------

Operations are registered with the system using decorators:

- ``@Operations.register_operation`` - Register operation with main operations class
- ``@BatchOperations.register_operation`` - Register operation with batch operations

Extensibility
-------------

This module is designed to be extensible. New operations can be created by subclassing :class:`.MigrateOperation` and implementing the required methods. The system supports:

- Custom operation plugins
- Operation rewriting and transformation
- Integration with migration contexts

See Also
--------

- :ref:`operation_objects`
- :ref:`operation_plugins` 
- :ref:`customizing_revision`