Less Frequently Used FITS Data Structures
========================================

This document provides an overview of some of the less commonly used data structures in the FITS (Flexible Image Transport System) format, particularly as implemented in the `astropy.io.fits` module. While most users interact primarily with primary HDUs, image HDUs, and binary table HDUs, FITS supports a variety of additional structures that can be useful in specialized applications.

ASCII Tables
------------

ASCII table HDUs (``TableHDU``) represent tabular data in human-readable ASCII format. Unlike binary tables, ASCII tables store data as character strings with explicit formatting. Each column has a fixed width and specific format code indicating how to parse the values.

Key characteristics:
- Columns are defined with ASCII format codes (e.g., 'I5' for 5-character integers)
- Data is human-readable but less compact than binary tables
- Limited data type support compared to binary tables
- Useful for small datasets that need to be human-readable

Example ASCII table header keywords:
- ``TFORMn``: Format specification for column n
- ``TNULLn``: Null value string for column n
- ``TBCOLn``: Starting byte position of column n

Random Access Group Records
---------------------------

Random access groups (``GroupsHDU``) are an older FITS structure designed for visibility data from interferometers. They organize data into groups where each group contains both parameters and data arrays.

Structure:
- Each group has a set of parameter values followed by a data array
- All groups in a HDU have identical structure
- Designed for frequency switching and similar observing techniques

Important notes:
- Largely superseded by binary tables for new applications
- Still used in some radio astronomy archives
- Parameters can be of various types but must be consistent across groups

Variable-Length Arrays
----------------------

Variable-length array (VLA) columns in binary tables allow storing arrays of different sizes in the same column. This is implemented using the 'P' (pointer) format in TFORM keywords.

Implementation details:
- TFORMn = 'Pt(len)' where t is the data type and len is maximum length
- Actual data stored in a heap area following the main table
- Pointers in the table reference positions in the heap
- Memory efficient for sparse or irregularly sized arrays

Header Comments and History
---------------------------

FITS headers support special keywords for documentation:
- ``COMMENT``: Arbitrary descriptive comments
- ``HISTORY``: Processing history records
- ``CONTINUE``: Long string values continued from previous keywords

These provide important metadata but don't affect data interpretation by standard FITS readers.

Hierarchical Keywords
---------------------

The HIERARCH keyword convention allows for hierarchical organization of header keywords using dot notation. This extends beyond the standard 8-character keyword limit.

Example:
``HIERARCH.instrument.telescope.name = 'Hubble Space Telescope'``

This structure helps organize complex metadata while maintaining compatibility with standard FITS parsers that ignore unrecognized keywords.

Compressed Image Data
---------------------

Compressed image HDUs (``CompImageHDU``) store image data using various compression algorithms while maintaining FITS compatibility. The data is stored in a binary table structure with special keywords indicating decompression parameters.

Supported compression methods:
- Rice compression (most common)
- HCOMPRESS
- GZIP
- PLIO

Key features:
- Transparent decompression when reading
- Optional lossy compression for floating-point data
- Tile-based compression for efficient access to subregions

Verification and Error Handling
-------------------------------

The verification system provides multiple options for handling FITS standard compliance issues:
- ``ignore``: Skip verification entirely
- ``warn``: Issue warnings for non-standard structures
- ``exception``: Raise exceptions for standard violations
- ``fix``: Attempt to correct fixable issues
- ``silentfix``: Fix issues without reporting

Combinations like ``fix+warn`` allow fixing issues while warning about unfixable problems. This system helps handle real-world FITS files that may not strictly conform to standards while providing control over error handling behavior.

These less common structures provide flexibility for specialized applications while maintaining backward compatibility with standard FITS tools. Understanding them can be valuable when working with legacy data archives or specific scientific domains that utilize these features.