.. _w_kinetics:

w_kinetics
==========

The ``w_kinetics`` command calculates state-to-state rates and transition event durations by tracing trajectories. It is a deprecated wrapper around the ``w_direct trace`` command.

.. note::
   ``w_kinetics`` is deprecated. Please use ``w_direct trace`` instead.

Synopsis
--------

::

    w_kinetics [-h] [-o OUTPUT] [-a ASSIGNMENTS] [--ignore-outliers] [--serial] [--debug] [--profile] [--quiet] [--verbose] [--version]

Description
-----------

``w_kinetics`` performs path-tracing kinetics analysis to compute fluxes and transition durations between macrostates. It requires a bin assignment file (typically ``assign.h5``) that includes trajectory labeling. This file can be generated using the ``w_assign`` command.

The output of ``w_kinetics`` is typically used as input for the ``w_kinavg`` tool, which converts flux data into average rates with confidence intervals.

Output Format
-------------

The output file (by default ``kintrace.h5``) contains the following datasets:

``/conditional_fluxes`` [iteration][state][state]
    *(Floating-point)* Macrostate-to-macrostate fluxes. These are **not** normalized by the population of the initial macrostate.

``/conditional_arrivals`` [iteration][stateA][stateB]
    *(Integer)* Number of trajectories arriving at state *stateB* in a given iteration, given that they departed from *stateA*.

``/total_fluxes`` [iteration][state]
    *(Floating-point)* Total flux into a given macrostate.

``/arrivals`` [iteration][state]
    *(Integer)* Number of trajectories arriving at a given state in a given iteration, regardless of where they originated.

``/duration_count`` [iteration]
    *(Integer)* The number of event durations recorded in each iteration.

``/durations`` [iteration][event duration]
    *(Structured -- see below)* Event durations for transition events ending during a given iteration. These are stored as follows:

    - ``istate``: *(Integer)* Initial state of transition event.
    - ``fstate``: *(Integer)* Final state of transition event.
    - ``duration``: *(Floating-point)* Duration of transition, in units of tau.
    - ``weight``: *(Floating-point)* Weight of trajectory at end of transition, **not** normalized by initial state population.

Because state-to-state fluxes stored in this file are not normalized by initial macrostate population, they cannot be used as rates without further processing. The ``w_kinavg`` command is used to perform this normalization while taking statistical fluctuation and correlation into account.

Target fluxes (total flux into a given state) require no such normalization.

See Also
--------

- :ref:`w_assign` - Generate bin assignment files.
- :ref:`w_kinavg` - Convert flux data to average rates with confidence intervals.
- :ref:`w_direct` - The modern replacement for ``w_kinetics``.