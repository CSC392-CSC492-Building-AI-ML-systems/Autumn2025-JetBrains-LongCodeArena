Generate Example
================

The following example demonstrates how to generate B-spline basis functions for use in Generalized Additive Models (GAMs) using the provided code. This functionality is essential for creating smooth terms in GAMs.

Basic Usage
-----------

To generate a B-spline basis, you can use the ``make_bsplines_basis`` function:

.. code-block:: python

    import numpy as np
    from statsmodels.gam.smooth_basis import make_bsplines_basis

    # Create sample data
    x = np.linspace(0, 10, 100)
    
    # Generate B-spline basis with 5 degrees of freedom and degree 3
    basis, der_basis, der2_basis = make_bsplines_basis(x, df=5, degree=3)
    
    print(f"Basis shape: {basis.shape}")
    print(f"First derivative shape: {der_basis.shape}")
    print(f"Second derivative shape: {der2_basis.shape}")

Knot Placement Options
----------------------

The ``get_knots_bsplines`` function provides flexible knot placement strategies:

.. code-block:: python

    from statsmodels.gam.smooth_basis import get_knots_bsplines

    # Quantile-based knot placement (default)
    knots_quantile = get_knots_bsplines(x=x, df=5, spacing='quantile')
    
    # Equal spacing with specified bounds
    knots_equal = get_knots_bsplines(x=x, df=5, spacing='equal',
                                   lower_bound=0, upper_bound=10)

Advanced Example with GLMGam
----------------------------

Here's a complete example showing how to use the generated basis in a GAM model:

.. code-block:: python

    import numpy as np
    import pandas as pd
    from statsmodels.gam.generalized_additive_model import GLMGam
    from statsmodels.gam.smooth_basis import BSplines

    # Generate sample data
    np.random.seed(123)
    n = 100
    x = np.linspace(0, 10, n)
    y = np.sin(x) + np.random.normal(0, 0.1, n)
    data = pd.DataFrame({'x': x, 'y': y})

    # Create B-spline basis
    bs = BSplines(data['x'], df=[10], degree=[3])

    # Fit GAM model
    gam = GLMGam(data, smoother=bs, formula='y ~ x')
    results = gam.fit()

    print(results.summary())

Cross-Validation Example
------------------------

For model selection, you can use cross-validation with the generated splines:

.. code-block:: python

    from statsmodels.gam.gam_cross_validation import MultivariateGAMCVPath

    # Perform cross-validation over different smoothing parameters
    cv = MultivariateGAMCVPath(data, smoother=bs, formula='y ~ x')
    cv_results = cv.fit()
    
    # Get optimal smoothing parameter
    optimal_alpha = cv_results.optimal_alpha
    print(f"Optimal smoothing parameter: {optimal_alpha}")

The generated B-spline basis functions provide the foundation for flexible smooth term modeling in GAMs, allowing for automatic knot placement and efficient computation of derivatives needed for penalization.