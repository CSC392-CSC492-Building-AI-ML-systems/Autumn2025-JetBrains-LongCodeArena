Novelty and Outlier Detection
==============================

Overview
--------
This topic covers two related but distinct tasks in anomaly analysis:

- Novelty detection: identify samples that are unlike the data seen during training. You train on normal data and later classify new observations as normal or novel.
- Outlier (anomaly) detection: identify unusual observations within a dataset. The model is typically trained on data that may contain normal and anomalous instances, or on data assumed to be normal, and then assigns anomaly scores or labels to observations.

Key differences
- Training data: novelty detection trains on normal data only; outlier detection trains on data that may include anomalies or assumes a normal data distribution.
- Evaluation scenario: novelty focuses on unseen (new) data streams; outlier detection evaluates the entire dataset for anomalies.
- Estimation approach: some algorithms are specifically designed for novelty detection (e.g., OneClassSVM with novelty=True), while others are general-purpose unsupervised anomaly detectors (e.g., IsolationForest, EllipticEnvelope, LOF).

Recommended use cases
- Use novelty detection when you have a well-defined notion of “normal” behavior and expect only new, unseen patterns to appear in the future.
- Use outlier detection when anomalies are present or suspected in your data and you want to flag observations that deviate from the common patterns.

Algorithms (scikit-learn)
-------------------------

OneClassSVM (novelty detection)
- Purpose: trained on normal data to identify novel observations.
- Key option: novelty=True to enable evaluation of new samples after fitting on normal data.
- Typical interpretation: +1 for inliers, -1 for anomalies; decision_function or scores can be used for ranking.
- Example:
  .. code-block:: python
    from sklearn.svm import OneClassSVM
    # Train only on normal data
    model = OneClassSVM(nu=0.05, kernel="rbf", gamma="scale", novelty=True)
    model.fit(X_train_normal)
    # Evaluate new data for novelty
    y_pred = model.predict(X_test)  # +1 inliers, -1 novelties

IsolationForest (outlier detection)
- Purpose: unsupervised detector that isolates anomalies using random forests.
- Suitable for large datasets and mixed feature types.
- Outputs: -1 for outliers, +1 for inliers (via predict), with an anomaly score via decision_function.
- Example:
  .. code-block:: python
    from sklearn.ensemble import IsolationForest
    iso = IsolationForest(contamination=0.05, random_state=42)
    iso.fit(X)
    labels = iso.predict(X_new)  # -1 for anomalies

EllipticEnvelope (outlier detection)
- Purpose: assumes data is Gaussian and detects outliers based on the estimated ellipse.
- Useful for data that roughly follows an ellipsoidal distribution.
- Example:
  .. code-block:: python
    from sklearn.covariance import EllipticEnvelope
    ee = EllipticEnvelope(contamination=0.05)
    ee.fit(X)
    labels = ee.predict(X_new)  # -1 for anomalies

LocalOutlierFactor (outlier detection; not ideal for novelty on new data)
- Purpose: local density-based anomaly detector.
- Limitation: LOF is primarily an offline detector and is not designed for straightforward novelty detection on new data without retraining.
- Output: -1 for outliers, 1 for inliers (for the fitted data); can also provide negative_outlier_factor scores.
- Example:
  .. code-block:: python
    from sklearn.neighbors import LocalOutlierFactor
    lof = LocalOutlierFactor(novelty=False, contamination=0.05)
    lof.fit(X)  # LOF here is for batch detection; novelty=False means it cannot be used directly for new data without retraining
    labels = lof.negative_outlier_factor_

Notes and tips
- If you expect to encounter truly new patterns in the future, prefer novelty-detection configurations (e.g., OneClassSVM with novelty=True).
- For streaming or evolving data, consider detectors that support incremental learning or periodic retraining.
- The contamination parameter (where supported) should reflect the expected proportion of anomalies to balance precision and recall.

See also
--------
- scikit-learn: anomaly detection
- OneClassSVM, IsolationForest, EllipticEnvelope, LocalOutlierFactor documentation
- Tutorials on novelty vs outlier detection in anomaly analysis

This page provides a practical overview and starter code for common novelty and outlier detection tasks using scikit-learn.