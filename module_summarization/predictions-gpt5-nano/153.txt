Geometric image transformations
===============================

Overview
--------
Geometric image transformations describe how 3D points in a scene are mapped to and from 2D image pixels using a pinhole camera model. This includes handling batched camera intrinsics and extrinsics, extracting useful matrices (camera matrix, rotation, translation), and applying transformations to points via 4x4 homogeneous matrices.

PinholeCamera
-------------
Represents a Pinhole Camera model with batched intrinsics and extrinsics and image size.

Constructor
-----------
PinholeCamera(intrinsics: Tensor, extrinsics: Tensor, height: Tensor, width: Tensor)

- intrinsics: tensor of shape (B, 4, 4) containing the full 4x4 camera calibration matrix.
- extrinsics: tensor of shape (B, 4, 4) containing the full 4x4 rotation-translation matrix.
- height: tensor of shape (B,) containing the image height.
- width: tensor of shape (B,) containing the image width.

Notes
-----
- All attributes are batched to leverage PyTorch parallelism.
- The class validates shapes and maintains internal representations consistent with batch processing.

Key properties
--------------
intrinsics
    The full (B, 4, 4) intrinsics matrix.

extrinsics
    The full (B, 4, 4) extrinsics matrix.

batch_size
    The batch size B inferred from intrinsics.

fx, fy
    Focal lengths in the x and y directions:
    - fx = intrinsics[..., 0, 0]
    - fy = intrinsics[..., 1, 1]

cx, cy
    Principal point coordinates:
    - cx = intrinsics[..., 0, 2]
    - cy = intrinsics[..., 1, 2]

tx, ty, tz
    Translation components from the extrinsics:
    - tx = extrinsics[..., 0, -1]
    - ty = extrinsics[..., 1, -1]
    - tz = extrinsics[..., 2, -1]

    tx, ty, tz support setters to update the translation vector in-place.

rt_matrix
    Returns the 3x4 rotation-translation matrix: extrinsics[..., :3, :4].

camera_matrix
    Returns the 3x3 camera intrinsics matrix: intrinsics[..., :3, :3].

rotation_matrix
    Returns the 3x3 rotation matrix from the extrinsics: extrinsics[..., :3, :3].

translation_vector
    Returns the translation vector from the extrinsics: extrinsics[..., :3, -1:].

Usage notes
-----------
- Intrinsics and extrinsics are required to be in batch form: (B, 4, 4).
- Height and width must be 1D tensors of length B.
- The properties provide convenient accessors for common sub-matrices and camera parameters.

Transformations and utilities (context)
---------------------------------------
Geometric transformations often rely on:
- inverse_transformation: computing the inverse of a 4x4 transformation matrix (used to transform coordinates from one frame to another).
- transform_points: applying a 4x4 transformation to a set of 3D points.

These utilities enable operations such as projecting 3D points into image coordinates, re-projecting between camera views, and sampling with subpixel accuracy in warped images.

Derived matrices and typical use
--------------------------------
- rt_matrix combines rotation and translation for 3x4 pose representation.
- camera_matrix encodes focal lengths and principal points for portrait-to-pixel mapping.
- rotation_matrix and translation_vector separate pose components for finer control or analysis.

Example (conceptual)
----------------------
Given a batch of 3D points in world space, you can transform them to camera space using the extrinsics, then project to image space using the intrinsics. This enables projection, warping, or sampling operations that rely on geometric consistency.

See also
--------
inverse_transformation, transform_points