Nonparametric Methods
=====================

This section documents univariate nonparametric density estimation using kernel methods as implemented in Statsmodels. The primary tool is a univariate kernel density estimator (KDE) that provides a fast FFT-based option for Gaussian kernels as well as a direct-convolution option for general kernels.

Overview
--------

Nonparametric density estimation does not assume a parametric form for the underlying distribution. Instead, it uses a smoothing kernel to estimate the density from data. The KDEUnivariate class provides a convenient interface to compute and inspect the estimated density (and related quantities) for one-dimensional data.

Kernel Functions
----------------

A variety of kernels are supported. Each kernel is implemented in the statsmodels.sandbox.nonparametric.kernels module and exposed via a short switch:

- gau  : Gaussian
- epa  : Epanechnikov
- uni  : Uniform
- tri  : Triangular
- biw  : Biweight
- triw : Triweight
- cos  : Cosine
- cos2 : Cosine2

KDEUnivariate
-------------

KDEUnivariate(endog)

- endog : array_like
  The univariate data for which the density is estimated.

fit method
~~~~~~~~~~

def fit(
    self,
    kernel="gau",
    bw="normal_reference",
    fft=True,
    weights=None,
    gridsize=None,
    adjust=1,
    cut=3,
    clip=(-np.inf, np.inf),
)

Purpose
~~~~~~~

Attach the density estimate to the KDEUnivariate instance. After a successful fit, the estimated density and related attributes become available.

Parameters
~~~~~~~~~~

- kernel : str
  Kernel to be used. Choices are:
  - "biw"  for Biweight
  - "cos"  for Cosine
  - "epa"  for Epanechnikov
  - "gau"  for Gaussian
  - "uni"  for Uniform
  - "tri"  for Triangular
  - "triw" for Triweight
  - "cos2" for Cosine2

- bw : str, float, or callable
  Bandwidth selection. Choices are:
  - "scott" - 1.059 * A * nobs ** (-1/5), where A = min(std(x), IQR/1.34)
  - "silverman" - 0.9 * A * nobs ** (-1/5), with A as above
  - "normal_reference" - C * A * nobs ** (-1/5), with kernel-dependent C
  - A float: used directly as the bandwidth
  - A callable: must take exactly two parameters (fn(x, kern)) and return a float

- fft : bool
  Whether to use an FFT-based implementation. FFT is more efficient but currently supports only the Gaussian kernel and does not support weights.

- weights : array_like or None
  Optional weights applied to observations. Weights are not implemented for the FFT version.

- gridsize : int or None
  Size of the evaluation grid. If None, the grid uses max(nobs, 50).

- adjust : float
  An adjustment factor applied to the bandwidth. Effective bandwidth is bw * adjust.

- cut : float
  Extends the grid beyond the extreme data values to where the kernel density effectively goes to zero. The endpoints are Â± cut * bw * min/max(x).

- clip : tuple
  Data clipping bounds for the input data before estimation.

Returns
~~~~~~~

- KDEUnivariate
  The instance with the fitted density.

Attributes (after fit)
~~~~~~~~~~~~~~~~~~~~~~

- density
  The estimated density values on the evaluation grid.

- support
  The evaluation grid points (the "grid" or domain) where density is computed.

- bw
  The bandwidth used for the kernel density estimation.

- kernel
  The kernel function instance used for estimation (an object from kernel_switch[kernel](h=bw)).

Notes
~~~~~

- If cdf, sf, cumhazard, or entropy are requested, they are computed based on the kernel rather than the FFT approximation, even if FFT=True.

- The FFT-based implementation is faster but restricted to Gaussian kernels and to the case with no observation weights.

- Weights, if provided, are normalized by their sum.

Caching
~~~~~~~

Some properties (notably cdf) are cached using the cache_readonly decorator to avoid recomputation after the initial calculation.

CDF and Other Quantities
~~~~~~~~~~~~~~~~~~~~~~~~

- cdf
  The cumulative distribution function evaluated on the support. Will raise an error if fit has not been called. Computed from the kernel and the estimated density.

Example
-------

Example usage (as in the class docstring):

>>> import numpy as np
>>> import statsmodels.api as sm
>>> nobs = 300
>>> np.random.seed(1234)
>>> data = np.random.normal(size=nobs)
>>> dens = sm.nonparametric.KDEUnivariate(data)
>>> dens.fit()
>>> # Access the density values on the grid
>>> density_values = dens.density
>>> # Access the grid (support)
>>> grid_points = dens.support
>>> # Optional: compute CDF on the grid
>>> cdf_values = dens.cdf

References
----------

Racine, Jeff. (2008) "Nonparametric Econometrics: A Primer," Foundations and Trends in Econometrics: Vol 3: No 1, pp1-88. http://dx.doi.org/10.1561/0800000009

https://en.wikipedia.org/wiki/Kernel_%28statistics%29

Silverman, B.W.  Density Estimation for Statistics and Data Analysis.