Publishing for Web Review
=========================


Overview
--------

Publishing changes for web review uses the built-in Event Hub within an ftrack API Session. By publishing events to the event server, web review interfaces can receive updates and present items for review. Publishing behavior is controlled by session configuration and the Event Hub connection state.

Prerequisites
-------------

- A running ftrack server accessible from the client.
- API credentials:
  - api_key (FTRACK_API_KEY or provided explicitly)
  - api_user (FTRACK_API_USER or determined from environment)
- Environment or configuration for:
  - FTRACK_SERVER (server URL)
  - FTRACK_API_KEY
  - FTRACK_API_USER

Important configuration options
-------------------------------

- server_url: URL of the ftrack server (including port).
- api_key: API key used for authentication.
- api_user: username used for operations.
- auto_connect_event_hub: If True, the embedded event hub will automatically connect to the event server, enabling publishing and subscribing to non-local events. If False, only local events can be published/subscribed until the hub is explicitly connected.
- schema_cache_path: Path to a folder used for schema caching (optional).
- plugin_paths, cache, cache_key_maker, plugin_arguments: Optional configuration for plugins and caching.

Publishing for web review
-------------------------

- Enable remote publishing by enabling auto_connect_event_hub (default behavior may vary). This allows publishing and subscribing to non-local events suitable for web review workflows.
- If auto_connect_event_hub is False, remote publishing is disabled until the Event Hub is connected explicitly (EventHub.connect).
- The Event Hub connection is performed in a background thread to improve startup time. Subscribing to events does not require a connected hub, but publishing to remote endpoints does.

Publishing workflow
-------------------

1. Create a Session with the appropriate server URL and credentials.
2. Configure auto_connect_event_hub to enable remote publishing.
3. Ensure the Event Hub is connected (automatically or manually).
4. Prepare a web review payload describing the change (e.g., changesets, assets, or tasks).
5. Publish the event via the Event Hub to the web review channel/topic used by the web UI.
6. The web review interface receives the event and presents it for review; reviewers can provide feedback, approvals, or rejections.

Security and connectivity
-------------------------

- All REST requests include authentication headers using ftrack-api-key and ftrack-user to secure interactions with the server.
- Remote publishing requires a connected Event Hub and appropriate permissions on the server.

Example (conceptual)
---------------------

- Create a session with auto_connect_event_hub enabled.
- Build a web review event payload.
- Publish the payload through the Event Hub to the web review channel.