Isotonic Regression
===================

Isotonic regression fits a monotone (non-decreasing or non-increasing) function to 1D data. This module provides a small, NumPy/SciPy-based backend and a scikit-learn compatible estimator for convenient use within pipelines and cross-validation.

Functions
---------

check_increasing(x, y)
~~~~~~~~~~~~~~~~~~~~~~~

Determine whether y is monotonically correlated with x.

- Purpose
  - Uses a Spearman correlation test to decide if the relationship is increasing or decreasing.

- Parameters
  - x : array-like, shape (n_samples,)
    Training data.
  - y : array-like, shape (n_samples,)
    Training target.

- Returns
  - increasing_bool : bool
    True if the relationship is increasing (rho >= 0), False otherwise.

- Notes
  - The Spearman correlation coefficient is estimated from the data, and the sign of the estimate is used as the result.
  - If the 95% confidence interval (via the Fisher transform) spans zero (and there are more than 3 samples), a warning is issued.

- References
  - Fisher transformation. Wikipedia:
    https://en.wikipedia.org/wiki/Fisher_transformation

isotonic_regression(y, *, sample_weight=None, y_min=None, y_max=None, increasing=True)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solve the isotonic regression problem for 1D data.

- Parameters
  - y : array-like of shape (n_samples,)
    The data to fit.
  - sample_weight : array-like of shape (n_samples,), default=None
    Weights on each point. If None, weights are treated as 1.
  - y_min : float or None, default=None
    Lower bound on the lowest predicted value. If None, defaults to -inf.
  - y_max : float or None, default=None
    Upper bound on the highest predicted value. If None, defaults to +inf.
  - increasing : bool, default=True
    Whether to compute an increasing (True) or decreasing (False) fit.

- Returns
  - y_ : ndarray of shape (n_samples,)
    Isotonic fit of y.

- Notes
  - Internally, the function sorts according to the requested order, performs an in-place isotonic regression, and optionally clips to [y_min, y_max].
  - The result is returned in the same order as the input.

- References
  - Best, M. J. & Chakravarti, N. (1990). Active set algorithms for isotonic regression; a unifying framework.

IsotonicRegression
------------------

Estimator for isotonic regression with a scikit-learn compatible interface.

- Parameters
  - y_min : float, default=None
    Lower bound on the lowest predicted value (minimum value may be higher). If not set, defaults to -inf.
  - y_max : float, default=None
    Upper bound on the highest predicted value (maximum may be lower). If not set, defaults to +inf.
  - increasing : bool or 'auto', default=True
    If True, predictions are constrained to be non-decreasing with X. If False, non-increasing.
    If 'auto', the direction is decided based on the sign of the Spearman correlation estimate.
  - out_of_bounds : {'nan', 'clip', 'raise'}, default='nan'
    How to handle X values outside the training domain during prediction.
    - 'nan': predictions are NaN.
    - 'clip': predictions are clipped to the nearest interval endpoint.
    - 'raise': a ValueError is raised.

- Attributes
  - X_min_ : float
    Minimum value of input array X_ used for the left bound.
  - X_max_ : float
    Maximum value of input array X_ used for the right bound.
  - X_thresholds_ : ndarray of shape (n_thresholds,)
    Unique ascending X values used to interpolate the monotonic function.
    (versionadded: 0.24)
  - y_thresholds_ : ndarray of shape (n_thresholds,)
    Thresholded y values corresponding to X_thresholds_ (see implementation).

- Methods
  - fit(X, y) / fit_transform(X, y)
    Fit the isotonic regression model and (optionally) transform the data.
  - predict(X)
    Predict values for new X according to the fitted monotone function, handling out_of-bounds as configured.

- Examples
  - Basic usage
    - from sklearn.isotonic import IsotonicRegression
    - ir = IsotonicRegression()
    - y_ = ir.fit_transform(X, y)

  - With bounds and clipping for out-of-domain inputs
    - ir = IsotonicRegression(y_min=None, y_max=None, increasing=True, out_of_bounds='clip')
    - y_ = ir.fit_transform(X, y)

References
----------

- Best, Michael J., and Nilotpal Chakravarti. Active set algorithms for isotonic regression; a unifying framework.
- Fisher transformation. Wikipedia: https://en.wikipedia.org/wiki/Fisher_transformation

See Also
--------

- check_increasing
- isotonic_regression

Notes
-----

- This module provides a compact, dependency-light implementation intended for use with scikit-learn-style pipelines.
- The isotonic estimators support both increasing and decreasing monotone fits, with an optional auto-detection of direction based on the data.