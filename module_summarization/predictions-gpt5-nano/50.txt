Spline and smoothing bases for Generalized Additive Models (GAM)
===============================================================

Overview
--------

This module provides utilities to construct B-spline bases and their derivatives for smoothing terms in Generalized Additive Models. It relies on Patsy to generate spline structures and SciPy for evaluating B-spline basis functions. The functionality is intended to support smoothing terms in GLMGam and related GAM components.

Public API
----------

- _equally_spaced_knots(x, df)
  - Return equally spaced internal knots for a given data vector x and target degrees of freedom df.

- _R_compat_quantile(x, probs)
  - Compute quantile-based knots in a way compatible with Râ€™s behavior.

- _eval_bspline_basis(x, knots, degree, deriv='all', include_intercept=True)
  - Evaluate B-spline basis functions (and optionally their first and second derivatives) at x for given knots and degree.

- compute_all_knots(x, df, degree)
  - Compute the complete knot vector, bounds, and inner knots for a B-spline basis.

- make_bsplines_basis(x, df, degree)
  - Convenience function to obtain the B-spline basis and its derivatives for x.

- get_knots_bsplines(x=None, df=None, knots=None, degree=3, spacing='quantile', lower_bound=None, upper_bound=None, all_knots=None)
  - Retrieve or compute knots to use for B-splines, supporting quantile-based spacing or equal spacing with boundary knots.

Example
-------

The following shows how to generate a B-spline basis for a 1D predictor and inspect the results. This basis can be used as a smoothing term in a GAM (e.g., with GLMGam).

.. code-block:: python

    import numpy as np
    from smooth_basis import make_bsplines_basis, get_knots_bsplines

    # Sample data
    x = np.linspace(0, 1, 100)

    # Desired degrees of freedom and spline degree
    df = 6
    degree = 3  # cubic splines

    # Generate the B-spline basis and its derivatives
    basis, der_basis, der2_basis = make_bsplines_basis(x, df, degree)

    print("Basis shape:", basis.shape)        # e.g., (100, n_bases)
    print("Derivative-1 shape:", der_basis.shape)
    print("Derivative-2 shape:", der2_basis.shape)

    # Retrieve the knots used for the basis
    knots = get_knots_bsplines(x=x, df=df, degree=degree)
    print("Knots:", knots)

Notes
-----

- The generated basis can be used directly as smoothing terms in GAM formulations (e.g., GLMGam).
- Dependencies include numpy, scipy, and patsy.
- The module focuses on B-spline-based smoothers and provides utilities for knot placement and basis evaluation.