Imputation of missing values
=============================

Overview
--------
Missing values are common in real-world datasets. Imputation fills in these missing values
using a specified strategy so that downstream estimators can be trained without errors.

The SimpleImputer provides a simple, flexible imputation strategy that operates on each
feature (column) separately. It can handle numeric and object data and supports replacing
missing values with a constant as well as common statistics (mean, median, or most frequent).

SimpleImputer
-------------
Description
~~~~~~~~~~~
Univariate imputer for completing missing values with simple strategies.

Replace missing values using a descriptive statistic (e.g., mean, median, or most frequent)
along each column, or using a constant value.

Read more in the User Guide <impute>.

.. versionadded:: 0.20
   The SimpleImputer replaces the previous sklearn.preprocessing.Imputer estimator.

Parameters
~~~~~~~~~~
missing_values : int, float, str, np.nan, None or pandas.NA, default=np.nan
    The placeholder for the missing values. All occurrences of
    missing_values will be imputed. For pandasâ€™ dataframes with
    nullable integer dtypes with missing values, ``missing_values`` can be set to
    either ``np.nan`` or ``pd.NA``.

strategy : {'mean', 'median', 'most_frequent', 'constant'}, default='mean'
    The imputation strategy to fill in the missing values.

    - 'mean': Replace missing values using the mean along each column. Only for numeric data.
    - 'median': Replace missing values using the median along each column. Only for numeric data.
    - 'most_frequent': Replace missing values using the most frequent value along each column.
      Can be used with strings or numeric data. If there is more than one such value, the smallest
      is returned.
    - 'constant': Replace missing values with ``fill_value``. Can be used with strings or numeric data.

fill_value : str or numeric, default=None
    When ``strategy='constant'``, the value to use to fill in for missing values.
    For string or object data types, ``fill_value`` must be a string.
    If ``None``, ``fill_value`` will be 0 for numeric data and the string 'missing_value' for strings
    or object data types.

copy : bool, default=True
    If True, a copy of X will be created. If False, imputation will be done in-place whenever possible.

add_indicator : bool, default=False
    If True, a MissingIndicator is fit and transformed and its boolean indicator
    features are appended to the output to indicate locations of imputed values.

keep_empty_features : bool, default=False
    If True, features that are entirely empty are kept. See implementation for details.

Notes
~~~~~
- The imputer works feature-wise and computes statistics on the training data
  during fit, which are then used to transform new data.
- For numerical data, the default strategy (mean) is well suited for continuous variables.
- For non-numeric data, only 'most_frequent' or 'constant' are applicable.
- If ``missing_values`` is a pandas.NA, it is supported for numeric arrays as a missing value indicator.

Attributes
~~~~~~~~~~~
indicator_ : MissingIndicator or None
    Present only if ``add_indicator`` is True. Stores the fitted MissingIndicator
    used to create additional binary features indicating missing values.

statistics_ (per-feature) : array-like
    The computed statistics used for imputation (mean, median, or most_frequent)
    per feature. Not exposed in the public API as a separate attribute in all
    versions; typically accessed via the fitted estimator.

Transformers and usage
~~~~~~~~~~~~~~~~~~~~~~
- The imputer implements the TransformerMixin and BaseEstimator interfaces.
- It can be used directly in pipelines to impute missing values as part of data preprocessing.

Examples
~~~~~~~~
Basic usage with numerical data:

.. code-block:: python

   from sklearn.impute import SimpleImputer
   import numpy as np

   X = np.array([[1, 2], [np.nan, 3], [7, 6]])
   imputer = SimpleImputer(strategy='mean')
   X_imputed = imputer.fit_transform(X)

Imputing with a constant and adding an indicator:

.. code-block:: python

   X = np.array([['a', None], ['b', 'c'], [None, 'd']], dtype=object)
   imputer = SimpleImputer(strategy='constant', fill_value='missing')
   X_imputed = imputer.fit_transform(X)

   imputer_with_indicator = SimpleImputer(strategy='most_frequent', add_indicator=True)
   X_imputed, indicator = imputer_with_indicator.fit_transform(X)

See Also
~~~~~~~~
- For more advanced imputation strategies, see IterativeImputer and related estimators.

References
~~~~~~~~~~
- See User Guide: Impute (imputation of missing values).