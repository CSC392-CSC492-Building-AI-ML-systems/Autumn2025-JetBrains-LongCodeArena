Nearest Neighbors
===================

Overview
--------
Nearest neighbors search uses a Ball Tree data structure to efficiently find the closest points
in a dataset to a given query point (or set of query points) under a chosen distance metric.
The Ball Tree implementation provides fast exact neighbor queries by pruning large portions of the
search space with node bounds and reduced distance calculations.

BallTree implementations
------------------------
- BallTree: Binary-tree based index for exact nearest-neighbor queries.
- BallTree64 / BallTree32: Implementations specialized for 64-bit and 32-bit floating point data, respectively.

Supported distance metrics
--------------------------
The Ball Tree supports a variety of distance metrics. Distances may use a reduced (pruned) form for faster computation
while preserving the correct nearest-neighbor rankings. Examples include:

- Bray-Curtis
- Canberra
- Chebyshev
- Dice
- Euclidean (reduced distance is the squared Euclidean distance)
- Hamming
- Haversine
- Jaccard
- Mahalanobis
- Manhattan
- Minkowski
- PyFunc
- Rogers-Tanimoto
- Russell-Rao
- Standardized Euclidean (SEuclidean)
- Sokal-Michener
- Sokal-Sneath
- Weighted Minkowski (WMinkowski)

Usage
-----
Create a BallTree from data, then query for nearest neighbors.

Example:
.. code-block:: python

    from sklearn.neighbors import BallTree
    import numpy as np

    # X: training data, shape (n_samples, n_features)
    X = np.asarray([...], dtype=float)

    # Build the tree (64-bit or 32-bit dtypes can be used)
    tree = BallTree(X)

    # Find the k nearest neighbors of each query point Y
    Y = np.asarray([...], dtype=float)
    distances, indices = tree.query(Y, k=5)

    # Or find all neighbors within radius r
    radius = 0.5
    indices = tree.query_radius(Y, r=radius)

Notes
-----
- The reduced distance is used for performance in many metrics, e.g., squared Euclidean for Euclidean distance.
- Different implementations (64-bit vs 32-bit) are provided to optimize memory usage and speed for varying data types.
- This documentation describes the Nearest Neighbors functionality based on the Ball Tree variant implemented in the codebase.