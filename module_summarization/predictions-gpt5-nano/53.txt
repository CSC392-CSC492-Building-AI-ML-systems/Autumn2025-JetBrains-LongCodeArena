imputation.rst

MICE: Multiple Imputation by Chained Equations
=============================================

Overview
--------

This module implements the Multiple Imputation through Chained
Equations (MICE) approach for handling missing data in statistical analyses.

The typical MICE workflow follows these steps:

- Impute each missing value with a baseline value (e.g., the mean of observed values for the variable).
- For each variable with missing values (the focus variable):
  - Fit an imputation model for the focus variable, using observed and current imputed values of other variables.
  - Impute the missing values for the focus variable using predictive mean matching (PMM).
- After all variables have been imputed, fit the analysis model to the complete data.
- Repeat the above steps multiple times and combine results to obtain point estimates and standard errors.

Imputations for each variable are based on an imputation model defined by a class and a regression formula. The default is ordinary least squares (OLS) with a formula that includes main effects for all other variables.

Two usage patterns are available:

- Imputing data only: Use MICEData to wrap a DataFrame and perform imputations. Summary plots and a history concept are available to assess performance.
- Imputing data for a downstream analysis: Use MICE with a specified analysis model. After running, the results can be combined using a combining rule to produce a MICEResults object, with a summary method describing key estimands and inference quantities.

Terminology
-----------

- Analysis model: The model used to analyze the completed data after imputation.
- Imputation model: A model for each focus variable used to impute its missing values; can condition on all or a subset of the remaining variables, with possible transformations and interactions.
- Perturbation method: A method for setting the parameter estimates in an imputation model. Options include:
  - gaussian: draw parameters from the Gaussian approximation to the posterior distribution after fitting the model.
  - boot: set the parameters to a fitted vector obtained from fitting the model to a bootstrapped version of the data.

Class structure
---------------

- MICEData: Wraps a Pandas DataFrame and records the imputation model information for each variable with missing values. It can generate multiply imputed data sets and provides plotting utilities for assessing imputation performance. A history_callback hook allows saving features of interest from intermediate imputations.

- MICE: Accepts a MICEData object and an analysis model specification. It runs the multiple imputation procedure, fits the analysis models, and combines the results into a MICEResults object. The MICEResults object provides a summary of estimands and inferential quantities.

Notes
-----

- By default, for memory efficiency, MICEData stores very little information across iterations. The input data are copied on entry and then overwritten with new imputations. When using MICE, fitted analysis models and results are saved. MICEData also provides a history_callback hook to save intermediate information for later use.

References
----------

- Schafer, JL. Multiple Imputation: A Primer. Stat Methods Med Res, 1999.
- Raghunathan, TE et al. A Multivariate Technique for Multiply Imputing Missing Values Using a Sequence of Regression Models. Survey Methodology, 2001.
- SAS Institute. Predictive Mean Matching Method for Monotone Missing Data, SAS 9.2 User's Guide, 2014.
- Gelman, A et al. Multiple Imputation with Diagnostics (mi) in R: Opening Windows into the Black Box. Journal of Statistical Software, 2009.

Usage examples
--------------

Example 1: Imputing and saving imputed datasets (using per-variable imputers)

.. code-block:: python

   imp = mice.MICEData(data)
   imp.set_imputer('x1', formula='x2 + np.square(x2) + x3')
   for j in range(20):
       imp.update_all()
       imp.data.to_csv('data%02d.csv' % j)

Example 2: Iterating over imputations

.. code-block:: python

   imp = mice.MICEData(data)
   j = 0
   for data in imp:
       imp.data.to_csv('data%02d.csv' % j)
       j += 1

Notes on API
------------

- MICEData supports a set_imputer method to specify an imputation model for a given variable.
- The update_all method advances the imputation process for all variables.
- The MICE class enables combining results from multiple imputations to produce final inferences for an associated analysis model.