Migrating to nextcord
=====================


Overview
--------
This document describes the widget-related classes introduced in nextcord and how they map to the data provided by Discordâ€™s guild widgets. The Widget API exposes three main constructs: WidgetChannel, WidgetMember, and Widget, allowing you to work with widget data in a type-safe and convenient way.

WidgetChannel
-------------
Represents a partial widget channel.

Attributes
  - id: int
      The channel's ID.
  - name: str
      The channel's name.
  - position: int
      The channel's position.

Properties
  - mention: str
      The string used to mention the channel. For example: "<#1234567890>".
  - created_at: datetime
      The channel's creation time in UTC, derived from its ID.

Representation
  - __str__ returns the channel's name.
  - __repr__ returns a descriptive string including id, name, and position.

Usage example
  widget_channel = WidgetChannel(id=123, name="General", position=1)
  print(widget_channel.mention)
  print(widget_channel.created_at)


WidgetMember
------------
Represents a "partial" member of the widget's guild.

Inheritance
  - Inherits from BaseUser.

Attributes
  - id: int
      The member's ID.
  - name: str
      The member's username.
  - discriminator: str
      The member's discriminator.
  - bot: bool
      Whether the member is a bot.
  - status: Status
      The member's status.
  - nick: Optional[str]
      The member's nickname.
  - avatar: Optional[str]
      The member's avatar hash.
  - activity: Optional[Union[BaseActivity, Spotify]]
      The member's activity.
  - deafened: Optional[bool]
      Whether the member is currently deafened.
  - muted: Optional[bool]
      Whether the member is currently muted.
  - suppress: Optional[bool]
      Whether the member is currently being suppressed.
  - connected_channel: Optional[WidgetChannel]
      The channel the member is connected to.

Initialization details
  - Constructed with state, data, and an optional connected_channel.
  - nick is taken from data.get('nick').
  - status is parsed with try_enum(Status, data.get('status')).
  - deafened is data.get('deaf') or data.get('self_deaf').
  - muted is data.get('mute') or data.get('self_mute').
  - suppress is data.get('suppress').
  - If data contains 'game', an activity is created via create_activity(game).

Usage example
  widget_member = WidgetMember(
      state=state,
      data={...},
      connected_channel=widget_channel
  )
  print(widget_member.display_name)
  print(widget_member.status)
  if widget_member.activity:
      print(widget_member.activity)


Widget
------
Represents a Guild widget and aggregates widget channels and members.

Attributes
  - id: int
      The guild's ID.
  - name: str
      The guild's name.
  - channels: List[WidgetChannel]
      The accessible voice channels in the guild.
  - members: List[WidgetMember]
      The online members in the server. Offline members do not appear in the widget.

Notes
  - Due to a Discord limitation, if this data is available, it will reflect the online members and channels accessible via the widget.
  - str(widget) returns the widget's JSON URL.

Usage example
  widget = guild.widget
  print(widget.name)
  for ch in widget.channels:
      print(ch.name, ch.id)
  for m in widget.members:
      print(m.display_name)


Migration tips
--------------
- Install and import from nextcord:
  - from nextcord import Widget, WidgetChannel, WidgetMember
- Access widget data through the guild widget attribute:
  - widget = guild.widget
- Iterate over channels and members using widget.channels and widget.members.
- When handling WidgetMember, use the provided attributes (status, nick, activity, etc.) as described above.
- Activity data is created from the 'game' field via create_activity; this may yield a BaseActivity or a Spotify instance.

Notes
- The widget API in nextcord mirrors the data structure returned by Discord for widget data, including fields like 'nick', 'status', 'deaf', 'self_deaf', 'mute', 'self_mute', 'suppress', and 'game' for activity creation.
- The typing and runtime behavior are compatible with type checkers via TYPE_CHECKING imports.

See also
--------
- nextcord API reference for Guild Widget
- Activity and Spotify types in nextcord

Example complete snippet
  widget = guild.widget
  print(f"Widget for {widget.name} (ID: {widget.id})")
  for ch in widget.channels:
      print(f"Channel: {ch.name} (ID: {ch.id}, pos: {ch.position})")
  for m in widget.members:
      print(f"Member: {m.display_name} status={m.status} connected_to={getattr(m.connected_channel, 'name', None)}")