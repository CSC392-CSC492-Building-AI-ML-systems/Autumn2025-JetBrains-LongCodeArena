w_select
========

w_select â€” select dynamics segments matching various criteria

This command selects segments from WESTPA trajectory data using a user-provided predicate function. By default, only segments that match the predicate are stored. If the -a/--include-ancestors option is given, matching segments and their ancestors are stored.

Predicate function
------------------

Segments are selected based on a predicate function, which must be callable as
``predicate(n_iter, iter_group)`` and return a collection of segment IDs matching the predicate in that iteration.

The predicate may be inverted by specifying the -v/--invert command-line argument.

Output format
-------------

The output file (-o/--output, by default "select.h5") contains the following datasets:

  ``/n_iter`` [iteration]
    *(Integer)* Iteration numbers for each entry in other datasets.

  ``/n_segs`` [iteration]
    *(Integer)* Number of segment IDs matching the predicate (or inverted
    predicate, if -v/--invert is specified) in the given iteration.

  ``/seg_ids`` [iteration][segment]
    *(Integer)* Matching segments in each iteration. For an iteration
    ``n_iter``, only the first ``n_iter`` entries are valid. For example,
    the full list of matching seg_ids in the first stored iteration is
    ``seg_ids[0][:n_segs[0]]``.

  ``/weights`` [iteration][segment]
    *(Floating-point)* Weights for each matching segment in ``/seg_ids``.

Command-line arguments
----------------------

- -p, --predicate-function
  MODULE.FUNCTION
  Use the given predicate function to match segments. This function should take
  an iteration number and the HDF5 group corresponding to that iteration and
  return a sequence of seg_ids matching the predicate, as in
  ``match_predicate(n_iter, iter_group)``.

- -v, --invert
  Invert the match predicate.

- -a, --include-ancestors
  Include ancestors of matched segments in output.

- -o, --output
  OUTPUT
  Write output to OUTPUT (default: %(default)s).

- Iteration-range options
  Options for selecting a subset of iterations are provided via IterRangeSelection
  (see the IterRangeSelection group for details).