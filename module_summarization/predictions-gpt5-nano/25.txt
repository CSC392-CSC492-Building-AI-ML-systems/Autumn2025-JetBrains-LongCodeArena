w_ipa
=====

WESTPA Interactive Python Analysis (w_ipa)

Overview
--------
w_ipa is a stateful analysis tool implemented as a WESTParallelTool that provides an interactive Python interface to the current WESTPA analysis. It exposes information and operations tied to the active analysis scheme and iteration, including access to walkers, weights, progress coordinates, and traces.

Key concepts
------------
- Stateful: Data is pulled from the current analysis scheme and iteration. By default, the first analysis scheme in west.cfg is used and you start at iteration 1.
- Access via w or west: Properties such as iteration, schemes, states, and current iteration data are available through w (the tool) or west (the global namespace).
- Current iteration data: The object w.current (and its fields) exposes walkers, summary, states, seg_id, weights, parents, kinavg, pcoord, bins, populations, and auxdata (if present).
- Tracing: w.trace(seg_id) runs a trace over a seg_id in the current iteration and returns a dictionary with history information.

Public API
----------
- Access and modify iteration
  - w.iteration
  - west.iteration
  - Set: w.iteration = <new_value>
- Scheme management
  - w.list_schemes
  - w.scheme = <scheme_name_or_index>
- Current scheme details
  - w.states
  - w.bin_labels
- Current iteration data
  - w.current
  - The current data includes: walkers, summary, states, seg_id, weights, parents, kinavg, pcoord, bins, populations, and auxdata (if present)
- Trace
  - w.trace(seg_id) returns a dictionary with history for the specified segment

Usage notes
-----------
- Run help on any function or property for additional information.
- The tool is designed to be analyzed from the terminal or via plots, with the ability to switch interfaces as needed.

Implementation highlights
-------------------------
- Class: WIPI, a subclass of WESTParallelTool
- Initialization: sets up a data reader (WESTDataReader), a parallel work manager, and a progress indicator
- Version: "1.0B"
- Interface: defaults to matplotlib plots; can switch to a text-based interface when plotting is disabled
- Iteration and scheme handling: determines the current scheme from the WEST configuration and analysis settings
- Argument handling:
  - --analysis-only (-ao): run analysis and return to terminal
  - --reanalyze (-ra): delete existing files and reanalyze
  - --ignore-hash (-ih): ignore hash and avoid regenerating files
  - --debug (-d): debug output for development
  - --terminal (-t): plot output in terminal
  - -f/--extra: hidden/debug option
- Hashing and stamping:
  - hash_args(args, extra=None, path=None): creates a stable hash based on arguments and extra context
  - stamp_hash(h5file_name, new_hash): loads the HDF5 file and stamps it with the new arg_hash (read-only access expected after stamping)

Notes on internal configuration
-------------------------------
- The tool reads configuration from westpa.rc and uses the west.analysis settings to determine available analysis schemes
- Warnings are suppressed for DeprecationWarning, RuntimeWarning, FutureWarning, ImportWarning, and general warnings to keep the interactive experience clean
- The default compression is enabled unless overridden

Files and classes referenced
----------------------------
- westpa.tools: WESTParallelTool, WESTDataReader, ProgressIndicatorComponent, Plotter
- westpa.tools: WIPIDataset, __get_data_for_iteration__, WIPIScheme
- westpa.core.h5io: for HDF5 interactions
- westpa.rc.config: used to obtain analysis configuration

Examples
--------
- Inspect the current iteration:
  - w.iteration
  - west.iteration
- Change the iteration:
  - w.iteration = 100
- List and select an analysis scheme:
  - w.list_schemes
  - w.scheme = OUTPUT_FROM_w.list_schemes
- View states and bins:
  - w.states
  - w.bin_labels
- Access current iteration data and perform a trace:
  - w.current
  - w.trace(seg_id)

This documentation corresponds to the w_ipa command implemented by the WIPI class in the source, which provides the interactive, stateful WESTPA analysis environment.