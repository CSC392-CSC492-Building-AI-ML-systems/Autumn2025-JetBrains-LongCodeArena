Kernel approximation
====================

Overview
--------
The sklearn.kernel_approximation module implements several approximate kernel feature maps based on Fourier transforms and Count Sketches. These transformers map input features to a finite-dimensional feature space such that inner products in this space approximate kernel evaluations.

PolynomialCountSketch
---------------------

Description
~~~~~~~~~~~
PolynomialCountSketch provides a Tensor Sketch-based approximation of the polynomial kernel feature map. It approximates the feature map for the polynomial kernel

    K(X, Y) = (gamma * <X, Y> + coef0)^degree

by efficiently computing a Count Sketch of the outer product of a vector with itself using Fast Fourier Transforms (FFT).

Parameters
~~~~~~~~~~
gamma : float, default=1.0
    Parameter of the polynomial kernel whose feature map will be approximated. Must be non-negative.

degree : int, default=2
    Degree of the polynomial kernel whose feature map will be approximated.

coef0 : int, default=0
    Constant term of the polynomial kernel whose feature map will be approximated.

n_components : int, default=100
    Dimensionality of the output feature space. Typically, n_components should be large enough to capture the structure of the data.

random_state : int or RandomState, default=None
    Determines random number generation for indexHash and bitHash initialization. Use an int for reproducible results.

Attributes
~~~~~~~~~~
indexHash_ : ndarray of shape (degree, n_features), dtype=int64
    Array of indices in [0, n_components) representing the 2-wise independent hash functions used for Count Sketch.

bitHash_ : ndarray of shape (degree, n_features), dtype=float32
    Array with random entries in {+1, -1}, representing the 2-wise independent hash functions for Count Sketch.

n_features_in_ : int
    Number of features seen during fit.

feature_names_in_ : ndarray of shape (n_features_in_,)
    Names of features seen during fit. Defined only when X has feature names that are all strings.

    .. versionadded:: 1.0

See Also
--------
AdditiveChi2Sampler : Approximate feature map for additive chi2 kernel.
Nystroem : Approximate a kernel map using a subset of the training data.
RBFSampler : Approximate a RBF kernel feature map using random Fourier features.
SkewedChi2Sampler : Approximate feature map for "skewed chi-squared" kernel.
sklearn.metrics.pairwise.kernel_metrics : List of built-in kernels.

Examples
--------
.. code-block:: python

    from sklearn.kernel_approximation import PolynomialCountSketch
    from sklearn.linear_model import SGDClassifier

    X = [[0, 0], [1, 1], [1, 0], [0, 1]]
    y = [0, 0, 1, 1]

    ps = PolynomialCountSketch(degree=3, random_state=1)
    X_features = ps.fit_transform(X)

    clf = SGDClassifier(max_iter=10, tol=1e-3)
    clf.fit(X_features, y)

    score = clf.score(X_features, y)
    print(score)

Version
-------
This transformer was added in version 0.24.