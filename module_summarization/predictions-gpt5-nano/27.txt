w_kinetics
==========

Overview
--------

w_kinetics is a wrapper around the w_direct tool's trace subcommand used to calculate
state-to-state kinetics by tracing trajectories.

This command is deprecated; use w_direct instead.

Usage
-----

w_kinetics trace [options]

Default output file: kintrace.h5

Description
-----------

Calculate state-to-state rates and transition event durations by tracing trajectories.

A bin assignment file (usually "assign.h5") including trajectory labeling is required
(see w_assign --help for information on generating this file).

The output generated by this program is used as input for the w_kinavg tool, which
converts the flux data in the output file into average rates with confidence intervals.
See w_kinavg trace --help for more information.

Output format
-------------

The output file (-o/--output, by default kintrace.h5) contains the datasets:

  /conditional_fluxes [iteration][state][state]
    Floating-point: Macrostate-to-macrostate fluxes. These are not normalized by the population of the initial macrostate.

  /conditional_arrivals [iteration][stateA][stateB]
    Integer: Number of trajectories arriving at state stateB in a given iteration, given that they departed from stateA.

  /total_fluxes [iteration][state]
    Floating-point: Total flux into a given macrostate.

  /arrivals [iteration][state]
    Integer: Number of trajectories arriving at a given state in a given iteration, regardless of where they originated.

  /duration_count [iteration]
    Integer: The number of event durations recorded in each iteration.

  /durations [iteration][event duration]
    Structured -- see below: Event durations for transition events ending during a given iteration. Stored as:

      istate
        Integer: Initial state of transition event.
      fstate
        Integer: Final state of transition event.
      duration
        Floating-point: Duration of transition, in units of tau.
      weight
        Floating-point: Weight of trajectory at end of transition, not normalized by initial state population.

Notes
-----

Because state-to-state fluxes stored in this file are not normalized by initial macrostate population, they cannot be used as rates without further processing. The w_kinavg command is used to perform this normalization while taking statistical fluctuation and correlation into account. See w_kinavg trace --help for more information. Target fluxes (total flux into a given state) require no such normalization.

Deprecation
-----------

w_kinetics is deprecated. A deprecation warning is issued at runtime and the command forwards to w_direct. Please use w_direct instead.