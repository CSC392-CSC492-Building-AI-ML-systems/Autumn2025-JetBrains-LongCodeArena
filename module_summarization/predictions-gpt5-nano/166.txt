filenode - simulating a filesystem with PyTables
===============================================

Overview
--------
filenode provides a file-like interface to PyTables nodes, allowing you to treat a node stored in a PyTables (HDF5) file as if it were a regular binary file. Use new_node() to create a brand-new file node and open_node() to open an existing node created with new_node(). Read access is always available; write access (for new files or when opened with mode 'a+') supports appending data only. Currently only binary I/O is supported. This module is designed to be fully compatible with Python's io module interfaces.

Key concepts
------------
- NODE_TYPE = 'file'  
  Node type used by the PyTables node system.

- NODE_TYPE_VERSION
  Supported versions: [1, 2]

- new_node() / open_node()
  Functions (not shown here) to create a new file node or open an existing one for read/write access.

- RawPyTablesIO
  Base class implementing a raw binary I/O stream on top of PyTables nodes. It inherits from io.RawIOBase and provides a low-level, binary file-like interface.

RawPyTablesIO
-------------
Purpose
-------
Base class for raw binary I/O on HDF5 files using PyTables.

Initialization and state
------------------------
- Validates the node and its attributes.
- Determines the stream mode and cross-checks it against the underlying file mode.
- Reads version information from NODE_TYPE_VERSION and selects the appropriate data shape mapping.
- Maintains internal state such as:
  - _node: the PyTables node backing the stream
  - _mode: current open mode (e.g., 'r', 'w', 'a', '+')
  - _pos: current byte position in the stream
  - _version: numeric version from NODE_TYPE_VERSION
  - _vshape: a per-version function to convert a length to a shape
  - _vtype: the base numpy dtype of the node's atom

Implemented methods (high level)
-------------------------------
- tell(self)
  Return the current stream position.

- seek(self, pos, whence=0)
  Change the stream position. Supports whence values:
  - 0: start of stream
  - 1: current position
  - 2: end of stream
  Returns the new absolute position.

- seekable(self)
  Always returns True (the stream supports random access).

- fileno(self)
  Return the underlying file descriptor, if available.

- close(self)
  Flushes and closes the IO object, releasing the node.

- flush(self)
  Flush write buffers, if applicable.

- truncate(self, pos=None)
  Truncate the file to a given size. If pos is None, truncate to the current position. Only growth is supported for file nodes (rewriting/deleting existing data is not supported). Returns the new size after truncation.

- readable(self)
  Return True if the stream is opened for reading.

- writable(self)
  Return True if the stream is opened for writing (append-only semantics).

- readinto(self, b)
  Read up to len(b) bytes into the writable buffer b. Returns the number of bytes read or 0 on EOF.

- readline(self, limit=-1)
  Read and return a single line from the stream (subject to an optional limit).

Usage notes
-----------
- Read access is always available; write access is allowed depending on the mode.
- Writing to a file node is append-only; existing data cannot be rewritten or deleted.
- Binary I/O only; the interface is designed to mirror Python's io.RawIOBase for compatibility with higher-level wrappers.

Changelog
---------
- 3.0: The module was rewritten to be fully compliant with the interfaces defined in Python's io module.

See also
---------
- filenode_usersguide: Detailed usage instructions and tutorials for filenode.
- PyTables documentation: Background on PyTables nodes and IO.

Example (conceptual)
----------------------
- Create a new file node:
  f = new_node("myfile.node", mode="w+b")

- Open an existing file node:
  f = open_node("myfile.node", mode="r+b")

- Read/write using standard io semantics (seek, readinto, etc.) through the RawIOBase-compatible interface.