Isotonic regression
===================

Isotonic regression fits a monotone (non-decreasing or non-increasing) sequence to data. It is useful when the response is believed to be monotone with respect to a single ordering (for example, along an index or a single feature). The implementation supports optional bounds on the predicted values and a choice of monotonic direction.

Helper: check_increasing
------------------------

check_increasing(x, y) determines whether y is monotonically correlated with x by estimating the Spearman correlation between x and y and checking its sign. The function returns a boolean indicating whether the relationship is increasing (True) or decreasing (False). The sign of the Spearman estimate is used, and a Fisher transform-based confidence interval is computed to warn if the interval spans zero.

Key behavior
- Uses Spearman rho to assess monotonic direction.
- If the confidence interval for Spearman rho spans zero, a warning may be issued.
- Intended as a preliminary check to decide the monotonic direction when using isotonic regression with auto-detection.

isotonic_regression function
----------------------------

Solve the isotonic regression problem for a 1D target y with optional weights and bounds.

Signature
- isotonic_regression(y, *, sample_weight=None, y_min=None, y_max=None, increasing=True)

Parameters
- y: array-like of shape (n_samples,)
  The data to fit.

- sample_weight: array-like of shape (n_samples,) or None
  Weights for each point. If None, equal weights are used.

- y_min: float or None
  Lower bound on the lowest predicted value. If None, defaults to -inf.

- y_max: float or None
  Upper bound on the highest predicted value. If None, defaults to +inf.

- increasing: bool
  If True (default), fit a non-decreasing function; if False, fit a non-increasing function.

Returns
- y_: ndarray of shape (n_samples,)
  The isotonic fit of y (monotone with respect to the specified direction).

Notes
- The monotone fit is computed in a single pass using an in-place isotonic regression routine.
- If y_min or y_max are provided, the fitted values are clipped to these bounds.

- When bounds are not provided, -inf/inf are used for clipping internally to implement the bounds behavior.

IsotonicRegression estimator
----------------------------

The IsotonicRegression estimator provides a scikit-learn compatible transformer/regressor to fit monotone models to data.

Class: IsotonicRegression
- Inherits: RegressorMixin, TransformerMixin, BaseEstimator
- versionadded: 0.13

Parameters
- y_min: float or None, default=None
  Lower bound on the lowest predicted value (minimum may still be higher). If not set, defaults to -inf.

- y_max: float or None, default=None
  Upper bound on the highest predicted value (maximum may still be lower). If not set, defaults to +inf.

- increasing: bool or 'auto', default=True
  Determines whether predictions should be constrained to increase or decrease with X. If 'auto', the sign of the Spearman correlation estimate (via check_increasing) is used to decide.

- out_of_bounds: {'nan', 'clip', 'raise'}, default='nan'
  How to handle X values outside the training domain during prediction:
  - 'nan': predictions are NaN outside the training domain.
  - 'clip': predictions are clipped to the nearest training interval endpoint.
  - 'raise': a ValueError is raised.

Attributes
- X_min_: float
  Minimum value of input array X_ for the left bound.

- X_max_: float
  Maximum value of input array X_ for the right bound.

- X_thresholds_: ndarray of shape (n_thresholds,)
  Unique ascending X values used to interpolate the y = f(X) monotonic function. (versionadded: 0.24)

- y_thresholds_: ndarray
  Threshold values corresponding to the piecewise-constant isotonic fit.

Notes
- The estimator provides a convenient API for fitting a monotone model to data with optional bounds and automatic direction detection.
- The auto direction uses the sign of the Spearman correlation to decide whether to fit a non-decreasing or non-increasing function.

References
- Best, M. J., & Chakravarti, N. (1990). Active set algorithms for isotonic regression; a unifying framework. (Isotonic regression methodology and algorithmic foundations.)

Usage examples
- Using the function:
  from sklearn.isotonic import isotonic_regression
  y_iso = isotonic_regression(y, increasing=True)

- Using the estimator:
  from sklearn.isotonic import IsotonicRegression
  ir = IsotonicRegression()
  y_iso = ir.fit_transform(X, y)  # X defines the order (1D or single feature) for monotonicity

This documentation reflects the behavior implemented in the isotonic regression module, including bounds handling, direction auto-detection, and the core isotonic fitting routine.