Working with user security roles
================================

Security roles define what operations a user may perform within ftrack. This guide explains how authentication and sessions relate to working with security roles and how to interact with role-related functionality through the Python client.

Key concepts
------------

- Authentication is performed by attaching headers to every request:
  - ftrack-api-key
  - ftrack-user
  These headers identify the acting user and authorize actions according to their security roles.

- A Session represents a connection to an ftrack server and must be created with a server URL and credentials (api_key and api_user).

- The client tracks operations and uses a layered cache to optimize interactions with the server.

Prerequisites
-------------

- Access to a running ftrack server.
- A valid API key and API user for the acting account.
- Credentials can be provided directly or via environment variables:
  - FTRACK_SERVER
  - FTRACK_API_KEY
  - FTRACK_API_USER

Creating a session
------------------

- Instantiate a session with server_url, api_key, and api_user. If credentials are not provided, the environment variables are used; missing required fields will raise a TypeError.

Example
-------

.. code-block:: python

    import ftrack_api
    session = ftrack_api.Session(
        server_url='https://my.ftrack.server',
        api_key='my_api_key',
        api_user='my_user'
    )

- The session can then be used to perform role-related operations through the server. The server enforces security roles for the acting user.

Working with roles
------------------

- Role management (listing, assigning, revoking) is performed on the ftrack server. Use the serverâ€™s REST/API endpoints for role-related actions; the Python client authenticates requests using the api_user and api_key headers.

- Ensure the acting user has the necessary permissions to manage roles before attempting changes.

Security considerations
-----------------------

- Treat API keys as sensitive credentials. Do not log or expose them.

- Prefer environment-based configuration to avoid hard-coding credentials.

Troubleshooting
---------------

- Missing server_url: raises an error indicating the required server_url was not specified.
- Missing api_key or api_user: raises an error indicating the required credential is missing.

Notes
-----

- The Session class maintains recorded operations and uses a configured cache to optimize interactions.