rand_augment.rst
===============

Overview
--------
This module implements RandAugment-style augmentations for NVIDIA DALIâ€™s auto augmentation
framework. It exposes two entry points:

- rand_augment: Apply a RandAugment suite to a batch of samples with a configurable magnitude.
- apply_rand_augment: Low-level helper that applies a specified set of augmentations to data.

Functions
---------

rand_augment(data, n, m, num_magnitude_bins=31, shape=None, fill_value=128,
             interp_type=None, max_translate_abs=None, max_translate_rel=None,
             seed=None, monotonic_mag=True, excluded=None) -> _DataNode

Summary
    Applies RandAugment (https://arxiv.org/abs/1909.13719) augmentation scheme to the provided
    batch of samples.

Parameters
    data : DataNode
        A batch of samples to be processed. Supported samples are images with layout HWC and
        videos with layout FHWC, data type uint8.
    n : int
        Number of randomly sampled operations to apply to each sample.
    m : int
        Magnitude (strength) of each operation. Must be an integer in [0, num_magnitude_bins - 1].
    num_magnitude_bins : int, optional
        Number of bins dividing the magnitude range. Default is 31.
    shape : DataNode or Tuple[int, int], optional
        Size (height, width) of the image or frames in the video sequence. If provided, the
        magnitude for translation operations depends on shape and spans from 0 to
        max_translate_rel * shape. Otherwise, magnitude range is [0, max_translate_abs].
    fill_value : int, optional
        Value used as padding for warp_affine operations (translation, shear, rotate).
        If None, images/frames are padded with the border value repeated (clamped).
    interp_type : types.DALIInterpType, optional
        Interpolation method for warp_affine operations. Supported: types.INTERP_LINEAR (default),
        types.INTERP_NN.
    max_translate_abs : int or (int, int), optional
        Only valid when shapes is not provided. Maximal shift in pixels for translation.
        If a tuple is provided, first component limits height, second width. Defaults to 100.
    max_translate_rel : float or (float, float), optional
        Only valid when shape is provided. Maximal shift as a fraction of image shape.
        If a tuple is provided, first component limits height, second width. Defaults to ~0.45
        (100/224).
    seed : int, optional
        Seed for random sampling of operations (and to negate magnitudes).
    monotonic_mag : bool, optional
        If True (default), magnitude increases with bins for most operations. If False, some color
        operations have different ranges. See get_rand_augment_non_monotonic_suite for details.
    excluded : List[str], optional
        Names of augmentations to exclude from the default RandAugment suite. You can also use
        apply_rand_augment directly to specify a custom set of augmentations.

Returns
    DataNode
        A batch of transformed samples.

Notes
    The function selects augmentations from a monotonic or non-monotonic RandAugment suite
    depending on monotonic_mag, and applies a subset of n operations with magnitude index m.

Example
    from nvidia.dali.auto_aug import rand_augment
    out = rand_augment(data, n=2, m=10)

apply_rand_augment(augmentations, data, n, m, num_magnitude_bins=31, seed=None,
                   fill_value=128, interp_type=None, shape=None, max_translate_abs=None,
                   max_translate_rel=None, **aug_kwargs) -> _DataNode

Summary
    Applies a specified list of augmentations to the input data.

Parameters
    augmentations : List[_Augmentation]
        Iterable of augmentation objects to apply.
    data : _DataNode
        Batch of samples to process.
    n : int
        Number of augmentations to apply to each sample.
    m : int
        Magnitude index used by augmentations.
    num_magnitude_bins : int, optional
        Number of magnitude bins. Default is 31.
    seed : int, optional
        Seed for randomness in augmentation selection and magnitude derivation.
    **aug_kwargs
        Additional keyword arguments forwarded to individual augmentations
        (e.g., fill_value, interp_type, shape, etc.).

Returns
    _DataNode
        A batch of transformed samples.

Notes
    This is a low-level helper used internally by rand_augment and can be used to apply
    a custom set of augmentations with full control over magnitudes and sampling.

Examples
    from nvidia.dali.auto_aug import rand_augment
    augments = [...]  # build or obtain a list of _Augmentation instances
    out = apply_rand_augment(augments, data, n=3, m=8, seed=42, fill_value=128)