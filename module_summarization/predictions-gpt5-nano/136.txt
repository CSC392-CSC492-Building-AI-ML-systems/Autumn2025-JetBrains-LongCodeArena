Image Extraction
================

Charge extraction algorithms to reduce the image to one value per pixel.

Overview
--------
This module provides a collection of image extraction algorithms that convert per-pixel waveforms (one value per pixel) into a single charge value per pixel. It includes both high-level ctapipe-style extractors and low-level NumPy/Numba implementations used to compute charges and, in some cases, timing information.

Public API
----------
- ImageExtractor
- FlashCamExtractor
- FullWaveformSum
- FixedWindowSum
- GlobalPeakWindowSum
- LocalPeakWindowSum
- SlidingWindowMaxSum
- NeighborPeakWindowSum
- BaselineSubtractedNeighborPeakWindowSum
- TwoPassWindowSum
- extract_around_peak
- extract_sliding_window
- neighbor_average_maximum
- subtract_baseline
- integration_correction

Key components
--------------
- extract_around_peak: A NumPy guvectorize kernel that, for each pixel, sums samples within a window defined by a peak index, window width, and a shift. It also computes a pulse time within the window and returns the per-pixel charge and peak time (in nanoseconds). The pulse time is calculated as a weighted average of samples within the window and converted to nanoseconds using the provided sampling rate (in GHz).
- extract_sliding_window: A NumPy guvectorize kernel that, for each pixel, finds the consecutive width that yields the largest sum within the waveform and returns the corresponding charge and timing. The timing is computed as a weighted average of samples within the selected window and returned in nanoseconds.
- neighbor_average_maximum, subtract_baseline, integration_correction: helper routines used by various extractors to perform tasks such as baseline subtraction and applying integration corrections or neighborhood-based statistics. Implementations are provided in the module (or relatedâ€“refer to source for details).

Usage notes
-----------
- Input data shape: waveforms are expected as an array of shape (n_pix, n_samples).
- The extractors produce per-pixel charges, with optional timing information depending on the specific algorithm.
- Units: sampling_rate_ghz should be provided in GHz; timing results are converted to nanoseconds by dividing by the sampling rate.
- The public API is designed to integrate with ctapipe components and DL1 data structures.

Example (conceptual)
----------------------
- Given a per-pixel waveform array, apply a chosen extractor (e.g., FullWaveformSum or GlobalPeakWindowSum) to obtain per-pixel charges. For timing-enabled extractors, per-pixel peak times can also be produced.

Notes
-----
- The module includes both high-level extractors suitable for use in the DL1 image extraction chain and low-level ufuncs that provide efficient per-pixel computations.
- The exact behavior and parameterization of each extractor (window definitions, peak handling, baseline treatment) vary by algorithm; refer to the specific class documentation in the source for details.