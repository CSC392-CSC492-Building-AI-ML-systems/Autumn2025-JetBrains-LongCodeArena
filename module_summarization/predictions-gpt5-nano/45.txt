Logging
=======

Overview
--------
This module provides a configurable logging subsystem for the application. It wires up the root logger with optional console, file (rotating), and syslog handlers according to the application configuration.

Constants
---------
- LOG_NOTICE (int): 25
  Info log level that is visible in non-verbose mode. It should not be used for warnings or errors.

- _NAME_TO_LEVEL (dict)
  Mapping of common string level names (and aliases) to the corresponding Python logging levels, including support for the custom LOG_NOTICE level.

Classes
-------
- Logging(app)
  A helper that initializes and configures the application's logging. It creates and attaches:
  - RootLogger: the global logger obtained from the standard logging module.
  - ConsoleHandler: optional handler for console output.
  - FileHandler: optional rotating file handler configured from the application config.
  - SyslogHandler: optional syslog handler configured from the application config.

  Initialization behavior:
  - If the root logger has no handlers, it may configure console logging depending on:
    - Whether stdout is a TTY, or
    - The ASABFORCECONSOLE environment variable is set.
  - File logging configuration:
    - Path is read from Config["logging:file"]["path"].
    - Directory is created if it does not exist.
    - A RotatingFileHandler is created with backup_count and backup_max_bytes taken from the config.
    - The file logger uses StructuredDataFormatter with fmt, datefmt, and sd_id from the config.
    - If a rotate_every value is provided, it is parsed and scheduled to rotate periodically.
  - Syslog logging configuration:
    - Enabled by Config["logging:syslog"]["enabled"].
    - Address may be a UNIX path or a network address (tcp/udp) or a UNIX socket (unix-connect/unix-sendto).
    - Each valid address results in an AsyncIOHandler configured with the proper socket family and type.
    - The chosen formatter depends on Config["logging:syslog"]["format"]:
      - 'm': MacOSXSyslogFormatter
      - '5': SyslogRFC5424Formatter
      - '5micro': SyslogRFC5424microFormatter
      - default: SyslogRFC3164Formatter
    - The SyslogHandler is added to the RootLogger.

  Notes:
  - External dependencies include Config, Timer, AsyncIOHandler, Various Syslog formatters, and StructuredDataFormatter.
  - The code references an internal callback _on_tick_rotate_check used for file rotation timing.

Configuration keys and semantics
-------------------------------
- logging:file
  - path: string path to the log file. If empty, file logging is skipped.
  - backup_count: integer for the number of backup files to keep.
  - backup_max_bytes: integer for the maximum size in bytes of a log file before rotation.
  - format: string format used by StructuredDataFormatter.
  - datefmt: date format string for the file log entries.
- logging:sd_id
  - string used as a structured data identifier included in log records.
- logging:syslog
  - enabled: boolean to enable/disable syslog logging.
  - address: address for syslog (UNIX path or network address).
  - format: string selector for the syslog formatter ('m', '5', '5micro', or default).
  - sd_id: structured data identifier for syslog messages.

Rotation and scheduling
-----------------------
- rotate_every: optional string in the form "N[unit]" where N is a positive integer and unit is one of:
  - H (hours)
  - M (minutes)
  - d (days)
  - s (seconds)
- Valid values result in a scheduled timer that triggers rotation. Invalid values log an error.

Usage
-----
Instantiate the Logging class during application startup, passing the application object as the argument:
- logging = Logging(app)

Remarks
-------
- The module is designed to adapt its logging behavior based on runtime environment (TTY presence, environment variables) and configuration changes.
- The implementation relies on several project-specific components (config handling, timer utilities, and custom log formatters/handlers) that are expected to be present in the application.