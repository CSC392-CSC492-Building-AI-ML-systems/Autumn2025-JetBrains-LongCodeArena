FITS Headers
============

Overview
--------

A FITS file is composed of an ASCII header followed by a binary data block. The header is made up of 80-character "cards" that describe the data in the following block. The header ends with a card containing the keyword END. The header block itself is padded with blank cards to fill complete 2880-byte blocks.

Structure and format
--------------------

- Each header card is 80 characters long and follows the general form:
  KEYWORD = value / comment
  or a continuation or non-value card such as COMMENT or HISTORY.
- Keywords are typically uppercase and limited to 8 characters (the FITS standard). Longer or more complex keywords can be used with the HIERARCH convention.
- Values may be numbers, logicals (T/F), strings in quotes, or arrays. Strings must be enclosed in single quotes.
- Special non-value cards include COMMENT and HISTORY, which carry free-form text.
- The header must contain a primary set of keywords (in the primary header) and may contain extensions (additional headers) for extra data blocks.

Key concepts and common keywords
--------------------------------

- SIMPLE: file conforms to the FITS standard (T).
- BITPIX: number of bits per data pixel.
- NAXIS: number of data axes.
- NAXISn: length of each axis (NAXIS1, NAXIS2, ...).
- EXTEND: extensions may be present (T).
- END: marks the end of the header.
- COMMENT and HISTORY: free-text lines for documentation and provenance.

Examples
--------

A minimal header might look like:

SIMPLE  =                    T / file conforms to FITS standard
BITPIX  =                   16 / number of bits per data pixel
NAXIS   =                    2 / number of data axes
NAXIS1  =                    3
NAXIS2  =                    3
EXTEND  =                    T / file may contain extensions
END

Notes:
- After END, the data block begins and the header is padded to complete 2880-byte blocks.
- Keywords must be uppercase by default, but HIERARCH allows longer or nonstandard keywords.

Extended keywords (HIERARCH)
----------------------------

To accommodate longer or nonstandard keywords, use the HIERARCH convention:
- HIERARCH key = value
- The actual keyword name is everything after the keyword field up to the equal sign, as allowed by HIERARCH.
- This is useful for metadata that cannot be represented with the standard 8-character keywords.

Working with headers in Astropy
-------------------------------

- Headers are stored as an ordered collection of cards; you can access, add, or modify entries by keyword.
- Case-insensitive lookups are supported, with normalization to the standard keyword form.
- The header continues to enforce FITS rules while allowing common extensions via HIERARCH.

Verification and quality checks
-----------------------------

Astropy provides a verification framework to check and optionally fix FITS headers:
- verify(option) supports options like ignore, warn, exception, fix, silentfix, and combinations like fix+warn.
- The verification can split fixable and reportable aspects, and it may emit warnings or raise errors accordingly.
- A note in the verification messages highlights that astropy.io.fits uses zero-based indexing.

Example usage:
- header.verify(option="warn") to emit warnings for problems.
- header.verify(option="fix+warn") to attempt fixes and warn about issues.
- VERIFY_OPTIONS include: "ignore", "warn", "exception", "fix", "silentfix", and combinations with "+ignore", "+warn", "+exception".

Internal structure (for reference)
----------------------------------

- Headers are represented by a sequence of 80-character cards; the END card terminates the header.
- When reporting verification results, messages are structured to reflect the hierarchical nature of the header content and related extensions.
- Zero-based indexing is used in reported positions for user-facing messages.

Relation to the FITS standard
----------------------------

- The header format adheres to the FITS standard for ASCII header cards, block padding, and keyword/value/comment syntax.
- HIERARCH provides a mechanism to use longer keywords while remaining compatible with standard FITS readers that honor HIERARCH-enabled keywords.

Further reading
--------------

- FITS standard documentation for headers and cards
- Astropy documentation on FITS headers and the header object
- Astropy verification and error-handling behavior for FITS headers