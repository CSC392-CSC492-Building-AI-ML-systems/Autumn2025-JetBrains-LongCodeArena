Auto Augment
============

This module provides functions to apply NVIDIAâ€™s AutoAugment policies to batches of images or videos using NVIDIA DALI.

Public API
----------

.. currentmodule:: nvidia.dali.auto_aug.auto_augment

.. autofunction:: auto_augment
.. autofunction:: auto_augment_image_net

Policy support
--------------

The following predefined policies are available:

- image_net
- reduced_image_net
- svhn
- reduced_cifar10

Usage notes
-----------

- data should be a DataNode containing images in HWC layout or videos in FHWC layout, with dtype uint8.

- policy_name selects the augmentation policy. Valid values are the ones listed in Policy support.

- shape, if provided, ties the magnitude of translation augmentations to the image shape.

- fill_value specifies padding for transform operations (translation, shear, rotate). If None, border padding is repeated (clamped).

- interp_type selects the interpolation method used by warp_affine operations (translation, shear, rotate).

- max_translate_abs (or max_translate_rel) controls the maximal translation magnitude. Only one of these should be set depending on whether shape is provided.

- seed controls randomness for sampling operations and magnitudes.

Examples
--------

Basic usage with the default policy:

.. code-block:: python

    from nvidia.dali.auto_aug import auto_augment

    # data is a DataNode of images or video frames
    out = auto_augment(data)

Specify a particular policy and translation:

.. code-block:: python

    out = auto_augment(
        data,
        policy_name="image_net",
        shape=(224, 224),
        max_translate_abs=100,
        seed=42
    )

Use the image_net policy via the convenience wrapper:

.. code-block:: python

    from nvidia.dali.auto_aug import auto_augment_image_net

    out = auto_augment_image_net(data, shape=(224, 224), seed=42)