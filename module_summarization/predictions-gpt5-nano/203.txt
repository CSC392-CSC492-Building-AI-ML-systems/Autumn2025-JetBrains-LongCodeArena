Transforming the prediction target
==================================

Overview
--------
Transforming the target variable (y) can help regression models by stabilizing variance, handling skewness, or making the target more closely match the assumptions of the regressor. Scikit-learn provides TransformedTargetRegressor to apply a transformation to y before fitting the underlying regressor and to apply the inverse transformation to predictions.

API
---
TransformedTargetRegressor wraps an estimator and applies a transformation to the target variable.

- regressor: The underlying estimator to fit on the transformed target.
- func: The transformation to apply to y (e.g., np.log1p).
- inverse_func: The inverse transformation to apply to predictions (e.g., np.expm1).
- check_inverse: If True, verify that the transformation is invertible on the training data.
- additional keyword arguments are passed to the underlying regressor as usual.

Notes:
- For multioutput regression, the transformation is applied element-wise to each target.
- This wrapper is especially useful when the target distribution is skewed or heteroscedastic.

Examples
--------
Example 1: Log-transform the target with a linear regressor
.. code-block:: python

    from sklearn.compose import TransformedTargetRegressor
    from sklearn.linear_model import LinearRegression
    import numpy as np

    # Transform y with log1p and invert with expm1
    regr = TransformedTargetRegressor(
        regressor=LinearRegression(),
        func=np.log1p,
        inverse_func=np.expm1
    )

    regr.fit(X, y)
    y_pred = regr.predict(X)

Example 2: Using in a pipeline
.. code-block:: python

    from sklearn.pipeline import make_pipeline
    from sklearn.preprocessing import StandardScaler
    from sklearn.linear_model import Ridge
    from sklearn.compose import TransformedTargetRegressor
    import numpy as np

    model = make_pipeline(
        StandardScaler(),
        TransformedTargetRegressor(
            regressor=Ridge(),
            func=np.log1p,
            inverse_func=np.expm1
        )
    )
    model.fit(X, y)
    y_pred = model.predict(X)

Usage notes
-----------
- The transformation must be invertible on the target space. If check_inverse is True, the regressor validates invertibility on the training data.
- The inverse transformation is applied to predictions to return results on the original scale.
- For non-invertible transformations or complex transformations, provide a suitable inverse_func that is defined for all possible target values.
- The transformation is applied independently to each target variable in multioutput regression.

See also
--------
- FunctionTransformer for transforming data X (not the target) in pipelines.
- Box-Cox and Yeo-Johnson transformations can be implemented via a custom func and inverse_func if appropriate for y.