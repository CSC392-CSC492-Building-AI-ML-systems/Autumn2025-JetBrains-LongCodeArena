Kernel approximation
====================

Module overview
---------------

The :mod:`sklearn.kernel_approximation` module implements several approximate kernel feature maps based on Fourier transforms and Count Sketches.

PolynomialCountSketch
---------------------

Class: PolynomialCountSketch

Overview
^^^^^^^^

Implements Tensor Sketch, which approximates the feature map of the polynomial kernel

    K(X, Y) = (gamma * <X, Y> + coef0)^degree

by efficiently computing a Count Sketch of the outer product of a vector with itself using Fast Fourier Transforms (FFT). See the User Guide for details on polynomial kernel approximation.

Version added
^^^^^^^^^^^^^^^

0.24

Parameters
^^^^^^^^^^
- gamma : float, default=1.0
  Parameter of the polynomial kernel whose feature map will be approximated.

- degree : int, default=2
  Degree of the polynomial kernel whose feature map will be approximated.

- coef0 : int, default=0
  Constant term of the polynomial kernel whose feature map will be approximated.

- n_components : int, default=100
  Dimensionality of the output feature space. Typically, n_components should be larger than the number of input features to achieve good performance. A common balance is around n_components = 10 * n_features, though this depends on the dataset.

- random_state : int, RandomState instance, default=None
  Determines random number generation for indexHash and bitHash initialization. Pass an int for reproducible results across multiple function calls.

Attributes
^^^^^^^^^^
- indexHash_ : ndarray of shape (degree, n_features), dtype=int64
  Array of indices in range [0, n_components) used to represent the 2-wise independent hash functions for Count Sketch computation.

- bitHash_ : ndarray of shape (degree, n_features), dtype=float32
  Array with random entries in {+1, -1}, used to represent the 2-wise independent hash functions for Count Sketch computation.

- n_features_in_ : int
  Number of features seen during fit.

- feature_names_in_ : ndarray of shape (n_features_in_,)
  Names of features seen during fit. Defined only when X has feature names that are all strings.

See Also
^^^^^^^^
AdditiveChi2Sampler : Approximate feature map for additive chi2 kernel.  
Nystroem : Approximate a kernel map using a subset of the training data.  
RBFSampler : Approximate a RBF kernel feature map using random Fourier features.  
SkewedChi2Sampler : Approximate feature map for "skewed chi-squared" kernel.  
sklearn.metrics.pairwise.kernel_metrics : List of built-in kernels.

Examples
^^^^^^^^

.. code-block:: python

   >>> from sklearn.kernel_approximation import PolynomialCountSketch
   >>> from sklearn.linear_model import SGDClassifier
   >>> X = [[0, 0], [1, 1], [1, 0], [0, 1]]
   >>> y = [0, 0, 1, 1]
   >>> ps = PolynomialCountSketch(degree=3, random_state=1)
   >>> X_features = ps.fit_transform(X)
   >>> clf = SGDClassifier(max_iter=10, tol=1e-3)
   >>> clf.fit(X_features, y)
   SGDClassifier(max_iter=10)
   >>> clf.score(X_features, y)
   1.0

Notes
^^^^^
- The implementation relies on SciPy's FFT (fft/ifft) when available, with a fallback for older SciPy versions.
- The estimator follows the standard fit/transform API and supports feature names when provided.