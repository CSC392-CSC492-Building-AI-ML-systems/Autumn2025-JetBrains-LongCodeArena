Discreet (Discrete) Models — Zero-Inflated Count Models
======================================================

Overview
--------

This module implements zero-inflated count models for overdispersed and zero-heavy counts. It combines a main count model with a separate inflation model that governs the probability of an excess zero. The three concrete models exposed are:

- ZeroInflatedPoisson
- ZeroInflatedGeneralizedPoisson
- ZeroInflatedNegativeBinomialP

All of these models share a common base class that encapsulates the zero-inflation logic.

GenericZeroInflated
-------------------

Class: GenericZeroInflated (inherits from CountModel)

Purpose
- A base class for zero-inflated count models. It provides the likelihood machinery that combines a main count model with a binary inflation model.

Key concepts
- endog: endogenous response variable (counts)
- exog: design matrix for the main count model
- exog_infl: design matrix for the zero-inflation (inflation) model
- offset: optional offset added to the linear predictor of the main model
- exposure: optional exposure term (log(exposure) added to the linear predictor)
- inflation: 'logit' or 'probit' link used for the inflation model
- model_infl: the fitted inflation model (Logit or Probit)
- k_inflate: number of parameters in the inflation model
- k_extra: number of inflation parameters (alias used internally)
- exog_names: list of parameter names for the main model, extended with inflation parameters
- _init_keys, _null_drop_keys: internal bookkeeping for parameter initialization and handling of missing data

Core methods
- loglike(params): total log-likelihood of the zero-inflated model given a parameter vector
- loglikeobs(params): per-observation log-likelihoods, used to assemble the total log-likelihood
- fit(...): fit the model parameters using the underlying optimizer, with support for start_params, callbacks, and various covariance types

Likelihood structure
- Let w_i be the predicted inflation probability for observation i (from the inflation model).
- Let L_main be the log-likelihood contribution of the main (count) model for observation i.
- For y_i = 0:
  - ll_i = log(w_i + (1 - w_i) * exp(L_main_i))
- For y_i > 0:
  - ll_i = log(1 - w_i) + L_main_i

These expressions implement the mixture: zeros can come from either the inflation mechanism or the main model predicting zero, while positive counts come only from the main model with a factor of (1 - w_i).

Usage
-----

Instantiate one of the concrete zero-inflated models and fit:

- Example
  - from statsmodels.discrete.discrete_model import ZeroInflatedPoisson
  - zinp = ZeroInflatedPoisson(endog, exog, exog_infl, inflation='logit')
  - res = zinp.fit()

- The same pattern applies to ZeroInflatedGeneralizedPoisson and ZeroInflatedNegativeBinomialP, which differ in the underlying main count model.

Notes
- The inflation model is a standard binary model (logistic or probit) predicting the probability of an excess zero.
- The parameters are partitioned into inflation parameters (k_inflate) and main model parameters.
- start_params can be supplied, or the model will compute a reasonable starting point.

See also
- ZeroInflatedPoisson
- ZeroInflatedGeneralizedPoisson
- ZeroInflatedNegativeBinomialP
- Poisson, GeneralizedPoisson, NegativeBinomialP (for the main count models)
- _discrete_results_docs, _validate_l1_method (result handling and L1-penalty support)

Formulas
- L_i (i-th observation) is composed as:
  - If y_i = 0: ll_i = log(w_i + (1 - w_i) * P_main(y_i = 0))
  - If y_i > 0: ll_i = log(1 - w_i) + log P_main(y_i)

Examples
- Fitting a zero-inflated Poisson model with a logit inflation model:
  - zinp = ZeroInflatedPoisson(endog, exog, exog_infl, inflation='logit')
  - res = zinp.fit()

Further details
- The module uses standard maximum likelihood estimation with options for convergence control and covariance estimation consistent with Statsmodels’ modeling framework.
- The internal structure mirrors other discrete models, but with the additional inflation component integrated into the log-likelihood.