A quick dive into using the API
===============================

Overview
--------
The ftrack API is centered around a Session, which represents a connection to an ftrack server. A Session handles authentication, lazy loading (auto population) of entity data, optional caching, plugin discovery, and (optionally) a background event hub for real-time updates.

Key concepts
- Authentication: use server URL, API key, and API user. If not provided, values can come from environment variables FTRACK_SERVER, FTRACK_API_KEY, and FTRACK_API_USER.
- Auto population: by default, accessing entity attributes will fetch missing data from the server.
- Caching: a layered cache can be configured; the top level is a MemoryCache, with a customizable key maker for object caching.
- Event hub: an embedded event hub can be auto-connected to publish/subscribe to events beyond the local process.
- Plugins: plugins can be discovered and registered at session creation.

Prerequisites
-------------
- A running ftrack server.
- Credentials (server URL, API key, and API user) or corresponding environment variables.

Quickstart
----------
Create a session
You can create a session by passing the server URL, API key, and API user, or by relying on environment variables.

.. code-block:: python

   import ftrack_api

   # Minimal session: values can be provided or read from environment variables
   session = ftrack_api.Session(
       server_url='https://my.ftrack.server',
       api_key='YOUR_API_KEY',
       api_user='your_username'
   )

Optional: let environment variables supply credentials
.. code-block:: python

   # Environment variables will be used if the corresponding arguments are omitted
   # FTRACK_SERVER, FTRACK_API_KEY, FTRACK_API_USER
   session = ftrack_api.Session()

Enable automatic event hub connection (optional)
If you want the embedded event hub to be connected automatically in the background, enable it at session creation.

.. code-block:: python

   session = ftrack_api.Session(
       server_url='https://my.ftrack.server',
       api_key='YOUR_API_KEY',
       api_user='your_username',
       auto_connect_event_hub=True
   )

Accessing data (auto population)
With auto_populate enabled (default), accessing entity attributes will fetch data from the server if needed.

.. code-block:: python

   # Example (conceptual; specific entity API may vary)
   # shot = session.get('Shot', 'shot01')  # retrieving an entity by type and id
   # print(shot.name)  # if not populated, this will trigger a server fetch

Caching and keying
The session participates in a layered cache. By default, a memory cache is used at the top level, and a StringKeyMaker is used to generate cache keys. You can supply a custom cache and key maker if desired.

.. code-block:: python

   from ftrack_api.cache import MemoryCache, StringKeyMaker

   session = ftrack_api.Session(
       server_url='https://my.ftrack.server',
       api_key='YOUR_API_KEY',
       api_user='your_username',
       cache=MemoryCache(),            # optional custom cache
       cache_key_maker=StringKeyMaker()  # optional custom key maker
   )

Plugins (optional)
Plugins can be discovered and registered during session creation. If a plugin signature does not match the arguments provided, the discovery mechanism will attempt to adapt.

Environment setup guidance
--------------------------
- If you prefer not to pass credentials directly, set:
  - FTRACK_SERVER for server_url
  - FTRACK_API_KEY for api_key
  - FTRACK_API_USER for api_user

From here
---------
With a session created, you can explore entities, query metadata, and perform operations using the API modules (e.g., ftrack_api.query, ftrack_api.attribute, ftrack_api.operation, etc.). The Session object coordinates interaction with these components, applying lazy loading, caching, and event handling as configured.