w_stateprobs
============

Overview
--------

The w_stateprobs command provides state-to-state kinetics estimates by tracing trajectories in weighted ensemble data. It computes average state populations and associated confidence intervals. Bin assignments (including macrostate definitions) are required.

Deprecation
-----------

This command is deprecated. Please use w_direct instead.

Usage
-----

w_stateprobs trace [options]

Subcommands
-----------

trace
  averages and CIs for path-tracing kinetics analysis
  This is the primary subcommand provided by this wrapper. It uses:
  - Default output file: stateprobs.h5
  - Default kinetics file: assign.h5

Output
------

The output file (default stateprobs.h5) contains:

- /avg_state_pops [state]
  Population of each state across the full range.

If evolution mode is specified, an additional dataset is produced:

- /state_pop_evolution [window][state]
  State populations in windows of iterations.

Evolution mode details
----------------------

If --evolution-mode is provided, the following dataset is available:

- iter_start
  (Integer) Iteration at which the averaging window begins (inclusive).

- iter_stop
  (Integer) Iteration at which the averaging window ends (exclusive).

- expected
  (Floating-point) Expected (mean) value of the rate within the window, in units of inverse tau.

- ci_lbound
  (Floating-point) Lower bound of the confidence interval on the rate within the window, in units of inverse tau.

- ci_ubound
  (Floating-point) Upper bound of the confidence interval on the rate within the window, in units of inverse tau.

- corr_len
  (Integer) Correlation length of the rate within the window, in units of tau.

Attributes
----------

Each of the above datasets is stamped with these attributes:

- mcbs_alpha
  (Floating-point) Alpha value for confidence intervals (e.g., alpha=0.05 for 95% CI).

- mcbs_nsets
  (Integer) Number of bootstrap datasets used to generate confidence intervals.

- mcbs_acalpha
  (Floating-point) Alpha value for determining correlation lengths.

Notes
-----

- The datasets reflect the analysis performed by tracing trajectories and are documented for macrostate assignments used in w_assign.
- See w_assign --help for details on binning and macrostate definitions.

Command-line options
--------------------

Common options inherited from the underlying tool (e.g., -o/--output) apply:

- -o, --output <file>
  Output HDF5 file name (default: stateprobs.h5).

- --evolution-mode <cumulative|blocked>
  Enable computation of evolution datasets as described above.

- --start-iter <n>
  Start iteration for evolution windows.

- --step-iter <n>
  Step size for evolution windows.

See also
--------

- w_assign --help
- w_direct