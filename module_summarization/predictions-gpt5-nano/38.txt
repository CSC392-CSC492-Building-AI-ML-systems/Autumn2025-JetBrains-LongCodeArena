Fields
======

Usage
-----

The Field class is the base type for all model fields. Each concrete field type combines Field with a mixin that defines the Python type it represents. The framework automatically sets field_type when multiple bases are used.

Key concepts
- source_field: Optional database column name if it should differ from the field name.
- generated: Indicates the field is DB-generated.
- pk: Marks the field as a Primary Key (only one per model is allowed). Implicitly enables indexing and uniqueness.
- null: Allows NULL values in the database.
- default: A default value or a callable returning a default. The default is not stored in the schema.
- unique: Ensures the field value is unique in the table.
- index: Creates an index on this field.
- description: A human-readable description stored in the schema and used by describe/model tooling.
- model: Optional Model type reference.

Important attributes
- field_type: The Python type of the field (set automatically by the metaclass when using mixins).
- indexable, has_db_field, skip_to_python_if_native, allows_generated: Flags affecting behavior and optimizations.
- function_cast: Optional casting function used for database emulation.
- SQL_TYPE, GENERATED_SQL: Database-specific overrides for SQL type and generation.
- Per-DB overrides: You can provide inner classes named _db__<dialect> to override attributes or methods for a specific database dialect.

Conversions
- to_db_value(value, instance): Converts a Python value to a value suitable for storing in the database.
- to_python_value(value): Converts a value from the database to the Python type.
- The conversions are designed to be minimal when the value is already of the correct type.

Usage notes
- Validation: If a field is not indexable, it cannot be indexed or unique.
- Primary keys: Setting pk=True automatically enables indexing and uniqueness.
- DB dialect overrides: Use inner classes named _db__<dialect> to tailor SQL_TYPE, skip_to_python_if_native, or function_cast for specific databases.

Examples
--------

Minimal model with basic fields
```python
from tortoise import fields
from tortoise.models import Model

class User(Model):
    id = fields.IntField(pk=True)
    username = fields.CharField(max_length=30, unique=True)
    email = fields.CharField(max_length=255, null=True)
```

Defaults, nullability, and text fields
```python
from tortoise import fields
from tortoise.models import Model

class Article(Model):
    id = fields.IntField(pk=True)
    title = fields.CharField(max_length=200, default="Untitled")
    content = fields.TextField(null=True)
```

Per-dialect overrides (example)
```python
from typing import Type
from pypika.terms import Term
from pypika import functions, SqlTypes
from tortoise import fields
from tortoise.models import Model

class CustomCharField(fields.CharField):
    class _db_sqlite:
        SQL_TYPE = "VARCHAR(40)"
        skip_to_python_if_native = False

        def function_cast(self, term: Term) -> Term:
            return functions.Cast(term, SqlTypes.NUMERIC)
```