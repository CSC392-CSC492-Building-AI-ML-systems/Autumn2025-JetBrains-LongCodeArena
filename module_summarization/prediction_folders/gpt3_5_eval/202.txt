# Permutation Feature Importance

The permutation feature importance is a technique used to evaluate the importance of features in a machine learning model. It works by permuting the values of a single feature and measuring the impact on the model's performance metric. This allows us to understand which features are most influential in making predictions.

## Functions

### `_check_feature_names(X, feature_names=None)`

Check feature names.

- **Parameters:**
  - `X` : array-like of shape (n_samples, n_features)
    Input data.
  - `feature_names` : None or array-like of shape (n_names,), dtype=str
    Feature names to check or `None`.

- **Returns:**
  - `feature_names` : list of str
    Feature names validated. If `feature_names` is `None`, then a list of feature names is provided.

### `_get_feature_index(fx, feature_names=None)`

Get feature index.

- **Parameters:**
  - `fx` : int or str
    Feature index or name.
  - `feature_names` : list of str, default=None
    All feature names from which to search the indices.

- **Returns:**
  - `idx` : int
    Feature index.

### `_calculate_permutation_scores(...)`

Calculate score when `col_idx` is permuted.

### `_create_importances_bunch(baseline_score, permuted_score)`

Compute the importances as the decrease in score.

- **Parameters:**
  - `baseline_score` : ndarray of shape (n_features,)
    The baseline score without permutation.
  - `permuted_score` : ndarray of shape (n_features, n_repeats)
    The permuted scores for the `n` repetitions.

- **Returns:**
  - `importances` : Bunch
    Dictionary-like object with attributes:
      - `importances_mean` : ndarray, shape (n_features,)
        Mean of feature importance over `n_repeats`.
      - `importances_std` : ndarray, shape (n_features,)
        Standard deviation over `n_repeats`.
      - `importances` : ndarray, shape (n_features, n_repeats)
        Raw permutation importance scores.

### `permutation_importance(...)`

Compute permutation feature importance for an estimator.

- **Parameters:**
  - `estimator` : object
    The estimator for which permutation importance is calculated.
  - `X` : array-like
    The input data.
  - `y` : array-like or None
    The target values.
  - `scoring` : str, callable, list, tuple, dict, or None
    The scoring method to evaluate the importance.
  - `n_repeats` : int
    The number of times to permute each feature.
  - `n_jobs` : int or None
    The number of parallel jobs to run.
  - `random_state` : int, RandomState instance, or None
    The random state for reproducibility.
  - `sample_weight` : array-like or None
    Sample weights for the data.
  - `max_samples` : int or float
    The maximum number of samples to use.

This function calculates the permutation feature importance for the given estimator and input data.