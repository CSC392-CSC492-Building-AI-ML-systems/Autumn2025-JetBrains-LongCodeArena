# Feature Extraction Module

The `feature_extraction` module provides utilities for extracting features from PyTorch models using the TorchVision library. It includes classes and functions to trace the execution of a model and record the nodes involved in the computation.

## Classes

### `LeafModuleAwareTracer`
An `fx.Tracer` subclass that allows the user to specify a set of leaf modules that should not be traced through. The resulting graph contains single nodes referencing calls to the leaf modules' forward methods.

### `NodePathTracer`
An `fx.Tracer` subclass that records the name of the node from which each operation originated. The node name is a `.` separated path walking the hierarchy from the top-level module down to the leaf operation or leaf module. Duplicate node names are handled by adding a suffix of the form `_int`.

## Functions

### `_is_subseq(x, y)`
Check if sequence `y` is a subsequence of sequence `x`.

### `_warn_graph_differences(train_tracer: NodePathTracer, eval_tracer: NodePathTracer)`
Utility function to warn the user if there are differences between the nodes in the train and eval graphs. This function compares the nodes obtained by tracing the model in train and eval modes and provides a suggestion for handling differences.

## Example Usage

```python
import torch
import torchvision
from feature_extraction import NodePathTracer

# Create a NodePathTracer instance
tracer = NodePathTracer()

# Trace the execution of a PyTorch model
model = torchvision.models.resnet18()
input_data = torch.randn(1, 3, 224, 224)
traced_model = torch.fx.symbolic_trace(model, args=(input_data,), tracer=tracer)

# Extract the node names from the traced model
node_names = list(tracer.node_to_qualname.values())

print("Node names:")
for node_name in node_names:
    print(node_name)
```

In this example, we create a `NodePathTracer` instance, trace the execution of a ResNet-18 model using TorchVision, and extract the node names recorded during tracing. The extracted node names provide insights into the operations performed by the model during inference.