```rst
w_assign
========

The ``w_assign`` command is used to assign walkers to bins, generating a file (by default named "assign.h5") that can be utilized in subsequent analysis. This ensures that trajectory analyses have information about the originating bin of each trajectory for consistency.

Source Data
-----------

Source data can be provided either by a user-specified function (--construct-dataset) or a list of "data set specifications" (--dsspecs). If neither is provided, the progress coordinate dataset 'pcoord' is used.

To use a custom function to extract or calculate data, specify the function in standard Python MODULE.FUNCTION syntax as the argument to --construct-dataset. The function should return data that can be indexed as [segment][timepoint][dimension].

To use a list of data set specifications, specify --dsspecs followed by the desired datasets formatted as NAME[,file=FILENAME,slice=SLICE].

Specifying Macrostates
----------------------

Kinetic macrostates can be defined in terms of sets of bins. Trajectories are labeled with the kinetic macrostate they were most recently in at each timepoint for subsequent kinetic analysis.

Three ways to specify macrostates are:

1. Using the --states option to identify states corresponding to single bins.
2. Using a YAML input file specified with --states-from-file to define states with coordinate tuples.
3. Supplying arbitrary state definitions via a user-defined function specified as --states-from-function=MODULE.FUNCTION.

Output Format
-------------

The output file (default "assign.h5") contains the following attributes datasets:

- ``nbins`` attribute: Number of valid bins.
- ``nstates`` attribute: Number of valid macrostates.
- ``/assignments``: Per-segment and -timepoint assignments (bin indices).
- ``/npts``: Number of timepoints in each iteration.
- ``/nsegs``: Number of segments in each iteration.
- ``/labeled_populations``: Per-iteration and -timepoint bin populations, labeled by most recently visited macrostate.
- ``/bin_labels``: [bin] (to be completed)

```