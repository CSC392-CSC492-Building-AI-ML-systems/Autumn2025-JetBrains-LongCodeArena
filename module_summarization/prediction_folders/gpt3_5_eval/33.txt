```rst
w_select
========

The ``w_select`` command is used to select dynamics segments matching various criteria. This command requires a user-provided predicate function. By default, only matching segments are stored. If the ``-a/--include-ancestors`` option is given, then matching segments and their ancestors will be stored.

Predicate Function
------------------

Segments are selected based on a predicate function, which must be callable as ``predicate(n_iter, iter_group)`` and return a collection of segment IDs matching the predicate in that iteration. The predicate may be inverted by specifying the ``-v/--invert`` command-line argument.

Output Format
-------------

The output file (default: "select.h5") contains the following datasets:

- ``/n_iter`` [iteration]: Iteration numbers for each entry in other datasets.
- ``/n_segs`` [iteration]: Number of segment IDs matching the predicate (or inverted predicate, if ``-v/--invert`` is specified) in the given iteration.
- ``/seg_ids`` [iteration][segment]: Matching segments in each iteration. For an iteration ``n_iter``, only the first ``n_iter`` entries are valid. For example, the full list of matching seg_ids in the first stored iteration is ``seg_ids[0][:n_segs[0]]``.
- ``/weights`` [iteration][segment]: Weights for each matching segment in ``/seg_ids``.

Command-line Arguments
----------------------

The following command-line arguments are available for the ``w_select`` command:

- ``-p, --predicate-function MODULE.FUNCTION``: Use the given predicate function to match segments.
- ``-v, --invert``: Invert the match predicate.
- ``-a, --include-ancestors``: Include ancestors of matched segments in output.

Output Options
--------------

- ``-o, --output OUTPUT``: Write output to OUTPUT (default: "select.h5").
```