Header Interface Transition Guide
=================================

Overview
--------

This guide provides an overview of the transition to the new Header interface, highlighting key changes and improvements in verification, error handling, and notification mechanisms. The updated interface introduces a more robust and flexible approach to managing FITS header data, with enhanced support for error verification and listener notifications.

Verification Framework
----------------------

The verification framework is designed to ensure the integrity and correctness of header data. It introduces a set of verification options that control how errors and warnings are handled during the verification process.

### Verification Options

The following options are supported for verification behavior:

- **ignore**: Do not report any verification issues.
- **warn**: Issue warnings for verification problems.
- **exception**: Raise exceptions on verification errors.
- **fix**: Attempt to fix fixable errors and raise exceptions for unfixable ones.
- **silentfix**: Attempt to fix fixable errors silently without reporting.
- Combinations such as **fix+warn**, **fix+ignore**, **silentfix+warn**, etc., allow fine-grained control over fixing and reporting.

### Verification Process

The verification is performed via the `verify` method, which accepts an option string specifying the desired behavior. The method processes errors returned by the internal `_verify` method, which subclasses should implement to perform specific checks.

Errors are collected in a nested `_ErrList` structure, which supports hierarchical error messages with indentation for clarity. The verification framework distinguishes between fixable and unfixable errors, applying fixes when requested and reporting issues according to the selected option.

Error and Warning Classes
-------------------------

- **VerifyError**: Exception class raised for verification errors when the option demands exceptions.
- **VerifyWarning**: Warning class used to issue warnings during verification.

These classes allow users to catch and handle verification issues appropriately.

Notifier Mixin
--------------

The new interface includes a `NotifierMixin` class that provides a mechanism for objects to register listeners and notify them of changes. This mixin supports:

- Registering listeners with weak references to avoid memory leaks.
- Notifying listeners of specific change types via dynamically called update methods.
- Ignoring listeners that do not implement the relevant update method.

This pattern facilitates decoupled communication between components, enabling responsive and maintainable code.

Usage Example:

```python
class Widget(NotifierMixin):
    state = 1
    def __init__(self, name):
        self.name = name
    def update_state(self):
        self.state += 1
```

Summary
-------

The transition to the new Header interface introduces a comprehensive verification system with flexible error handling options and a notification mechanism for change tracking. These enhancements improve the reliability and usability of FITS header management, providing users with better tools to maintain data integrity and respond to changes effectively.