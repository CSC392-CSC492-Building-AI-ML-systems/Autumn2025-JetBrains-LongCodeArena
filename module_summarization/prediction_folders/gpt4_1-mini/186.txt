Imputation of Missing Values
============================

Imputation is a common technique used to handle missing data in datasets by replacing missing values with substituted values. This process is essential for preparing data for machine learning models, which typically require complete datasets without missing entries.

SimpleImputer
-------------

The `SimpleImputer` class provides a straightforward and efficient way to impute missing values in a dataset using univariate imputation strategies. It replaces missing values using a descriptive statistic or a constant value along each feature (column).

Key Features:
- Supports multiple imputation strategies: mean, median, most frequent, and constant.
- Can handle numerical and categorical data.
- Supports missing value placeholders such as `np.nan`, `None`, or `pandas.NA`.
- Optionally adds an indicator for missing values to the output.

Parameters
~~~~~~~~~~

- **missing_values** : int, float, str, np.nan, None or pandas.NA, default=np.nan  
  The placeholder for the missing values. All occurrences of `missing_values` will be imputed. For pandas DataFrames with nullable integer dtypes, `missing_values` can be set to either `np.nan` or `pd.NA`.

- **strategy** : {'mean', 'median', 'most_frequent', 'constant'}, default='mean'  
  The imputation strategy to use:
  - `"mean"`: Replace missing values using the mean along each column. Applicable only to numeric data.
  - `"median"`: Replace missing values using the median along each column. Applicable only to numeric data.
  - `"most_frequent"`: Replace missing values using the most frequent value along each column. Can be used with strings or numeric data. In case of ties, the smallest value is returned.
  - `"constant"`: Replace missing values with a constant `fill_value`. Can be used with strings or numeric data.

- **fill_value** : str or numerical value, default=None  
  When `strategy="constant"`, this value is used to replace all missing values. For string or object data types, `fill_value` must be a string. If `None`, the default fill value is 0 for numerical data and `"missing_value"` for strings or object data types.

- **copy** : bool, default=True  
  If True, a copy of the input data is created before imputation. If False, imputation is performed in-place whenever possible.

- **add_indicator** : bool, default=False  
  If True, a `MissingIndicator` is added to the output to mark the locations of missing values.

- **keep_empty_features** : bool, default=False  
  Whether to keep features that are entirely missing during transformation.

Usage
~~~~~

The `SimpleImputer` can be used as follows:

```python
from sklearn.impute import SimpleImputer
import numpy as np

# Sample data with missing values
X = [[1, 2], [np.nan, 3], [7, 6]]

# Create an imputer object with a mean filling strategy
imputer = SimpleImputer(strategy='mean')

# Fit the imputer on the data
imputer.fit(X)

# Transform the data by replacing missing values
X_imputed = imputer.transform(X)
```

Additional Details
~~~~~~~~~~~~~~~~~~

- The imputer supports input data as NumPy arrays, sparse matrices, or pandas DataFrames.
- When using `add_indicator=True`, the imputer appends a binary indicator matrix to the output, where each indicator column corresponds to a feature with missing values.
- The imputer validates input data types and raises errors if the data type of `missing_values` is incompatible with the input data.
- For categorical data, the `"most_frequent"` and `"constant"` strategies are recommended.
- The imputer is compatible with scikit-learn's pipeline and estimator API, supporting methods such as `fit`, `transform`, and `fit_transform`.

BaseImputer
-----------

`_BaseImputer` is an internal base class for all imputers that provides common functionality such as handling missing value indicators and parameter validation. It manages the fitting and transformation of missing value indicators and concatenates them with the imputed data when requested.

MissingIndicator
----------------

The `MissingIndicator` is a utility that can be used to generate a mask indicating the presence of missing values in the dataset. When enabled via `add_indicator=True` in imputers, it helps models to learn from the pattern of missingness in addition to the imputed values.

Summary
-------

Imputation is a vital preprocessing step to handle missing data effectively. The `SimpleImputer` class offers a flexible and easy-to-use interface to replace missing values with meaningful substitutes, enabling robust model training and improved predictive performance. By choosing an appropriate strategy and optionally adding missing value indicators, users can tailor imputation to their specific dataset characteristics and modeling needs.