Logging Module
==============

This module provides a comprehensive logging setup for applications, supporting multiple logging handlers including console, file, and syslog with asynchronous capabilities. It extends the standard Python logging module with additional log levels and flexible configuration options.

Log Levels
----------

- **NOTICE (25)**: A custom log level introduced in this module. It represents informational messages that are visible in non-verbose mode but should not be used for warnings or errors. This level is between INFO and WARNING.

Constants
---------

- `LOG_NOTICE`: Integer value `25` representing the NOTICE log level.
- `_NAME_TO_LEVEL`: A dictionary mapping various string representations of log levels to their corresponding numeric values, including the custom NOTICE level.

Classes
-------

### Logging

The `Logging` class initializes and configures the logging system for the application. It manages multiple handlers and supports dynamic configuration based on the environment and application settings.

#### Initialization

```python
Logging(app)
```

- **app**: The application instance, used primarily for accessing the event loop and configuration.

#### Features

- **Root Logger**: Obtains the root logger instance.
- **Console Handler**: Adds a console logging handler if the output is a terminal or if forced by environment variable `ASABFORCECONSOLE`.
- **File Handler**: Configures a rotating file handler based on the configuration:
  - File path and directory creation.
  - Backup count and maximum file size.
  - Custom formatting using `StructuredDataFormatter`.
  - Optional log rotation based on time intervals (`rotate_every`), supporting days, hours, minutes, and seconds.
- **Syslog Handler**: Supports asynchronous syslog logging with multiple transport options:
  - Unix domain sockets (datagram or stream).
  - TCP or UDP sockets.
  - Various syslog message formats including MacOSX, RFC 5424 (with microsecond precision), and RFC 3164.
- **Asynchronous Operations**: Uses asyncio to schedule periodic log rotation checks and to handle syslog communication without blocking the main application.

Configuration
-------------

The logging behavior is controlled via a configuration object (`Config`) with the following relevant sections and keys:

- `logging:file`
  - `path`: Path to the log file.
  - `backup_count`: Number of backup files to keep.
  - `backup_max_bytes`: Maximum size of a log file before rotation.
  - `format`: Log message format string.
  - `datefmt`: Date/time format string.
  - `rotate_every`: Time interval for log rotation (e.g., "1d" for one day).
- `logging:syslog`
  - `enabled`: Boolean flag to enable syslog logging.
  - `address`: Address for syslog server (supports unix socket paths, TCP/UDP URLs).
  - `format`: Syslog message format identifier (`m`, `5`, `5micro`, or default).

Usage Notes
-----------

- The module ensures that the logging directory exists before creating file handlers.
- The custom NOTICE log level allows for more granular control over informational messages.
- The asynchronous syslog handler integrates with the application's event loop for efficient logging.
- Log rotation can be configured both by file size and by time intervals.
- The module automatically detects if the console is available and configures console logging accordingly.

Dependencies
------------

- Standard Python modules: `asyncio`, `datetime`, `logging`, `logging.handlers`, `os`, `queue`, `re`, `socket`, `sys`, `time`, `traceback`, `urllib.parse`.
- Internal modules: `Config`, `Timer`, and utility functions such as `running_in_container`.
- Custom formatters and handlers such as `StructuredDataFormatter`, `AsyncIOHandler`, `MacOSXSyslogFormatter`, `SyslogRFC5424Formatter`, `SyslogRFC5424microFormatter`, and `SyslogRFC3164Formatter` are used but not defined in this snippet.

Summary
-------

This logging module provides a robust and flexible logging infrastructure suitable for complex applications requiring multiple output targets, asynchronous operation, and advanced formatting. It extends Python's logging capabilities with custom log levels and integrates tightly with application configuration and event loops.