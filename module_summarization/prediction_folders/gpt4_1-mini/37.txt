w_trace Command
===============

Overview
--------
The `w_trace` command provides functionality to trace the trajectory of a specific segment in a WESTPA simulation back to its origin. It reconstructs the lineage of a trajectory segment across iterations, allowing detailed inspection of segment data, weights, and progress coordinates over time.

Key Features
------------
- Trace a trajectory segment from a specified iteration and segment ID back to its initial state.
- Access detailed segment information including weights, CPU and wall times, and progress coordinates.
- Retrieve time series data along the trajectory for datasets organized by segment and timepoint.
- Support for auxiliary HDF5 files to access additional data associated with trajectory segments.

Trace Class
-----------
The core of the `w_trace` functionality is encapsulated in the `Trace` class, which represents a trace of a trajectory segment back to its origin.

### Initialization
A `Trace` object is initialized with the following attributes:
- `summary`: A NumPy structured array summarizing the trajectory segments in the trace.
- `endpoint_type`: The type of endpoint for the last segment in the trace.
- `basis_state`: The basis state associated with the initial state of the trajectory.
- `initial_state`: The initial state object corresponding to the start of the trajectory.
- `data_manager`: An optional data manager instance for accessing WESTPA data.

### Creating a Trace
Use the class method `from_data_manager(n_iter, seg_id, data_manager=None)` to construct a `Trace` object for the trajectory segment identified by `seg_id` at iteration `n_iter`. This method:
- Iteratively follows parent segment IDs backward through iterations until reaching the initial state.
- Collects segment metadata such as weights, CPU and wall times, and final progress coordinates.
- Retrieves the initial state and basis state associated with the trajectory.

### Accessing Segment Data
The method `get_segment_data_slice(datafile, dsname, n_iter, seg_id, slice_=None, index_data=None, iter_prec=None)` allows retrieval of data for a specific segment and iteration from an HDF5 data file. It supports:
- Accessing datasets stored under iteration groups.
- Using an index dataset to locate segment data.
- Applying additional slicing to extract subsets of the data.

### Tracing Timepoint Datasets
The method `trace_timepoint_dataset(dsname, slice_=None, auxfile=None, index_ds=None)` returns a time series of data along the trajectory for datasets organized as `[seg_id][timepoint][...]`. It accounts for overlapping values at segment boundaries and returns:
- `data_trace`: The dataset values along the trajectory.
- `weight`: The corresponding trajectory weights at each time point.

Usage
-----
The `w_trace` command is typically used to analyze the detailed behavior of individual trajectory segments within WESTPA simulations. By reconstructing the full lineage of a segment, users can:
- Examine how weights and progress coordinates evolve over time.
- Extract segment-specific data for further analysis.
- Investigate performance metrics such as CPU and wall times.

This command is valuable for debugging, validation, and in-depth study of simulation trajectories.

Dependencies
------------
- `h5py` for HDF5 file access.
- `numpy` for numerical data handling.
- WESTPA core modules for data management and segment/state representations.

See Also
--------
- WESTPA documentation on trajectory analysis.
- `westpa.core.segment.Segment`
- `westpa.core.states.InitialState`
- WESTPA data management utilities.

---

This documentation summarizes the functionality provided by the `w_trace` command and the `Trace` class for tracing trajectory segments in WESTPA simulations.