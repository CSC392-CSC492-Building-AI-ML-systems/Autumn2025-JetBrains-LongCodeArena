Camera Geometry and Data Handling
=================================

Work with Images and Data Cubes Related to Cherenkov Cameras
------------------------------------------------------------

This module provides tools and classes to work with images and data cubes associated with Cherenkov cameras, focusing on the geometry and arrangement of telescopes in an array (subarray). It facilitates the management of telescope descriptions, their positions, and the handling of camera-related data structures.

SubarrayDescription
-------------------

The `SubarrayDescription` class is central to describing arrays or subarrays of Cherenkov telescopes. It collects the descriptions of all telescopes in the subarray along with their positions on the ground, enabling spatial and geometric computations relevant to camera data.

### Key Features

- **Telescope Descriptions**: Stores a dictionary of `TelescopeDescription` objects, each describing the properties of an individual telescope.
- **Telescope Positions**: Maintains the ground positions of telescopes as `astropy.coordinates.SkyCoord` objects in a custom `GroundFrame`.
- **Reference Location**: Supports specifying an Earth location as the reference point for the coordinate system.
- **Telescope Identification**: Provides mappings between telescope IDs and their indices, useful for indexing data arrays and images.
- **Information Display**: Offers an `info()` method to print a summary of the subarray, including the number of telescopes, their types, and IDs.

### Attributes

- `name` (`str`): Name of the subarray.
- `positions` (`Dict[int, np.ndarray]`): Dictionary mapping telescope IDs to their (x, y, z) positions on the ground.
- `tels` (`Dict[int, TelescopeDescription]`): Dictionary mapping telescope IDs to their descriptions.
- `reference_location` (`astropy.coordinates.EarthLocation`): Earth location of the array reference position.
- `tel_coords` (`astropy.coordinates.SkyCoord`): Telescope positions as SkyCoord objects in the ground frame.
- `tel_ids` (`np.ndarray`): Array of telescope IDs.
- `tel_indices` (`Dict[int, int]`): Mapping from telescope ID to a zero-based index.
- `tel_index_array` (`np.ndarray`): Array mapping telescope IDs to indices, with gaps filled by -1.

### Methods

- `__init__(name, tel_positions=None, tel_descriptions=None, reference_location=None)`: Initialize a new subarray description.
- `info(printer=print)`: Print descriptive information about the subarray.
- `tel_ids_to_indices(tel_ids)`: Convert telescope IDs to their corresponding indices.
- `tel_ids_to_mask(tel_ids)`: Convert a list of telescope IDs to a boolean mask for indexing.

Usage of these classes and methods allows for efficient handling of camera images and data cubes by associating pixel data with the physical layout and properties of the telescopes in the array. This is essential for calibration, image reconstruction, and analysis in Cherenkov telescope data processing pipelines.

Additional Utilities
--------------------

- Helper functions such as `_group_consecutives` and `_range_extraction` assist in formatting and summarizing telescope ID ranges for display purposes.
- Exception `UnknownTelescopeID` is defined to handle cases where an invalid telescope ID is encountered.

Integration with Astropy and ctapipe
------------------------------------

The module leverages `astropy` for coordinate transformations and units management, ensuring precise handling of telescope positions and orientations. It integrates with other components of the `ctapipe` framework, such as camera descriptions, optics, and telescope descriptions, to provide a comprehensive toolkit for Cherenkov camera data geometry.

Summary
-------

This documentation covers the foundational classes and methods for managing the geometry of Cherenkov telescope arrays and their cameras. By organizing telescope descriptions and positions, it enables robust handling of images and data cubes, facilitating downstream analysis and processing tasks in Cherenkov astronomy.