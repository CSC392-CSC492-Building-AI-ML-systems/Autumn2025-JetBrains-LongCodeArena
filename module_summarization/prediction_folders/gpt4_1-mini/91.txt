RandAugment Module
==================

Overview
--------
This module provides an implementation of the RandAugment data augmentation scheme as described in the paper:
`RandAugment: Practical automated data augmentation with a reduced search space <https://arxiv.org/abs/1909.13719>`_.

RandAugment applies a random selection of augmentation operations with varying magnitudes to batches of images or videos, enhancing the diversity of training data and improving model robustness.

Functions
---------

rand_augment(data, n, m, num_magnitude_bins=31, shape=None, fill_value=128, interp_type=None, max_translate_abs=None, max_translate_rel=None, seed=None, monotonic_mag=True, excluded=None)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Applies the RandAugment augmentation scheme to a batch of samples.

Parameters
^^^^^^^^^^
- **data** (*DataNode*):  
  A batch of samples to be processed. Supported inputs are images with `HWC` layout or videos with `FHWC` layout. The data type must be `uint8`.

- **n** (*int*):  
  The number of randomly sampled augmentation operations to apply to each sample.

- **m** (*int*):  
  The magnitude (strength) of each operation, an integer in the range `[0, num_magnitude_bins - 1]`.

- **num_magnitude_bins** (*int, optional*):  
  Number of discrete bins to divide the magnitude range into. Default is 31.

- **shape** (*DataNode or Tuple[int, int], optional*):  
  The spatial size (height, width) of the images or video frames. If provided, translation magnitudes are scaled relative to this shape.

- **fill_value** (*int, optional*):  
  Padding value used for warp affine transformations (translation, shear, rotate). If `None`, border values are clamped.

- **interp_type** (*types.DALIInterpType, optional*):  
  Interpolation method for warp affine operations. Supported values are `types.INTERP_LINEAR` (default) and `types.INTERP_NN`.

- **max_translate_abs** (*int or Tuple[int, int], optional*):  
  Maximum absolute pixel shift for translation augmentations when `shape` is not provided. If a tuple, specifies (height, width) limits. Defaults to 100 pixels.

- **max_translate_rel** (*float or Tuple[float, float], optional*):  
  Maximum relative shift as a fraction of image shape for translation augmentations when `shape` is provided. If a tuple, specifies (height, width) limits. Defaults to approximately 0.45 (100/224).

- **seed** (*int, optional*):  
  Seed for random sampling of operations and magnitude negations.

- **monotonic_mag** (*bool, optional*):  
  Controls the magnitude scaling behavior. If `True` (default), operation strengths increase monotonically with magnitude bins. If `False`, some color operations have non-monotonic magnitude scaling.

- **excluded** (*List[str], optional*):  
  List of augmentation operation names to exclude from the default RandAugment suite.

Returns
^^^^^^^
- *DataNode*:  
  A batch of augmented samples.

Description
-----------
The function randomly selects `n` augmentation operations from a predefined suite and applies them to each sample with magnitude `m`. The suite of augmentations can be customized by excluding specific operations. The magnitude scaling can be monotonic or non-monotonic depending on the `monotonic_mag` flag.

The module also supports specifying image or video frame shapes to scale translation augmentations relative to the input size, and allows control over interpolation and padding behavior for geometric transformations.

Usage Notes
-----------
- The input data must be in `uint8` format with appropriate layout (`HWC` for images, `FHWC` for videos).
- When excluding operations, ensure the names correspond to those in the default augmentation suite.
- For advanced customization, consider using the lower-level `apply_rand_augment` function with a custom list of augmentations.

License
-------
This module is licensed under the Apache License, Version 2.0.

References
----------
- Ekin D. Cubuk, Barret Zoph, Dandelion Man√©, Vijay Vasudevan, Quoc V. Le, "RandAugment: Practical automated data augmentation with a reduced search space", arXiv:1909.13719, 2019.  
  https://arxiv.org/abs/1909.13719