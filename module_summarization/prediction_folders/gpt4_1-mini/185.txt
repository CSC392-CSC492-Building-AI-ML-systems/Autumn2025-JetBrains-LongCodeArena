Tuning the hyper-parameters of an estimator
============================================

When building machine learning models, selecting the right hyper-parameters is crucial for achieving optimal performance. Hyper-parameters are parameters that are not learned from the data but set prior to the training process, such as the regularization strength in a linear model or the number of neighbors in a k-nearest neighbors classifier.

Grid Search
-----------

One common approach to hyper-parameter tuning is **grid search**, which exhaustively considers all parameter combinations in a specified grid. This method evaluates the model performance for each combination using cross-validation and selects the best performing set of parameters.

The process typically involves:

- Defining a parameter grid: a dictionary where keys are hyper-parameter names and values are lists of settings to try.
- Specifying a scoring metric to evaluate model performance.
- Running cross-validation for each parameter combination.
- Selecting the parameters that yield the best cross-validation score.

Example usage:

```python
from sklearn.model_selection import GridSearchCV
from sklearn.svm import SVC

param_grid = {
    'kernel': ['linear', 'rbf'],
    'C': [1, 10, 100]
}

grid_search = GridSearchCV(SVC(), param_grid, scoring='accuracy', cv=5)
grid_search.fit(X_train, y_train)

print("Best parameters:", grid_search.best_params_)
print("Best cross-validation score:", grid_search.best_score_)
```

Learning Curves for Hyper-parameter Tuning
------------------------------------------

Learning curves are a valuable diagnostic tool to understand how the model performance changes with varying training set sizes and to detect issues such as overfitting or underfitting. They can also help in assessing the impact of hyper-parameter choices.

The `LearningCurveDisplay` class provides a convenient way to visualize learning curves. It plots training and cross-validation scores against the number of training samples, optionally including standard deviation bands or error bars to indicate variability.

Key features of `LearningCurveDisplay`:

- Visualizes both training and test scores.
- Supports different styles for displaying variability (`fill_between` or `errorbar`).
- Automatically adjusts the x-axis scale based on the range of training sizes.
- Integrates seamlessly with scikit-learn’s `learning_curve` function.

Example of generating a learning curve plot:

```python
from sklearn.model_selection import learning_curve
from sklearn.model_selection import LearningCurveDisplay
import matplotlib.pyplot as plt

train_sizes, train_scores, test_scores = learning_curve(
    estimator, X, y, cv=5, scoring='accuracy', train_sizes=np.linspace(0.1, 1.0, 5)
)

display = LearningCurveDisplay(
    train_sizes=train_sizes,
    train_scores=train_scores,
    test_scores=test_scores,
    score_name="Accuracy"
)
display.plot()
plt.show()
```

By examining learning curves, you can gain insights into whether increasing the training data or adjusting hyper-parameters might improve model performance.

Best Practices
--------------

- Use cross-validation to reliably estimate model performance for each hyper-parameter setting.
- Start with a coarse grid to identify promising regions, then refine the search with a finer grid.
- Consider computational cost: grid search can be expensive for large parameter spaces.
- Complement grid search with other methods like randomized search or Bayesian optimization for efficiency.
- Use learning curves to diagnose model behavior and guide hyper-parameter tuning decisions.

See Also
--------

- `sklearn.model_selection.GridSearchCV` — Exhaustive search over specified parameter values for an estimator.
- `sklearn.model_selection.RandomizedSearchCV` — Randomized search on hyper-parameters.
- `sklearn.model_selection.learning_curve` — Generate learning curve data.
- `sklearn.model_selection.LearningCurveDisplay` — Visualize learning curves.

References
----------

- Scikit-learn User Guide: [Tuning the hyper-parameters of an estimator](https://scikit-learn.org/stable/modules/grid_search.html)
- Scikit-learn User Guide: [Learning curves](https://scikit-learn.org/stable/modules/learning_curve.html)