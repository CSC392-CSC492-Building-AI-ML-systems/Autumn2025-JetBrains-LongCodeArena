Metrics Module
==============

This module provides utility functions and validation routines for pairwise distance computations and metrics evaluation. It includes functions to check and prepare input arrays, ensuring compatibility and correctness before distance calculations are performed.

Authors
-------
- Alexandre Gramfort <alexandre.gramfort@inria.fr>
- Mathieu Blondel <mathieu@mblondel.org>
- Robert Layton <robertlayton@gmail.com>
- Andreas Mueller <amueller@ais.uni-bonn.de>
- Philippe Gervais <philippe.gervais@inria.fr>
- Lars Buitinck
- Joel Nothman <joel.nothman@gmail.com>

License
-------
BSD 3-Clause License

Functions
---------

_return_float_dtype(X, Y)
~~~~~~~~~~~~~~~~~~~~~~~~~
Determines the appropriate floating point data type for the input arrays `X` and `Y`.

- If both `X` and `Y` have dtype `float32`, returns `float32`.
- Otherwise, returns the default Python float type.

Parameters
----------
X : array-like or sparse matrix
    First input array.
Y : array-like or sparse matrix or None
    Second input array or None.

Returns
-------
X : array-like or sparse matrix
    Possibly converted input array.
Y : array-like or sparse matrix or None
    Possibly converted input array or None.
dtype : data-type
    The determined floating point data type.

check_pairwise_arrays(X, Y, *, precomputed=False, dtype=None, accept_sparse='csr', force_all_finite=True, copy=False)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Validates and prepares input arrays `X` and `Y` for pairwise distance computations.

- Ensures `X` and `Y` are arrays or sparse matrices.
- Checks dimensionality and dtype compatibility.
- Supports precomputed distance matrices.
- Handles sparse matrix formats and missing values.

Parameters
----------
X : array-like or sparse matrix of shape (n_samples_X, n_features)
    Input data.
Y : array-like or sparse matrix of shape (n_samples_Y, n_features) or None
    Input data or None. If None, `Y` is set to `X`.
precomputed : bool, default=False
    If True, `X` is treated as a precomputed distance matrix.
dtype : str, type, list of types, or None, default=None
    Desired data type for the arrays. If None, an appropriate float type is selected.
accept_sparse : str, bool, or list/tuple of str, default='csr'
    Allowed sparse matrix formats.
force_all_finite : bool or 'allow-nan', default=True
    Whether to raise an error on np.inf, np.nan, or pd.NA in the arrays.
copy : bool, default=False
    Whether to force a copy of the arrays.

Returns
-------
safe_X : array-like or sparse matrix
    Validated and possibly converted `X`.
safe_Y : array-like or sparse matrix
    Validated and possibly converted `Y`. If `Y` was None, this is a reference to `X`.

Raises
------
ValueError
    If input arrays have incompatible shapes or invalid values.

check_paired_arrays(X, Y)
~~~~~~~~~~~~~~~~~~~~~~~~~
Validates and prepares paired input arrays `X` and `Y` for paired distance computations.

- Ensures `X` and `Y` are arrays.
- Checks dimensionality and dtype compatibility.
- Intended for paired distance metrics where each pair corresponds to a single distance.

Parameters
----------
X : array-like of shape (n_samples, n_features)
    First input array.
Y : array-like of shape (n_samples, n_features)
    Second input array.

Returns
-------
safe_X : array-like
    Validated and possibly converted `X`.
safe_Y : array-like
    Validated and possibly converted `Y`.

Notes
-----
This module is a foundational component for distance metric computations, ensuring that inputs are correctly formatted and validated before any metric calculations are performed. It supports dense and sparse data representations and handles various edge cases related to data types and missing values.

References
----------
- SciPy Sparse Matrices: https://docs.scipy.org/doc/scipy/reference/sparse.html
- NumPy Array Interface: https://numpy.org/doc/stable/reference/arrays.ndarray.html

