Nearest Neighbors
=================

The Nearest Neighbors module provides efficient algorithms for nearest neighbor searches in high-dimensional spaces. It includes implementations of tree-based data structures such as Ball Trees, which are specialized binary trees optimized for spatial queries.

Ball Tree
---------

A Ball Tree is a binary tree data structure that partitions data points into nested hyperspheres ("balls"). Each node in the tree represents a ball containing a subset of the points, characterized by a centroid and a radius. This structure allows for efficient nearest neighbor queries by pruning large portions of the search space.

Key Features:
- Supports multiple data types, including 32-bit and 64-bit floating point numbers.
- Implements a variety of distance metrics, including but not limited to:
  - Bray-Curtis Distance
  - Canberra Distance
  - Chebyshev Distance
  - Dice Distance
  - Euclidean Distance
  - Hamming Distance
  - Haversine Distance
  - Jaccard Distance
  - Mahalanobis Distance
  - Manhattan Distance
  - Minkowski Distance
  - Rogers-Tanimoto Distance
  - Russell-Rao Distance
  - Squared Euclidean Distance
  - Sokal-Michener Distance
  - Sokal-Sneath Distance
  - Weighted Minkowski Distance
- Supports user-defined distance functions via PyFuncDistance.

Implementation Details
----------------------

The Ball Tree inherits from a generic Binary Tree structure and specializes it by using the concept of "reduced distance". The reduced distance is a computationally efficient proxy for the true distance that preserves the relative ordering of distances. For example, the squared Euclidean distance is used as the reduced distance for the Euclidean metric.

Each node in the Ball Tree stores:
- A centroid, computed as the weighted or unweighted mean of the points in the node.
- A radius, which is the maximum reduced distance from the centroid to any point in the node.

These properties enable efficient pruning during nearest neighbor searches by comparing the distance from a query point to the node's centroid and radius.

Usage
-----

The Ball Tree can be constructed for datasets with different floating point precisions (float32 or float64). The tree supports initialization with optional sample weights, which influence the centroid calculation.

Distance computations between points and nodes use the specified metric's distance function, and the tree maintains arrays for node bounds and indices to facilitate fast queries.

Summary
-------

The Ball Tree implementation in this module provides a flexible and efficient way to perform nearest neighbor searches using a variety of distance metrics and data types. Its design leverages reduced distances and hierarchical partitioning to optimize query performance in high-dimensional spaces.