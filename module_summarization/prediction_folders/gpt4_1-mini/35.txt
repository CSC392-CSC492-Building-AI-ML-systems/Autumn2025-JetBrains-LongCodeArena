w_states Command
================

The `w_states` command is used to display or manipulate basis (initial) and target (recycling) states in a WEST simulation. It provides functionality to view the current states, replace them, or append new target states for the next iteration of the simulation.

Modes of Operation
------------------

The command supports three mutually exclusive modes of operation:

- **--show**  
  Display the current basis and target states. The states can be printed to standard output or dumped to specified files.

- **--replace**  
  Replace the current basis and/or target states with those specified by the user. This operation updates the states for the next iteration of the simulation.

- **--append**  
  Append the given target states to the existing list of target states for the next iteration. Note that appending basis states is not permitted due to the complexity of renormalizing probabilities.

Basis States
------------

Basis states represent the initial states of the system. They are specified by a label, a probability, and optionally an auxiliary reference.

- **--bstate-file BSTATE_FILE**  
  Read basis state information from or write basis state information to the specified file, depending on the mode of operation.

- **--bstate 'label,probability[,auxref]'**  
  Add a basis state directly via the command line. This option can be specified multiple times to add multiple basis states. When used with `--replace`, the specified basis states replace the current set.

**Important:** Appending basis states is not supported. To modify basis states, use `--show` to export the current states to a file, edit the file as needed, and then use `--replace` with the updated file.

Target States
-------------

Target states represent recycling states defined by labels and representative progress coordinates.

- **--tstate-file TSTATE_FILE**  
  Read target state information from or write target state information to the specified file, depending on the mode of operation.

- **--tstate 'label,pcoord0[,pcoord1[,...]]'**  
  Add a target state directly via the command line. This option can be specified multiple times to add multiple target states. When used with `--append` or `--replace`, the specified target states are added or replace the current set, respectively.

Usage Notes
-----------

- When replacing states (`--replace`), if the current iteration has completed segments, the new states are applied to the next iteration.

- Basis state probabilities are automatically checked and rescaled if they do not sum to unity within numerical tolerance.

- Progress coordinates for basis states are assigned automatically during replacement.

- The command integrates with WESTPA's work manager environment and respects configuration options set via the WESTPA runtime configuration.

Examples
--------

Display current basis and target states:

```
w_states --show
```

Dump basis states to a file:

```
w_states --show --bstate-file bstates.txt
```

Replace basis states from a file:

```
w_states --replace --bstate-file bstates.txt
```

Append a new target state:

```
w_states --append --tstate 'state_label,0.5,1.2'
```

Replace target states from a file:

```
w_states --replace --tstate-file tstates.txt
```

Logging and Output
------------------

The command logs warnings if basis state probabilities do not sum to one and rescales them accordingly. Output files include comments indicating the iteration number for which the states apply.

Summary
-------

`w_states` is a versatile tool for managing the initial and recycling states in WEST simulations, enabling users to inspect, update, and extend the state definitions that guide simulation progress and recycling behavior.