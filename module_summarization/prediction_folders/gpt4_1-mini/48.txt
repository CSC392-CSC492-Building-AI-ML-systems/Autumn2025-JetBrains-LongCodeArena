Discrete Models (:mod:`statsmodels.discrete.discretemod`)
============================================================

This module provides implementations of zero-inflated count models, which are useful for modeling count data with an excess of zero counts. The zero-inflated models combine a count model with a binary model for the inflation of zeros.

Zero-Inflated Models
--------------------

The zero-inflated models in this module extend the standard count models by incorporating a separate process that models the probability of excess zeros. This is achieved by mixing a binary inflation model with a count data model.

Common features of zero-inflated models include:

- **exog_infl**: Explanatory variables for the zero-inflation (binary) model.
- **offset**: Offset added to the linear predictor with coefficient fixed at 1.
- **exposure**: Log(exposure) added to the linear predictor with coefficient fixed at 1.
- **inflation**: The link function for the zero-inflation model, either 'logit' (default) or 'probit'.

GenericZeroInflated Class
-------------------------

`GenericZeroInflated` is a base class for zero-inflated count models. It combines a count model with a zero-inflation model specified by a binary regression (logit or probit).

Parameters
~~~~~~~~~~

- **endog** : array_like  
  The endogenous response variable (count data).

- **exog** : array_like  
  The exogenous design matrix for the count model.

- **exog_infl** : array_like or None  
  Explanatory variables for the zero-inflation model. If None, a constant is used.

- **offset** : array_like  
  Offset added to the linear predictor with coefficient fixed at 1.

- **exposure** : array_like  
  Log(exposure) added to the linear predictor with coefficient fixed at 1.

- **inflation** : str, 'logit' or 'probit'  
  The link function for the zero-inflation model.

Attributes
~~~~~~~~~~

- **endog** : array  
  The endogenous response variable.

- **exog** : array  
  The exogenous design matrix for the count model.

- **exog_infl** : array  
  The exogenous design matrix for the zero-inflation model.

Methods
~~~~~~~

- **loglike(params)**  
  Computes the log-likelihood of the zero-inflated model given parameters.

- **loglikeobs(params)**  
  Computes the log-likelihood for each observation.

- **fit(...)**  
  Fits the zero-inflated model to data using maximum likelihood estimation.

Mathematical Formulation
------------------------

The log-likelihood function for the zero-inflated model is given by:

.. math::

    \ln L = \sum_{y_i=0} \ln \left( w_i + (1 - w_i) P_{\text{main model}}(y_i=0) \right) + \sum_{y_i>0} \left( \ln(1 - w_i) + \ln P_{\text{main model}}(y_i) \right)

where

- :math:`w_i` is the probability of zero inflation for observation :math:`i` (from the binary model),
- :math:`P_{\text{main model}}` is the probability mass function of the count model.

Usage Notes
-----------

- The zero-inflation model can be specified with either a logit or probit link function.
- The exogenous variables for the count and zero-inflation models can be different.
- The model handles missing data according to the `missing` parameter, but exog and exog_infl must have the same number of observations.
- Starting parameters for optimization are automatically generated if not provided.

Available Zero-Inflated Models
------------------------------

- **ZeroInflatedPoisson**  
  Zero-inflated Poisson model.

- **ZeroInflatedGeneralizedPoisson**  
  Zero-inflated Generalized Poisson model.

- **ZeroInflatedNegativeBinomialP**  
  Zero-inflated Negative Binomial model with parameterization P.

These models inherit from `GenericZeroInflated` and implement the specific count model likelihood and related methods.

Warnings
--------

- ConvergenceWarning may be issued if the optimization does not converge.
- Perfect separation in the zero-inflation model is handled internally.

References
----------

- Lambert, D. (1992). Zero-inflated Poisson regression, with an application to defects in manufacturing. Technometrics, 34(1), 1-14.
- Ridout, M., Dem√©trio, C. G. B., & Hinde, J. (1998). Models for count data with many zeros. International Biometric Conference.

This module is part of the `statsmodels` library and depends on other components such as `DiscreteModel`, `CountModel`, and various count distributions.