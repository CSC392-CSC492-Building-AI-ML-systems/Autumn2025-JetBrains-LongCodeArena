Encoding Media
==============

This module provides functionality for encoding media files within the ftrack API ecosystem. Encoding media typically involves transforming media files into different formats or compressing them for efficient storage and streaming.

Session Authentication
----------------------

The `SessionAuthentication` class is used to attach ftrack session authentication information to HTTP requests. It ensures that requests to the ftrack server include the necessary API key and user information for authentication.

Usage example:

```python
auth = SessionAuthentication(api_key='your_api_key', api_user='your_username')
response = requests.get('https://ftrack.example.com/api', auth=auth)
```

Session Management
------------------

The `Session` class represents an isolated session for interaction with an ftrack server. It manages connection details, authentication, caching, event handling, and plugin management.

### Initialization

To create a session, specify the server URL, API key, and API user. These can also be set via environment variables:

- `FTRACK_SERVER` — URL of the ftrack server.
- `FTRACK_API_KEY` — API key for authentication.
- `FTRACK_API_USER` — Username for the API user.

Example:

```python
session = Session(
    server_url='https://ftrack.example.com',
    api_key='your_api_key',
    api_user='your_username'
)
```

### Features

- **Auto-populate**: Automatically fetches entity attributes from the server when accessed.
- **Plugin paths**: Allows specifying paths to search for plugins.
- **Caching**: Supports layered caching with customizable cache and key maker implementations.
- **Event hub**: Supports connecting to an event hub for publishing and subscribing to events.
- **Schema caching**: Enables caching of schema information to improve performance.
- **Plugin arguments**: Supports passing arguments to plugins during registration.

### Notes

- The session enforces a memory cache at the top level to ensure consistent caching behavior.
- Event hub connections are performed in a background thread to improve startup time.
- Subscribing to events does not require a connected event hub, but publishing non-local events does.

Encoding Media Workflow
-----------------------

While the provided code primarily focuses on session management and authentication, encoding media within ftrack typically involves:

1. **Uploading media files** to the ftrack server or a connected storage location.
2. **Triggering encoding operations** via the API or plugins that handle media transformation.
3. **Monitoring encoding status** through session events or querying encoded media entities.
4. **Accessing encoded media** for review, playback, or further processing.

The session and authentication mechanisms ensure secure and efficient communication with the ftrack server during these operations.

Logging and Debugging
---------------------

The module uses Python's standard logging library to provide detailed logs. The `LazyLogMessage` utility is used for efficient logging message construction.

Dependencies
------------

The module depends on several external libraries, including:

- `requests` for HTTP communication.
- `arrow` for date and time handling.
- `clique` for managing collections of files.
- `ftrack_api` core modules for entity management, caching, events, and plugins.

Summary
-------

This module forms the foundation for interacting with the ftrack server, managing sessions, authentication, caching, and event handling, which are essential for encoding media workflows. By establishing a robust session and authentication framework, it enables reliable and secure media encoding operations within the ftrack ecosystem.