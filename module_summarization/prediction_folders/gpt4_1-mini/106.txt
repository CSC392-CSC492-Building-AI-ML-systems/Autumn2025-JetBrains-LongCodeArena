Hyperexpand Module
===================

Overview
--------

The `hyperexpand` module provides functionality to expand hypergeometric functions, including Meijer G functions, into named special functions. This expansion is achieved through a collection of lookup tables and properties of hypergeometric functions, enabling the transformation of many hypergeometric functions into simpler or more recognizable special functions.

The module is based on the paper:

- Kelly B. Roach, *Meijer G Function Representations*, Proceedings of the 1997 International Symposium on Symbolic and Algebraic Computation, pages 205-211, New York, 1997. ACM.

The detailed algorithm and usage are further described in the Sphinx documentation.

Key Features
------------

- **Expansion of Hypergeometric Functions:** Uses a knowledge base of formulas and properties to rewrite hypergeometric functions in terms of special functions.
- **Meijer G Function Extensions:** Implements several extensions and transformations for Meijer G functions, including parameter shifts and order reduction.
- **Shift Operators:** Defines four shift operators (A_J, B_J, C_J, D_J) that increment or decrement parameters of Meijer G functions, facilitating transformations and simplifications.
- **Order Reduction:** Detects when the order of a Meijer G function can be reduced based on relationships between parameters, simplifying expressions.
- **Formula Collection:** Maintains a collection of formulas (`FormulaCollection`) that serve as a lookup table for expansions.
- **Integration with SymPy:** Utilizes core SymPy classes and functions for symbolic manipulation, including `Eq`, `symbols`, and special functions like `gamma`, `besselj`, and `hyper`.

Usage Example
-------------

The module automatically generates documentation strings containing LaTeX representations of the known expansions when imported. For example, expansions of hypergeometric functions are represented as equations:

.. math::

   \text{Example: } \quad {}_pF_q(\ldots) = \text{special function representation}

This documentation is integrated into the Sphinx documentation system for easy reference.

Mathematical Background
-----------------------

The module implements several mathematical concepts related to hypergeometric and Meijer G functions:

- **Parameter Shifts:** The Meijer G function satisfies relations such as

  .. math::

     z^\rho G^{m,n}_{p,q}\left(z \mid a_p; b_q \right) = G^{m,n}_{p,q}\left(z \mid a_p + \rho; b_q + \rho \right)

- **Differential Operators:** The operator \( D = z \frac{d}{dz} \) is used to define shift operators acting on parameters.

- **Shift Operators:**

  - \( A_J = b_J - D \), for \( J = 1, \ldots, n \)
  - \( B_J = 1 - a_j + D \), for \( J = 1, \ldots, m \)
  - \( C_J = -b_J + D \), for \( J = m+1, \ldots, q \)
  - \( D_J = a_J - 1 - D \), for \( J = n+1, \ldots, p \)

  These operators increment or decrement parameters \( a_j \) and \( b_j \) under certain conditions.

- **Order Reduction:** When differences between parameters are non-negative integers, the order of the Meijer G function can be reduced, simplifying the function.

- **Reachability and Index Quadruples:** The module considers sequences of shift operators to determine if one set of parameters (index quadruple) can be transformed into another, which is important for formula matching.

Implementation Details
----------------------

- The module imports various components from SymPy's core, functions, polys, printing, and utilities submodules.
- It defines helper functions such as `_mod1` to handle modular arithmetic on parameters.
- The `add_formulae` function populates the knowledge base with known expansions, including classical hypergeometric function identities.
- The `FormulaCollection` class aggregates these formulas and provides an interface for accessing them.
- The module uses symbolic variables and matrices to represent and manipulate formulas.
- It supports expansions of functions like \( {}_0F_0 \), \( {}_1F_0 \), \( {}_2F_1 \), and others, with corresponding special function representations.

References
----------

- Kelly B. Roach, *Meijer G Function Representations*, ISSAC 1997.
- Luke, Y. L. (1969), *The Special Functions and Their Approximations*, Volume 1, Section 6.2.

Notes
-----

- The module is designed primarily for symbolic computation and integration within the SymPy library.
- It is intended to be used as part of a larger system for symbolic manipulation and simplification of special functions.
- The documentation generated by this module is automatically included in the Sphinx documentation for easy access to formulae and expansions.

.. contents::
   :local:
   :depth: 2

Formulae Examples
-----------------

The module includes many formulae for hypergeometric expansions. For instance:

- \( {}_0F_0() = e^z \)
- \( {}_1F_0(a; ) = (1 - z)^{-a} \) (represented via `HyperRep_power1`)
- \( {}_2F_1(a, a - \frac{1}{2}; 2a; z) \) expanded in terms of power functions and logarithms.

These formulae are stored in the `FormulaCollection` and can be accessed programmatically.

---

This documentation provides an overview and reference for the `hyperexpand` module, its mathematical foundations, and its implementation for expanding hypergeometric and Meijer G functions into named special functions.