Probability Calibration
=======================

Probability calibration is the process of adjusting the predicted probabilities of a classifier to better reflect the true likelihood of outcomes. Many classifiers produce scores or probabilities that are not well calibrated, meaning that the predicted probability does not correspond well to the actual frequency of the event. Calibration methods aim to transform these outputs so that, for example, among all samples predicted with a probability of 0.7, approximately 70% actually belong to the positive class.

Overview
--------

The `CalibratedClassifierCV` class provides a way to calibrate the predicted probabilities of a base classifier using cross-validation. It supports two main calibration methods:

- **Sigmoid calibration (Platt scaling):** Fits a logistic regression model to the classifier’s scores.
- **Isotonic regression:** A non-parametric calibration method that fits a piecewise constant non-decreasing function.

Usage
-----

The calibration process involves two main steps:

1. **Training the base classifier:** The base estimator is trained on a subset of the data.
2. **Calibrating the classifier:** The calibration model is fitted on a separate subset of data, using the base classifier’s outputs.

`CalibratedClassifierCV` automates this process using cross-validation to avoid overfitting during calibration.

Key Features
------------

- **Cross-validation based calibration:** The class uses cross-validation splits to fit the base estimator and calibrate it on separate data, ensuring unbiased calibration.
- **Ensemble of calibrated classifiers:** When `ensemble=True` (default), the final prediction is an average of calibrated classifiers trained on different folds.
- **Support for pre-fitted classifiers:** If the base estimator is already fitted, calibration can be performed directly on the provided data by setting `cv="prefit"`.
- **Choice of calibration method:** Users can select between 'sigmoid' (Platt scaling) and 'isotonic' calibration methods.
- **Parallel fitting:** Supports parallel fitting of base estimators across cross-validation folds via the `n_jobs` parameter.

Parameters
----------

- **estimator:** The base classifier to be calibrated. If none is provided, a linear SVM (`LinearSVC`) is used by default.
- **method:** Calibration method to use. Options are `'sigmoid'` for Platt scaling or `'isotonic'` for isotonic regression. The default is `'sigmoid'`.
- **cv:** Cross-validation strategy. Can be an integer (number of folds), a cross-validation splitter, an iterable yielding train/test splits, or `"prefit"` if the estimator is already trained.
- **n_jobs:** Number of parallel jobs to run for fitting base estimators.
- **ensemble:** Whether to fit an ensemble of calibrated classifiers (default `True`). If `False`, calibration is done on predictions obtained via cross-validation, and the final estimator is trained on all data.
- **base_estimator:** Deprecated parameter; use `estimator` instead.

Considerations
--------------

- **Isotonic regression requires sufficient data:** It is not recommended to use isotonic calibration with fewer than approximately 1000 calibration samples, as it may overfit.
- **Data splitting for pre-fitted estimators:** When using `cv="prefit"`, the user must ensure that the data used for calibration is disjoint from the data used to fit the base estimator to avoid biased calibration.
- **Calibration based on decision function or predict_proba:** Calibration is performed on the output of the base estimator’s `decision_function` if available; otherwise, `predict_proba` is used.

Attributes
----------

- **classes_:** Array of class labels.
- **n_features_in_:** Number of features seen during fitting (if available from the base estimator).
- **feature_names_in_:** Names of features seen during fitting (if available).
- **calibrated_classifiers_:** List of calibrated classifiers corresponding to each cross-validation fold or a single calibrated classifier if `cv="prefit"` or `ensemble=False`.

Further Reading
---------------

For more detailed information and examples, see the :ref:`User Guide <calibration>`.

License
-------

This implementation is provided under the BSD 3-Clause License.

Authors
-------

- Alexandre Gramfort
- Balazs Kegl
- Jan Hendrik Metzen
- Mathieu Blondel