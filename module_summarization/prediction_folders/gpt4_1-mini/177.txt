Pipelines and Composite Estimators
==================================

The `sklearn.pipeline` module provides utilities to build composite estimators by chaining together multiple transforms and a final estimator. This design allows for assembling several processing steps into a single object that can be cross-validated and parameter-tuned as a whole.

Pipeline
--------

A `Pipeline` is a sequential chain of transforms followed by a final estimator. Each intermediate step in the pipeline must implement both `fit` and `transform` methods, making them transformers. The final step only needs to implement `fit`, as it is the estimator that will be used for prediction or scoring.

The main purpose of a `Pipeline` is to simplify the process of applying multiple transformations and an estimator in sequence, while enabling parameter tuning across all steps using a unified interface. Parameters of individual steps can be accessed and set using a double underscore (`'__'`) syntax, for example, `pipeline.set_params(stepname__paramname=value)`.

Caching of fitted transformers is supported via the `memory` parameter, which can speed up repeated fitting by storing intermediate results.

### Key Features

- Sequentially apply a list of transforms and a final estimator.
- Intermediate steps must implement `fit` and `transform`.
- Final estimator must implement `fit`.
- Parameters of steps can be set and accessed using `'__'` syntax.
- Supports caching of transformers to speed up repeated fitting.
- Provides a `named_steps` attribute for easy access to individual steps.
- Compatible with scikit-learn’s model selection utilities such as `GridSearchCV`.

### Parameters

- **steps** : list of (name, transform) tuples  
  List of steps to be chained. Each step is a tuple consisting of a name and an estimator or transformer. The last step must be an estimator.

- **memory** : str or joblib.Memory-like object, default=None  
  Used to cache the fitted transformers of the pipeline. The last step is never cached. If a string is provided, it specifies the caching directory.

- **verbose** : bool, default=False  
  If True, prints the time elapsed while fitting each step.

### Attributes

- **named_steps** : Bunch  
  A dictionary-like object to access steps by name.

- **classes_** : ndarray of shape (n_classes,)  
  The class labels if the final estimator is a classifier.

- **n_features_in_** : int  
  Number of features seen during fit, if available from the first step.

- **feature_names_in_** : ndarray of shape (n_features_in_,)  
  Names of features seen during fit, if available from the first step.

### Example

```python
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.svm import SVC
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split

X, y = make_classification(random_state=0)
X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)

pipe = Pipeline([
    ('scaler', StandardScaler()),
    ('svc', SVC())
])

pipe.fit(X_train, y_train)
score = pipe.score(X_test, y_test)
print(score)  # e.g., 0.88

# Set parameters of a step using '__' syntax
pipe.set_params(svc__C=10).fit(X_train, y_train)
```

Composite Estimators
--------------------

Composite estimators are estimators that combine multiple processing steps into a single object. The `Pipeline` class is a primary example of a composite estimator, where multiple transformers and an estimator are chained together.

Composite estimators facilitate:

- Encapsulation of complex workflows into a single estimator.
- Simplified parameter tuning across multiple steps.
- Consistent API for fitting, transforming, and predicting.
- Integration with scikit-learn’s model selection and evaluation tools.

By using composite estimators, users can build modular and reusable machine learning workflows that are easier to maintain and optimize.

Further Reading
---------------

For more detailed information and examples, refer to the scikit-learn User Guide section on pipelines:  
https://scikit-learn.org/stable/modules/compose.html#pipeline

Example notebooks demonstrating pipeline usage and grid search can be found in the scikit-learn examples gallery.