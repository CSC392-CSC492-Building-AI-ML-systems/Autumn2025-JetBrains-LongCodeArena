w_kinetics Command
==================

Calculate state-to-state rates and transition event durations by tracing trajectories.

Overview
--------

The `w_kinetics` command calculates state-to-state kinetics by tracing trajectories through macrostates. It requires a bin assignment file (usually named `assign.h5`) that includes trajectory labeling. For information on generating this file, see the documentation for the `w_assign` command.

The output generated by `w_kinetics` is intended to be used as input for the `w_kinavg` tool, which converts the flux data into average rates with confidence intervals. For more details, see the help for `w_kinavg trace`.

Subcommands
-----------

- `trace`  
  Averages and confidence intervals for path-tracing kinetics analysis.  
  Default output file: `kintrace.h5`

Output Format
-------------

The output file (specified with `-o` or `--output`, default: `kintrace.h5`) contains the following datasets:

- **`/conditional_fluxes`** [iteration][state][state]  
  *(Floating-point)* Macrostate-to-macrostate fluxes. These values are **not** normalized by the population of the initial macrostate.

- **`/conditional_arrivals`** [iteration][stateA][stateB]  
  *(Integer)* Number of trajectories arriving at state *stateB* in a given iteration, given that they departed from *stateA*.

- **`/total_fluxes`** [iteration][state]  
  *(Floating-point)* Total flux into a given macrostate.

- **`/arrivals`** [iteration][state]  
  *(Integer)* Number of trajectories arriving at a given state in a given iteration, regardless of origin.

- **`/duration_count`** [iteration]  
  *(Integer)* Number of event durations recorded in each iteration.

- **`/durations`** [iteration][event duration]  
  *(Structured dataset)* Event durations for transition events ending during a given iteration. Each entry contains:  
  - `istate` *(Integer)*: Initial state of the transition event.  
  - `fstate` *(Integer)*: Final state of the transition event.  
  - `duration` *(Floating-point)*: Duration of the transition, in units of tau.  
  - `weight` *(Floating-point)*: Weight of the trajectory at the end of the transition, **not** normalized by the initial state population.

Important Notes
---------------

- The state-to-state fluxes stored in this file are **not** normalized by the initial macrostate population and therefore cannot be directly interpreted as rates.
- Use the `w_kinavg` command to perform normalization and to compute average rates with confidence intervals, accounting for statistical fluctuations and correlations.
- Target fluxes (total flux into a given state) do not require normalization.

Command-line Options
--------------------

For detailed command-line options and usage, run:

```bash
w_kinetics trace --help
```

Deprecation Notice
------------------

The `w_kinetics` command is deprecated. Users are encouraged to use the `w_direct` command instead for state-to-state kinetics calculations.