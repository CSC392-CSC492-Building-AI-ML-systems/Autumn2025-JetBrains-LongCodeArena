w_eddist — Calculate time-resolved transition-event duration distributions
=============================================================================

Description
-----------

The `w_eddist` command calculates time-resolved transition-event duration distributions from kinetics results generated by weighted ensemble (WE) simulations.

This tool processes source data collected from the results of the `w_kinetics trace` command. For more information on generating this dataset, see the documentation for `w_kinetics trace`.

Source Data
-----------

The input data for `w_eddist` is derived from the kinetics trace file, typically named `kintrace.h5`. This file contains detailed information about segment durations and weights across iterations, which are used to construct histograms representing the distribution of transition-event durations.

Histogram Binning
-----------------

By default, histograms are constructed with 100 bins in each dimension. This default can be overridden using the `-b` or `--bins` option, which accepts several types of arguments:

- **Single integer N**  
  Use `N` uniformly spaced bins in each dimension.

- **Sequence of integers N1,N2,... (comma-separated)**  
  Use `N1` bins for the first dimension, `N2` for the second, and so forth.

- **List of lists [[B11, B12, B13,...], [B21, B22, B23,...], ...]**  
  Specify explicit bin boundaries for each dimension. These boundaries need not be uniformly spaced. The expressions are evaluated using Python's `eval` with `np` (NumPy) available, allowing use of functions like `np.arange()`.

The first two forms (integer or list of integers) require scanning all data in each dimension to determine minimum and maximum values, which can be computationally expensive for large datasets. Providing explicit bin boundaries (the third form) avoids this overhead.

**Note:** These bins are unrelated to the bins used to drive WE sampling.

Output Format
-------------

The output file, specified by the `-o` or `--output` option (default: `pdist.h5`), contains the following datasets:

- **`histograms`**  
  Normalized histograms of transition-event durations. The first axis corresponds to iteration number, and subsequent axes correspond to the dimensions of the input data.

- **`/binbounds_0`, `/binbounds_1`, ...**  
  Datasets containing the bin boundaries for each dimension.

- **`/midpoints_0`, `/midpoints_1`, ...**  
  Datasets containing the bin midpoints for each dimension.

- **`n_iter`**  
  Vector of iteration numbers corresponding to the histograms.

This output can be used directly with the `plothist` tool to generate plots or further processed as needed.

Subsequent Processing
---------------------

The histogram data produced by `w_eddist` can be visualized using the `plothist` program. For more details, see the `plothist` documentation (`plothist --help`).

Parallelization
---------------

`w_eddist` supports parallelized binning and input data reading. Parallel processing is enabled by default to improve performance on large datasets.

For simpler cases, such as reading pre-computed input data with a modest number of segments, serial processing can be enabled using the `--serial` option, which may be more efficient.

Command-Line Options
--------------------

Run `w_eddist --help` to see a full list of available command-line options and their descriptions.

Example Usage
-------------

```bash
w_eddist -i kintrace.h5 -o pdist.h5 -b 50
```

This command reads kinetics data from `kintrace.h5`, computes transition-event duration histograms with 50 bins per dimension, and writes the output to `pdist.h5`.

See Also
--------

- `w_kinetics trace` — Generate kinetics trace data used as input for `w_eddist`.
- `plothist` — Visualize histogram data produced by `w_eddist`.

-----------------------------------------------------------------------------