Using Review Sessions
=====================

Overview
--------

A review session provides an isolated context for interacting with an ftrack server. It manages authentication, caching, event handling, and plugin integration to facilitate seamless communication with the server and efficient management of review data.

Creating a Review Session
-------------------------

To create a review session, instantiate the `Session` class with the appropriate parameters:

- **server_url**: The URL of the ftrack server, including any port number. If not provided, the environment variable `FTRACK_SERVER` will be used.
- **api_key**: The API key for authentication. If not provided, the environment variable `FTRACK_API_KEY` (or the legacy `FTRACK_APIKEY`) will be used.
- **api_user**: The username of the ftrack user. If not provided, the environment variable `FTRACK_API_USER` will be used, or the current system user will be used as a fallback.
- **auto_populate**: If `True` (default), entity attributes will be automatically fetched from the server when accessed.
- **plugin_paths**: List of paths to search for plugins. Defaults to the environment variable `FTRACK_EVENT_PLUGIN_PATH`.
- **cache**: A cache instance or callable to provide caching for the session.
- **cache_key_maker**: A key maker instance to generate keys for cached objects.
- **auto_connect_event_hub**: If `True`, the embedded event hub will automatically connect to the event server to enable publishing and subscribing to non-local events.
- **schema_cache_path**: Path to enable schema caching. If not set, the environment variable `FTRACK_API_SCHEMA_CACHE_PATH` or a temporary directory will be used.
- **plugin_arguments**: Optional dictionary of keyword arguments to pass to plugin register functions.

Example:

```python
import ftrack_api

session = ftrack_api.Session(
    server_url='https://ftrack.example.com',
    api_key='your_api_key',
    api_user='your_username',
    auto_populate=True,
    auto_connect_event_hub=True
)
```

Authentication
--------------

The session uses the `SessionAuthentication` class to attach authentication headers to HTTP requests. This ensures that all requests to the ftrack server are properly authenticated using the provided API key and user.

Caching
-------

The session supports caching to improve performance by reducing redundant server requests. By default, a layered cache is used with a memory cache at the top level. Custom caches and key makers can be provided to tailor caching behavior.

Event Hub
---------

The session includes an embedded event hub for publishing and subscribing to events. If `auto_connect_event_hub` is enabled, the event hub connects automatically in a background thread, allowing non-local event communication. Otherwise, only local events are available until the event hub is manually connected.

Plugins
-------

Plugins can be discovered and registered from specified plugin paths. Plugin arguments can be passed during registration to customize plugin behavior. The session handles compatibility of plugin signatures with provided arguments and logs warnings if adjustments are necessary.

Schema Caching
--------------

Schema caching can be enabled by specifying a path via `schema_cache_path` or the environment variable `FTRACK_API_SCHEMA_CACHE_PATH`. This improves performance by caching schema information locally. Setting this to `False` disables schema caching.

Session Lifecycle
-----------------

- The session maintains a collection of recorded operations that can be used to track changes.
- The `record_operations` flag controls whether operations are recorded.
- The session can be closed to release resources and disconnect from the event hub.

Summary
-------

Using a review session allows for efficient, authenticated, and extensible interaction with an ftrack server. It manages caching, event handling, and plugin integration transparently, enabling users to focus on managing review data and workflows effectively.