Working with User Security Roles
================================

Overview
--------

In ftrack, user security roles define the permissions and access levels assigned to users. Managing these roles effectively is crucial for maintaining a secure and organized project environment. This documentation provides an overview of how to work with user security roles using the ftrack API.

Accessing User Security Roles
-----------------------------

User security roles are accessible through the ftrack API session. Each user entity has associated security roles that determine their permissions within the system.

To interact with user security roles, you first need to establish a session with the ftrack server:

```python
import ftrack_api

session = ftrack_api.Session(
    server_url='https://your.ftrack.server',
    api_key='your_api_key',
    api_user='your_username'
)
```

Retrieving Security Roles
-------------------------

Once a session is established, you can retrieve the security roles assigned to a user by querying the user entity:

```python
user = session.query('User where username is "username"').one()
security_roles = user['security_roles']
for role in security_roles:
    print(role['name'])
```

This will list all security roles assigned to the specified user.

Assigning Security Roles
------------------------

To assign a new security role to a user, you can modify the user's `security_roles` attribute:

```python
role = session.query('SecurityRole where name is "RoleName"').one()
user['security_roles'].append(role)
session.commit()
```

This adds the specified role to the user's existing roles and commits the change to the server.

Removing Security Roles
-----------------------

Similarly, to remove a security role from a user:

```python
role_to_remove = session.query('SecurityRole where name is "RoleName"').one()
user['security_roles'].remove(role_to_remove)
session.commit()
```

This removes the role from the user's assigned roles.

Best Practices
--------------

- Always ensure you have the necessary permissions to modify user security roles.
- Use transactions (`session.commit()`) to apply changes atomically.
- Validate role existence before assignment or removal to avoid errors.
- Regularly audit user roles to maintain security compliance.

Notes
-----

- The ftrack API session handles authentication and communication with the server.
- Changes to security roles are immediately effective upon committing the session.
- Security roles control access to projects, tasks, and other entities within ftrack.

For more detailed information on user and security role entities, refer to the ftrack API reference documentation.