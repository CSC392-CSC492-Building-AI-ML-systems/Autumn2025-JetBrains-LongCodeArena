FileNode — Simulating a Filesystem with PyTables
===============================================

Overview
--------

The **FileNode** module provides a file-like interface for nodes within PyTables database files. It allows users to create and manipulate file nodes inside HDF5 files managed by PyTables, simulating a filesystem environment.

Using FileNode, you can:

- Create new file nodes that behave like ordinary Python files.
- Open existing file nodes for reading or appending data.
- Perform binary I/O operations on file nodes.

This functionality is particularly useful when you want to store file-like data inside a PyTables database, enabling efficient storage and retrieval within a single HDF5 file.

Key Features
------------

- **File-like Interface:** FileNode objects support standard file operations such as reading, writing (append-only), seeking, and truncating.
- **Binary I/O Support:** Currently, only binary input/output is supported.
- **Read and Append Modes:** Files can be opened in read-only mode or append mode (`'a+'`), where writing is limited to appending data.
- **Compliance with Python I/O:** Since version 3.0, FileNode is fully compliant with the interfaces defined in Python’s built-in `io` module.
- **Integration with PyTables:** FileNode works seamlessly with PyTables nodes, leveraging PyTables’ efficient storage and indexing.

Creating and Opening File Nodes
-------------------------------

- **Creating a New File Node:** Use the `new_node()` function to create a brand new file node within a PyTables file. The new node behaves like a regular file that can be read and written.
- **Opening an Existing File Node:** Use the `open_node()` function to open an existing file node for reading or appending. Read access is always available, while write access is limited to appending data.

FileNode Class: RawPyTablesIO
-----------------------------

The core class implementing the file-like interface is `RawPyTablesIO`, which inherits from Python’s `io.RawIOBase`. It provides low-level binary I/O operations on PyTables nodes.

### Important Attributes

- `mode`: The file mode, indicating read or append access.
- `_pos`: The current position within the file node.
- `_version`: The version of the node type, used internally to handle data shape.
- `_node`: The underlying PyTables node representing the file.

### Supported Methods

- `tell()`: Returns the current position in the file.
- `seek(pos, whence=0)`: Changes the current position. Supports seeking from the start, current position, or end of the file.
- `seekable()`: Returns `True`, indicating random access is supported.
- `fileno()`: Returns the underlying file descriptor of the PyTables file.
- `close()`: Flushes and closes the file node interface.
- `flush()`: Flushes write buffers to the underlying PyTables file.
- `truncate(pos=None)`: Truncates the file to a specified size. Only growing the file is supported.
- `readable()`: Returns `True` if the file node is open for reading.
- `writable()`: Returns `True` if the file node is open for writing (append mode).
- `readinto(b)`: Reads bytes into a buffer `b`.
- `readline(limit=-1)`: Reads a line from the file node (binary data).

Usage Notes
-----------

- **Appending Only:** Write operations are limited to appending data; overwriting or deleting data is not supported.
- **Binary Mode:** Only binary I/O is supported; text mode is not available.
- **Versioning:** FileNode supports multiple versions of the node type, ensuring compatibility and correct data handling.
- **Error Handling:** The interface raises appropriate exceptions for invalid operations, such as seeking to negative positions or truncating to smaller sizes.

Additional Resources
--------------------

For detailed instructions and examples on using FileNode, please refer to the :ref:`filenode_usersguide`.

Version History
---------------

- **Version 3.0:** The module was completely rewritten to comply fully with Python’s `io` module interfaces, improving compatibility and usability.

---

The FileNode module thus provides a powerful and flexible way to simulate a filesystem within PyTables databases, enabling efficient storage and manipulation of file-like data inside HDF5 files.