Plothist Command
================

The `plothist` command provides functionality to visualize histogram data stored in HDF5 files. It supports plotting one- or two-dimensional histograms with various scaling options and customization features.

Usage
-----

```bash
plothist [OPTIONS] INPUT [DIMENSION]
```

Arguments
---------

- **INPUT**  
  The HDF5 file containing the histogram data to be plotted.

- **DIMENSION** (optional)  
  Specifies the dimension of the histogram to plot. The dimension can be specified as:  
  ```
  INT[:[LB,UB]:LABEL]
  ```  
  where:  
  - `INT` is a zero-based integer identifying the dimension in the histogram.  
  - `LB` and `UB` are optional lower and upper bounds for plotting along that dimension.  
  - `LABEL` is an optional label for the plot axis.  
  If not provided, defaults to dimension 0 with the full range.

Options
-------

### Input Options

- `INPUT`  
  The HDF5 file containing histogram data.

- `DIMENSION`  
  Dimension specification as described above.

### Output Options

- `-o, --output, --plot-output PLOT_OUTPUT`  
  Store the plot as the specified file. The output format is determined by the filename extension (default is PDF).  
  To suppress plotting entirely, set this to an empty string (`--plot-output=''`).  
  Default: `hist.pdf`

- `--hdf5-output HDF5_OUTPUT`  
  Store plot data in the specified HDF5 file.

- `--plot-contour`  
  Superimpose a contour plot over the heatmap for 2D histograms.

### Plot Options

- `--title TITLE`  
  Include the specified TITLE as the top-of-graph title.

- `--linear`  
  Plot the histogram on a linear scale.

- `--energy`  
  Plot the histogram on an inverted natural logarithm scale, corresponding to (free) energy. This is the default scale.

- `--zero-energy E`  
  Set the zero of energy to `E`, which may be a scalar value, or the strings `"min"` or `"max"`.  
  Default: `"min"`

- `--log10`  
  Plot the histogram on a base-10 logarithmic scale.

- `--range LB,UB`  
  Plot histogram ordinates over the given range, specified as `"LB,UB"`.  
  For 1D plots, this applies to the Y axis. For 2D plots, this applies to the colorbar axis.  
  Default: full range.

- `--postprocess-function MODULE.FUNCTION`  
  Specify a function to be called just prior to saving the plot. The function should have the signature:  
  ```python
  postprocess(hist, midpoints, binbounds)
  ```  
  where:  
  - `hist` is the histogram data that was plotted.  
  - `midpoints` are the bin midpoints for each dimension.  
  - `binbounds` are the bin boundaries for each dimension for 2D plots, or `None` otherwise.  
  The function should modify the plot in place using the `matplotlib.pyplot` stateful interface.

Description
-----------

The `plothist` command reads histogram data from an HDF5 file and generates plots to visualize the distribution of data along specified dimensions. It supports flexible dimension selection, axis labeling, and range specification.

Plotting scales include linear, logarithmic (base 10), and an energy scale based on the negative natural logarithm of the histogram values, which is useful for free energy representations.

For two-dimensional histograms, the command can overlay contour plots on heatmaps to enhance visualization.

The command also supports exporting the plot data back into an HDF5 file for further analysis or reuse.

Examples
--------

Plot the first dimension of the histogram stored in `data.h5` with default settings:

```bash
plothist data.h5
```

Plot the second dimension (dimension 1) with custom axis label and range:

```bash
plothist data.h5 1:[0,10]:MyLabel
```

Plot using a linear scale and save the output as a PNG file:

```bash
plothist data.h5 --linear -o output.png
```

Suppress plotting but save the processed histogram data to an HDF5 file:

```bash
plothist data.h5 --plot-output='' --hdf5-output processed.h5
```

Plot a 2D histogram with contour overlay:

```bash
plothist data.h5 0 --plot-contour
```

Use a custom postprocessing function to modify the plot before saving:

```bash
plothist data.h5 --postprocess-function mymodule.customize_plot
```

Notes
-----

- The dimension specification allows fine control over which part of the histogram to plot and how to label the axes.

- The energy scale is particularly useful for visualizing free energy landscapes derived from probability histograms.

- The postprocessing function hook enables advanced users to customize plots beyond the built-in options.

- The command is part of the WESTPA toolkit and integrates with its data formats and conventions.

See Also
--------

- WESTPA documentation for histogram data formats and analysis tools.

- `matplotlib` documentation for details on plotting and customization.

- `h5py` documentation for working with HDF5 files.

---

This documentation provides an overview of the `plothist` command and its options for plotting histogram data from HDF5 files.