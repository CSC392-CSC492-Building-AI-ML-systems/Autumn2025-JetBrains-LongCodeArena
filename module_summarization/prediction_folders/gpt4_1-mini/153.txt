Geometric Image Transformations
===============================

This module provides tools and classes for geometric image transformations, focusing on camera models and their associated parameters. These transformations are essential for tasks such as image rectification, 3D reconstruction, and camera calibration.

PinholeCamera Class
-------------------

The `PinholeCamera` class represents a pinhole camera model, encapsulating both intrinsic and extrinsic camera parameters in a batched format to leverage PyTorch's parallel computation capabilities.

Class Initialization
~~~~~~~~~~~~~~~~~~~~

```python
PinholeCamera(intrinsics: torch.Tensor, extrinsics: torch.Tensor, height: torch.Tensor, width: torch.Tensor)
```

- **intrinsics** (`torch.Tensor`): A tensor of shape :math:`(B, 4, 4)` containing the full 4x4 camera calibration matrices for a batch of cameras.
- **extrinsics** (`torch.Tensor`): A tensor of shape :math:`(B, 4, 4)` containing the full 4x4 rotation-translation matrices for a batch of cameras.
- **height** (`torch.Tensor`): A tensor of shape :math:`(B)` containing the image heights for each camera in the batch.
- **width** (`torch.Tensor`): A tensor of shape :math:`(B)` containing the image widths for each camera in the batch.

.. note::
    The class attributes are stored in batch form to optimize performance using PyTorch's parallelism.

Properties
~~~~~~~~~~

- **intrinsics** (`torch.Tensor`): Returns the full 4x4 intrinsics matrix of shape :math:`(B, 4, 4)`.
- **extrinsics** (`torch.Tensor`): Returns the full 4x4 extrinsics matrix of shape :math:`(B, 4, 4)`.
- **batch_size** (`int`): Returns the batch size, i.e., the number of cameras stored.
- **fx** (`torch.Tensor`): Returns the focal length in the x-direction, shape :math:`(B)`.
- **fy** (`torch.Tensor`): Returns the focal length in the y-direction, shape :math:`(B)`.
- **cx** (`torch.Tensor`): Returns the x-coordinate of the principal point, shape :math:`(B)`.
- **cy** (`torch.Tensor`): Returns the y-coordinate of the principal point, shape :math:`(B)`.
- **tx** (`torch.Tensor`): Returns the x-coordinate of the translation vector, shape :math:`(B)`.
- **ty** (`torch.Tensor`): Returns the y-coordinate of the translation vector, shape :math:`(B)`.
- **tz** (`torch.Tensor`): Returns the z-coordinate of the translation vector, shape :math:`(B)`.

The translation vector components (`tx`, `ty`, `tz`) also have setters allowing modification of the translation vector values.

- **rt_matrix** (`torch.Tensor`): Returns the 3x4 rotation-translation matrix extracted from the extrinsics, shape :math:`(B, 3, 4)`.
- **camera_matrix** (`torch.Tensor`): Returns the 3x3 camera matrix containing the intrinsic parameters, shape :math:`(B, 3, 3)`.
- **rotation_matrix** (`torch.Tensor`): Returns the 3x3 rotation matrix extracted from the extrinsics, shape :math:`(B, 3, 3)`.
- **translation_vector** (`torch.Tensor`): Returns the translation vector extracted from the extrinsics, shape :math:`(B, 3, 1)`.

Usage Notes
~~~~~~~~~~~

- The class expects all inputs to be batched tensors, where the batch dimension corresponds to multiple cameras or views.
- The intrinsic and extrinsic matrices must be of shape :math:`(B, 4, 4)` or :math:`(B, N, 4, 4)` where applicable.
- Image height and width are expected as 1D tensors of shape :math:`(B)`.

This class serves as a foundational component for geometric transformations involving camera parameters, enabling efficient and flexible manipulation of camera models in computer vision pipelines.