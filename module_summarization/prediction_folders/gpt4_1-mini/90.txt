auto_augment module
===================

This module provides functionality to apply AutoAugment policies to batches of images or videos using NVIDIA DALI. AutoAugment is a data augmentation technique introduced in the paper "AutoAugment: Learning Augmentation Policies from Data" (https://arxiv.org/abs/1805.09501), which applies a set of learned augmentation policies to improve model generalization.

Functions
---------

auto_augment(data, policy_name='image_net', shape=None, fill_value=128, interp_type=None, max_translate_abs=None, max_translate_rel=None, seed=None) → DataNode
    Applies one of the predefined AutoAugment policies to the provided batch of samples.

    Parameters
    ----------
    data : DataNode
        A batch of samples to be processed. Supported samples are images with `HWC` layout and videos with `FHWC` layout. The supported data type is `uint8`.
    policy_name : str, optional
        The name of the predefined policy to apply. Acceptable values are:
        - `image_net`
        - `reduced_image_net`
        - `svhn`
        - `reduced_cifar10`
        Defaults to `image_net`.
    shape : DataNode or Tuple[int, int], optional
        The size (height, width) of the image or frames in the video sequence passed as `data`.
        If specified, the magnitude of translation operations depends on the image/frame shape and spans from 0 to `max_translate_rel * shape`.
        Otherwise, the magnitude range is `[0, max_translate_abs]` for any sample.
    fill_value : int, optional
        Value used as padding for images/frames transformed with warp_affine operations (translation, shear, rotate).
        If `None`, images/frames are padded with the border value repeated (clamped).
        Defaults to 128.
    interp_type : types.DALIInterpType, optional
        Interpolation method used by warp_affine operations.
        Supported values are `types.INTERP_LINEAR` (default) and `types.INTERP_NN`.
    max_translate_abs : int or (int, int), optional
        Maximum absolute pixel shift for translation augmentations.
        Only valid when `shape` is not provided.
        If a tuple, the first component limits height, the second limits width.
        Defaults to 250 pixels.
    max_translate_rel : float or (float, float), optional
        Maximum relative shift as a fraction of image shape for translation augmentations.
        Only valid when `shape` is provided.
        If a tuple, the first component limits height, the second limits width.
        Defaults to 1.0 (shifts image entirely out of canvas).
    seed : int, optional
        Seed for random sampling of operations and negation of magnitudes.

    Returns
    -------
    DataNode
        A batch of transformed samples.

auto_augment_image_net(data, shape=None, fill_value=128, interp_type=None, max_translate_abs=None, max_translate_rel=None, seed=None) → DataNode
    Applies the `image_net` AutoAugment policy to the provided batch of samples.

    This function is equivalent to calling :func:`auto_augment` with `policy_name='image_net'`.

    Parameters
    ----------
    data : DataNode
        A batch of samples to be processed.
    shape : DataNode or Tuple[int, int], optional
        Size of the image or frames in the video sequence.
    fill_value : int, optional
        Padding value for warp_affine operations.
    interp_type : types.DALIInterpType, optional
        Interpolation method for warp_affine operations.
    max_translate_abs : int or (int, int), optional
        Maximum absolute pixel shift for translation augmentations.
    max_translate_rel : float or (float, float), optional
        Maximum relative shift for translation augmentations.
    seed : int, optional
        Seed for random sampling.

    Returns
    -------
    DataNode
        A batch of transformed samples.

Notes
-----

- The module depends on `numpy`. If `numpy` is not installed, a `RuntimeError` is raised.
- The supported input data types are images with `HWC` layout and videos with `FHWC` layout, both with `uint8` data type.
- Some policies do not support translation augmentations and thus do not accept shape-related arguments.
- The module uses NVIDIA DALI's internal augmentation framework and types.

Predefined Policies
-------------------

The following predefined policies are available:

- `image_net`
- `reduced_image_net`
- `svhn`
- `reduced_cifar10`

Each policy corresponds to a set of augmentation operations tailored for specific datasets or use cases.

License
-------

This module is licensed under the Apache License, Version 2.0. See the LICENSE file or http://www.apache.org/licenses/LICENSE-2.0 for details.