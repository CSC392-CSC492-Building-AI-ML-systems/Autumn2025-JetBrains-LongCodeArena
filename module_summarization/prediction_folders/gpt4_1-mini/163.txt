Tensor Attributes
=================

In the OneFlow MLIR dialect, tensors are fundamental data structures that represent multi-dimensional arrays of elements. Each tensor is characterized by a set of attributes that define its shape, element type, and other properties essential for compilation and optimization.

Common Tensor Attributes
------------------------

- **shape**  
  The `shape` attribute specifies the dimensions of the tensor. It is typically represented as a list of integers, where each integer corresponds to the size of the tensor along a particular dimension. For example, a tensor with shape `[2, 3, 4]` has three dimensions with sizes 2, 3, and 4 respectively.

- **element_type**  
  The `element_type` attribute defines the data type of the elements stored in the tensor. This can be any valid MLIR or LLVM type such as `f32` (32-bit floating point), `i64` (64-bit integer), etc. The element type is crucial for type checking and code generation.

- **encoding** (optional)  
  Some tensors may have an `encoding` attribute that provides additional metadata about the layout or storage format of the tensor data. This can be used to specify memory layout optimizations or hardware-specific encodings.

- **stride** (optional)  
  The `stride` attribute, when present, indicates the step size in memory to move from one element to the next along each dimension. This is useful for describing tensors with non-contiguous memory layouts.

Usage in Dialect Definitions
----------------------------

Tensor attributes are used extensively in operation definitions within the OneFlow dialect to specify input and output tensor types. They enable the compiler to perform shape inference, type checking, and optimization passes effectively.

For example, an operation that takes a tensor input and produces a tensor output will declare attributes for the input tensorâ€™s shape and element type, ensuring that the operation semantics are well-defined and consistent.

Interoperability
----------------

Tensor attributes in OneFlow MLIR are designed to be compatible with standard MLIR tensor types and attributes, facilitating interoperability with other MLIR dialects and tools. This compatibility allows seamless integration of OneFlow operations into larger MLIR-based compilation pipelines.

Summary
-------

Tensor attributes provide a structured way to describe the properties of tensors in the OneFlow MLIR dialect. By explicitly specifying shape, element type, and optional metadata such as encoding and stride, these attributes enable robust compilation, optimization, and code generation for tensor computations.