Conditions in PyTables
======================

PyTables provides a powerful and flexible way to query tables using *conditions*. Conditions allow you to select rows from a table that satisfy certain criteria, similar to the WHERE clause in SQL. This document describes the syntax and usage of conditions in PyTables.

Basic Syntax
------------

A condition in PyTables is a string expression that specifies a logical test on the columns of a table. For example, to select rows where the column `age` is greater than 30, you can write:

.. code-block:: python

    condition = 'age > 30'

You can use standard Python comparison operators in conditions:

- `==` : equal to
- `!=` : not equal to
- `<`  : less than
- `<=` : less than or equal to
- `>`  : greater than
- `>=` : greater than or equal to

Logical Operators
-----------------

Conditions can be combined using logical operators:

- `&` : logical AND
- `|` : logical OR
- `~` : logical NOT

Parentheses can be used to group expressions and control precedence:

.. code-block:: python

    condition = '(age > 30) & (weight < 70)'

Column Names
------------

Column names used in conditions must correspond to the names of columns in the table. If a column name contains special characters or spaces, it should be enclosed in backticks:

.. code-block:: python

    condition = '`column name` == 5'

String Comparisons
------------------

String columns can be compared using equality and inequality operators:

.. code-block:: python

    condition = 'name == "John"'

Note that string comparisons are case-sensitive.

Using NumPy Functions
---------------------

You can use some NumPy functions in conditions for more complex queries, such as `abs()`, `sin()`, `cos()`, etc. For example:

.. code-block:: python

    condition = 'abs(balance) > 1000'

Special Functions and Methods
-----------------------------

PyTables supports some special functions and methods in conditions:

- `in` operator to check membership in a list or tuple:

  .. code-block:: python

      condition = 'age in [25, 30, 35]'

- `startswith()` and `endswith()` string methods:

  .. code-block:: python

      condition = 'name.startswith("J")'

- `isnan()` to check for NaN values:

  .. code-block:: python

      condition = 'isnan(balance)'

Performance Considerations
--------------------------

Conditions are parsed and compiled into efficient C code internally, allowing fast queries even on large datasets. However, complex conditions or the use of unsupported Python functions may fall back to slower Python evaluation.

Indexing and Conditions
-----------------------

PyTables supports indexing on table columns to speed up condition evaluation. When a column is indexed, queries using conditions on that column can be executed much faster.

If an index is *dirty* (out of sync with the table data), it will not be used for condition evaluation until it is rebuilt.

Examples
--------

Selecting rows where `age` is between 20 and 30:

.. code-block:: python

    condition = '(age >= 20) & (age <= 30)'

Selecting rows where `name` starts with 'A' and `score` is above 80:

.. code-block:: python

    condition = 'name.startswith("A") & (score > 80)'

Selecting rows where `status` is either 'active' or 'pending':

.. code-block:: python

    condition = 'status in ("active", "pending")'

Notes
-----

- Conditions are case-sensitive with respect to column names and string values.
- Use parentheses to ensure the correct order of evaluation.
- Avoid using Python functions not supported by PyTables in conditions, as this will degrade performance.

See Also
--------

- :ref:`Table.read_where` — Reading rows from a table using conditions.
- :ref:`Table.where` — Iterating over rows matching a condition.
- :ref:`Index` — Indexing support for accelerating condition queries.

This documentation provides an overview of the condition syntax in PyTables to help you write efficient and expressive queries on your tabular data.