Getting Started with Mitogen Core
==================================

Overview
--------
This module provides core functionality common to both master and parent processes within the Mitogen framework. It is designed to be sent to any child context that is expected to become a parent due to recursive connection. The code handles various low-level operations such as process management, inter-process communication, and system compatibility considerations.

Key Features
------------
- Compatibility with multiple Python versions, including legacy support for Python 2.4 and 2.5.
- Detection and handling of SELinux enforcement to avoid using socketpairs when SELinux is enabled.
- Utilities for managing PTYs (pseudo-terminals), including error handling for system limits.
- Safe retrieval of the Python executable path with fallback and warning if the path is unset.
- Thread-safe caching and retrieval of core source code for efficient operation.
- Signal number to name mapping for easier debugging and signal handling.
- Cross-platform support with specific handling for Linux systems.

Important Constants and Variables
---------------------------------
- `SELINUX_ENABLED`: Boolean indicating if SELinux is enabled on the system.
- `SC_OPEN_MAX`: Maximum number of open files allowed by the system.
- `BROKER_SHUTDOWN_MSG`: Message used when a connection is cancelled due to broker shutdown.
- `OPENPTY_MSG`: Error message displayed when PTY creation fails, often due to system limits.
- `SYS_EXECUTABLE_MSG`: Warning message when the Python executable path is not set.
- `IS_LINUX`: Boolean indicating if the current system is Linux.
- `SIGNAL_BY_NUM`: Dictionary mapping signal numbers to their names.

Functions
---------
- `get_log_level()`: Returns the current effective logging level.
- `get_sys_executable()`: Returns the path to the Python executable. If unset, returns `"/usr/bin/python"` and logs a warning.
- `_ioctl_cast(n)`: Casts ioctl request parameters to the appropriate signed or unsigned integer based on the Python version and platform.
- `get_core_source_partial()`: Provides a thread-safe, cached partial compressed version of the core source code for efficient distribution to child contexts.

Usage Notes
-----------
- The module avoids using socketpairs on systems with SELinux enabled to maintain compatibility.
- When creating PTYs, if the system limit is reached, an informative error message guides the user to adjust system settings.
- The Python executable path is critical for starting child contexts; if it is not set, a default path is used with a warning logged.
- The core source code is minified and cached to optimize performance when sending code to child contexts.
- Signal names are available for debugging and handling signals in a human-readable form.

System Requirements
-------------------
- Python 2.4 or later (with special handling for older versions).
- Linux or Unix-like operating system (with specific Linux checks).
- Proper system configuration for PTY limits if extensive PTY usage is expected.

Logging
-------
The module uses Python’s standard logging library. The default log level can be retrieved using `get_log_level()`. Warnings, such as missing Python executable paths, are logged to assist with troubleshooting.

Conclusion
----------
This core module is foundational for Mitogen’s operation, providing essential utilities and compatibility layers that enable robust and efficient process management and communication. Understanding its components and behavior is key to effectively using and extending Mitogen in complex environments.