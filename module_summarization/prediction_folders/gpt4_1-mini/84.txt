Piccolo Apps Module
===================

Overview
--------
This module provides the core classes and functions to manage Piccolo applications, including app configuration, table discovery, and migration handling. It facilitates the registration and discovery of database table classes, management of app-specific commands, and handling of migration dependencies.

Key Classes and Functions
-------------------------

MigrationModule
---------------
A subclass of Python's `ModuleType` representing a migration module. It includes metadata attributes such as:

- `ID`: Identifier for the migration.
- `VERSION`: Version of the migration.
- `DESCRIPTION`: Description of the migration.

It also defines an asynchronous static method `forwards()` which is intended to apply the migration.

PiccoloAppModule
----------------
A subclass of `ModuleType` representing a Piccolo app module. It contains:

- `APP_CONFIG`: An instance of `AppConfig` that holds the configuration for the app.

table_finder
------------
```python
table_finder(
    modules: Sequence[str],
    include_tags: Sequence[str] = None,
    exclude_tags: Sequence[str] = None,
    exclude_imported: bool = False,
) -> List[Type[Table]]
```

A utility function to automatically discover and import `Table` subclasses from specified modules. This can be used as an alternative to explicitly registering table classes in an `AppConfig`.

Parameters:
- `modules`: List of module paths (e.g., `['blog.tables']`) to search for `Table` subclasses.
- `include_tags`: Tags to include tables by. The special tag `'__all__'` includes all tables.
- `exclude_tags`: Tags to exclude tables by. This overrides `include_tags`.
- `exclude_imported`: If `True`, only tables defined within the module are included, excluding those imported from elsewhere.

Returns:
- A list of `Table` subclasses found in the specified modules matching the tag criteria.

Command
-------
A dataclass representing a CLI command associated with a Piccolo app.

Attributes:
- `callable`: The function or coroutine to execute.
- `aliases`: Optional list of alternative names for the command.

AppConfig
---------
A dataclass representing the configuration for a Piccolo app. Each app must define an `AppConfig` instance, typically in `piccolo_app.py`.

Attributes:
- `app_name` (str): The name of the app (e.g., `'article'`).
- `migrations_folder_path` (str): Path to the folder containing the app's migration files.
- `table_classes` (List[Type[Table]]): Registered table classes for the app. Used by Piccolo's auto migrations to detect schema changes.
- `migration_dependencies` (List[str]): List of other Piccolo apps whose migrations this app depends on. Their migrations will run first.
- `commands` (List[Union[Callable, Command]]): Functions or coroutines registered as CLI commands for the app.

Methods:
- `register_table(table_class: Type[Table]) -> Type[Table]`: Registers a table class with the app.
- `migration_dependency_app_configs -> List[AppConfig]`: Returns the `AppConfig` instances of the apps listed in `migration_dependencies`.
- `get_table_with_name(table_class_name: str) -> Type[Table]`: Retrieves a registered table class by its class name. Raises `ValueError` if not found.

AppRegistry
-----------
Manages the collection of Piccolo apps in a project. Typically instantiated in `piccolo_conf.py`.

Attributes:
- `apps` (List[str]): List of module paths to Piccolo apps (e.g., `['blog.piccolo_app']`).
- `app_configs` (Dict[str, AppConfig]): A dictionary mapping app names to their `AppConfig` instances.

Usage
-----
- Define an `AppConfig` for each Piccolo app, specifying tables, migrations, and commands.
- Use `table_finder` to automatically discover tables in modules.
- Register apps in an `AppRegistry` to manage them collectively.
- Use migration modules (`MigrationModule`) to define database schema changes.
- Commands registered in `AppConfig` can be invoked via the Piccolo CLI.

This module is essential for organizing Piccolo applications, managing their database tables, migrations, and CLI commands in a structured and scalable way.