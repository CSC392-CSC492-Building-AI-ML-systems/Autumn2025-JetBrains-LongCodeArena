Nonparametric Methods
=====================

Univariate Kernel Density Estimators
------------------------------------

Kernel density estimation (KDE) is a fundamental nonparametric technique to estimate the probability density function of a random variable. Unlike parametric methods, KDE does not assume a specific functional form for the distribution, making it flexible for modeling complex data structures.

References
----------
- Racine, Jeff. (2008) "Nonparametric Econometrics: A Primer," Foundation and Trends in Econometrics: Vol 3: No 1, pp1-88.  
  http://dx.doi.org/10.1561/0800000009

- Silverman, B.W. Density Estimation for Statistics and Data Analysis.

- https://en.wikipedia.org/wiki/Kernel_%28statistics%29

KDEUnivariate Class
-------------------

The `KDEUnivariate` class provides an efficient implementation of univariate kernel density estimation. It is optimized for continuous data and uses FFT-based methods for computational efficiency when applicable.

### Features

- Supports a variety of kernel functions including Gaussian, Epanechnikov, Uniform, Triangular, Biweight, Triweight, and Cosine kernels.
- Bandwidth selection methods include Scott’s rule, Silverman’s rule, normal reference rule, user-specified floats, or custom callable functions.
- Optionally uses FFT for faster computation with the Gaussian kernel.
- Provides methods to compute the estimated density, cumulative distribution function (CDF), survival function, cumulative hazard, and entropy.
- Handles weighted data points.

### Initialization

```python
KDEUnivariate(endog)
```

- `endog` : array_like  
  The one-dimensional data array for which the density estimate is desired.

### Fitting the Model

```python
fit(kernel='gau', bw='normal_reference', fft=True, weights=None, gridsize=None, adjust=1, cut=3, clip=(-np.inf, np.inf))
```

Parameters:

- `kernel` : str  
  Specifies the kernel function to use. Options include:  
  - `"biw"`: Biweight  
  - `"cos"`: Cosine  
  - `"epa"`: Epanechnikov  
  - `"gau"`: Gaussian (default)  
  - `"tri"`: Triangular  
  - `"triw"`: Triweight  
  - `"uni"`: Uniform

- `bw` : str, float, or callable  
  Bandwidth selection method or value. Options:  
  - `"scott"`: Scott’s rule  
  - `"silverman"`: Silverman’s rule  
  - `"normal_reference"`: Normal reference rule (default)  
  - float: User-specified bandwidth  
  - callable: A function that takes the clipped data and kernel instance and returns a bandwidth

- `fft` : bool  
  Whether to use FFT-based computation. Only available for the Gaussian kernel. Default is `True`.

- `weights` : array_like or None  
  Optional weights for the data points.

- `gridsize` : int or None  
  Number of points on the grid where the density is estimated. Defaults to `max(len(endog), 50)`.

- `adjust` : float  
  Adjustment factor for the bandwidth. The effective bandwidth is `bw * adjust`.

- `cut` : float  
  Extends the grid beyond the data range by `cut * bw` to ensure the kernel tails go to zero.

- `clip` : tuple  
  Tuple specifying the lower and upper bounds to clip the data.

Returns:

- The fitted `KDEUnivariate` instance with attributes:
  - `density`: Estimated density values on the support grid.
  - `support`: Grid points where the density is evaluated.
  - `bw`: The bandwidth used.
  - `kernel`: The kernel instance used.

### Example

```python
import numpy as np
import statsmodels.api as sm
import matplotlib.pyplot as plt

nobs = 300
np.random.seed(1234)
data = np.random.normal(size=nobs)

dens = sm.nonparametric.KDEUnivariate(data)
dens.fit()
plt.plot(dens.support, dens.density)
plt.title('Kernel Density Estimate')
plt.show()
```

### Notes

- The cumulative distribution function (`cdf`), survival function (`sf`), cumulative hazard, and entropy are computed based on the kernel definition rather than the FFT approximation, even if FFT is used for fitting.
- The `KDEUnivariate` class is significantly faster than multivariate KDE implementations due to its FFT optimization.
- For multivariate or mixed data types, consider using `KDEMultivariate`.

See Also
--------

- `KDEMultivariate` — Kernel density estimation for multivariate data.
- `kdensity` and `kdensityfft` — Underlying functions for kernel density estimation.

---

This documentation provides an overview of nonparametric kernel density estimation methods implemented in the `KDEUnivariate` class, highlighting its flexibility, efficiency, and usage for univariate continuous data analysis.