w_ntop â€” Select top-weighted walkers from bins
===============================================

Description
-----------

The `w_ntop` command selects walkers from bins based on their weights. It requires an assignment file that maps walkers to bins at each timepoint (see `w_assign --help` for information on generating this file). By default, it selects the highest-weight walkers (hence the name `w_ntop`: select the N top-weighted walkers from each bin). Alternatively, it can select the minimum weight walkers or randomly-selected walkers.

Output Format
-------------

The output file (specified with `-o/--output`, default: `ntop.h5`) contains the following datasets:

- **`/n_iter`** [iteration]  
  *(Integer)* Iteration numbers for each entry in other datasets.

- **`/n_segs`** [iteration][bin]  
  *(Integer)* Number of segments in each bin/state in the given iteration.  
  This will generally be the same as the number requested with `--n/--count` but may be smaller if the requested number of walkers does not exist.

- **`/seg_ids`** [iteration][bin][segment]  
  *(Integer)* Segment IDs matching each bin in each iteration. For an iteration `n_iter`, only the first `n_segs[n_iter]` entries are valid. For example, the full list of matching segment IDs in bin 0 in the first stored iteration is `seg_ids[0][0][:n_segs[0]]`.

- **`/weights`** [iteration][bin][segment]  
  *(Floating-point)* Weights for each matching segment in `/seg_ids`.

Command-line Arguments
----------------------

Input Options
~~~~~~~~~~~~~

- `-a`, `--assignments`  
  Use assignments from the given ASSIGNMENTS file (default: `assign.h5`).

Selection Options
~~~~~~~~~~~~~~~~~

- `-n`, `--count`  
  Select COUNT walkers from each iteration for each bin (default: 1).

- `-t`, `--timepoint`  
  Base selection on the given TIMEPOINT within each iteration. Default (-1) corresponds to the last timepoint.

- `--highweight`  
  Select COUNT highest-weight walkers from each bin (default).

- `--lowweight`  
  Select COUNT lowest-weight walkers from each bin.

- `--random`  
  Select COUNT walkers randomly from each bin.

Output Options
~~~~~~~~~~~~~~

- `-o`, `--output`  
  Write output to OUTPUT (default: `ntop.h5`).

Progress Reporting
------------------

The command provides progress indicators during execution.

Usage Notes
-----------

- The assignment file must contain bin assignments for walkers at each timepoint.
- The number of bins is determined from the assignment file.
- The selection is performed for each iteration in the specified iteration range.
- The output file contains datasets that can be used for further analysis or processing.

Example
-------

```bash
w_ntop -a assign.h5 -n 3 --highweight -o top_walkers.h5
```

Selects the top 3 highest-weight walkers from each bin using assignments in `assign.h5` and writes the output to `top_walkers.h5`.