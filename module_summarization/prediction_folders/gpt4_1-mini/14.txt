Querying
========

The ftrack API provides a powerful and flexible querying system to retrieve entities from the server. Queries allow you to specify criteria to filter and fetch entities such as tasks, assets, projects, and more.

Basic Querying
--------------

To perform a query, you typically use the `Session` object to access the entities and then apply a query string to filter the results. The query string syntax is similar to SQL WHERE clauses, allowing you to specify conditions on entity attributes.

Example:

```python
session = ftrack_api.Session()
tasks = session.query('Task where status is "in progress"')
for task in tasks:
    print(task['name'], task['status'])
```

This example fetches all tasks whose status is "in progress".

Query Syntax
------------

The query language supports a variety of operators and expressions:

- **Comparison operators**: `is`, `is not`, `=`, `!=`, `<`, `>`, `<=`, `>=`
- **Logical operators**: `and`, `or`, `not`
- **Membership operators**: `in`, `not in`
- **String matching**: `like`, `not like`
- **Parentheses** for grouping expressions

You can combine multiple conditions to form complex queries.

Examples:

- Find all assets with a name starting with "Character":

  ```python
  assets = session.query('Asset where name like "Character%"')
  ```

- Find all tasks assigned to a specific user:

  ```python
  tasks = session.query('Task where assigned_to.username is "jdoe"')
  ```

- Find all versions created after a certain date:

  ```python
  versions = session.query('Version where created_at > "2023-01-01T00:00:00Z"')
  ```

Query Results
-------------

The result of a query is a collection of entity objects that match the criteria. These collections are iterable and support lazy loading of attributes.

You can iterate over the results to access individual entities and their attributes.

Example:

```python
for project in session.query('Project'):
    print(project['name'])
```

Performance Considerations
--------------------------

- Queries are executed on the server, so complex queries may take longer to complete.
- Use indexes and appropriate filters to optimize query performance.
- The session supports caching to reduce redundant queries and improve responsiveness.

Advanced Querying
-----------------

- You can query related entities by traversing relationships in the query string.
- Use subqueries and nested conditions to express complex logic.
- The API supports querying custom attributes and plugin-defined entities.

Error Handling
--------------

- Invalid query syntax will raise exceptions.
- Queries that reference non-existent attributes or entities will also raise errors.
- Always handle exceptions when performing queries to ensure robustness.

Summary
-------

The querying system in ftrack API is a core feature that enables efficient retrieval of entities based on flexible criteria. By mastering the query syntax and leveraging the session's capabilities, you can build powerful integrations and tools that interact with your ftrack server data effectively.