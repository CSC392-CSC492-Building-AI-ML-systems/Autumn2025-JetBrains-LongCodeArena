Generate Documentation for the `augmentations` Module
======================================================

Overview
--------

This module provides a standard suite of image augmentations commonly used in automatic augmentation policies such as AutoAugment for ImageNet, RandAugment, and TrivialAugmentWide. The augmentations are implemented using NVIDIA DALI operators, enabling efficient and flexible image transformations.

The augmentations are decorated with the `@augmentation` decorator from `nvidia.dali.auto_aug.core`, which manages the computation of transformation parameters based on a magnitude bin system. Instead of directly specifying parameters, augmentations receive a `magnitude_bin` and `num_magnitude_bins`, which are internally converted to transformation parameters. This design facilitates easy integration with automatic augmentation policies that operate over discrete magnitude bins.

Key Features
------------

- **Parameter Computation:** Parameters for augmentations are computed as if by calling  
  `mag_to_param(magnitudes[magnitude_bin] * ((-1) ** random_sign))`, where  
  `magnitudes = linspace(mag_range[0], mag_range[1], num_magnitude_bins)`.  
  This allows for random negation and scaling of magnitudes within specified ranges.

- **Flexible Parameter Ranges:** Each augmentation defines a default magnitude range and behavior (e.g., random negation). These can be customized by reapplying the `augmentation` decorator with different arguments.

- **DALI Operator Integration:** Augmentations leverage DALI's efficient image processing operators such as `fn.transforms.shear`, `fn.warp_affine`, `fn.rotate`, and `fn.brightness`.

Available Augmentations
-----------------------

### Shear Transformations

- **shear_x(data, shear, fill_value=128, interp_type=None)**  
  Applies a shear transformation along the X-axis.  
  - Magnitude range: 0 to 0.3  
  - Randomly negated magnitude  
  - Parameters: `shear` computed from magnitude bin  
  - Uses `fn.transforms.shear` and `fn.warp_affine`

- **shear_y(data, shear, fill_value=128, interp_type=None)**  
  Applies a shear transformation along the Y-axis.  
  - Magnitude range: 0 to 0.3  
  - Randomly negated magnitude  
  - Parameters: `shear` computed from magnitude bin

### Translation Transformations

- **translate_x(data, rel_offset, shape, fill_value=128, interp_type=None)**  
  Translates the image along the X-axis by a relative offset scaled by image width.  
  - Magnitude range: 0 to 1  
  - Randomly negated magnitude  
  - Requires `shape` to compute absolute offset

- **translate_x_no_shape(data, offset, fill_value=128, interp_type=None)**  
  Translates the image along the X-axis by an absolute offset.  
  - Magnitude range: 0 to 250  
  - Randomly negated magnitude  
  - Does not require image shape

- **translate_y(data, rel_offset, shape, fill_value=128, interp_type=None)**  
  Translates the image along the Y-axis by a relative offset scaled by image height.  
  - Magnitude range: 0 to 1  
  - Randomly negated magnitude

- **translate_y_no_shape(data, offset, fill_value=128, interp_type=None)**  
  Translates the image along the Y-axis by an absolute offset.  
  - Magnitude range: 0 to 250  
  - Randomly negated magnitude

### Rotation

- **rotate(data, angle, fill_value=128, interp_type=None, rotate_keep_size=True)**  
  Rotates the image by a specified angle.  
  - Magnitude range: 0 to 30 degrees  
  - Randomly negated magnitude  
  - Optionally keeps the original image size after rotation

### Brightness, Contrast, and Other Enhancements

The module includes augmentations for brightness, contrast, color, and sharpness enhancements. These use a shifted magnitude range to center the neutral effect at 1.0, with magnitudes varying in [0, 2].

- **brightness(data, parameter)**  
  Adjusts image brightness.  
  - Magnitude range: 0 to 0.9 (shifted and randomly negated to [0.1, 1.9])  
  - Uses `fn.brightness`

- **contrast(data, parameter)**  
  Adjusts image contrast following the PIL implementation, which uses a channel-weighted mean as the contrast center.  
  - Magnitude range: 0 to 0.9 (shifted and randomly negated)  
  - Computes contrast center using RGB weights `[0.299, 0.587, 0.114]`  
  - Uses `fn.reductions.mean` and `fn.reductions.sum` to calculate the center  
  - Applies contrast adjustment relative to the center

Parameter Handling and Decorator Behavior
-----------------------------------------

The `@augmentation` decorator simplifies the creation of augmentations by:

- Defining the magnitude range (`mag_range`) for the augmentation parameter.
- Enabling random negation of the magnitude (`randomly_negate`), which allows symmetric transformations.
- Providing a function (`mag_to_param`) to convert a magnitude value into the actual parameter used by the DALI operator.
- Allowing customization of augmentation names and other metadata.

Example Usage
-------------

To customize an existing augmentation, such as increasing the shear magnitude range for `shear_x` from 0.3 to 0.5, you can redefine it as:

```python
my_shear_x = shear_x.augmentation(mag_range=(0, 0.5))
```

This creates a new augmentation with the adjusted magnitude range while preserving the original implementation.

Notes
-----

- The augmentations expect input data batches and parameters derived from magnitude bins rather than direct parameters.
- Fill values default to 128 for transformations that require filling empty pixels.
- Interpolation types can be specified where applicable.
- The module requires `numpy` and NVIDIA DALI to be installed.

License
-------

This module is licensed under the Apache License, Version 2.0. See the LICENSE file or visit http://www.apache.org/licenses/LICENSE-2.0 for details.