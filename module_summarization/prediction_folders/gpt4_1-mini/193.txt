Metadata Routing API
====================

The Metadata Routing API provides a flexible mechanism to route method calls and parameters dynamically within estimators. It is designed to facilitate meta-estimators that extend the functionality of base estimators by managing method dispatch and parameter handling in a structured way.

Key Components
--------------

- **MetadataRouter**  
  The core class responsible for routing method calls based on metadata. It enables dynamic dispatch of methods to appropriate underlying estimators or components depending on the context and parameters.

- **MethodMapping**  
  A utility that defines mappings between method names and their corresponding implementations or targets. This allows the router to correctly delegate method calls.

- **process_routing**  
  A function that processes routing metadata and applies the routing logic to method calls, ensuring that parameters are correctly forwarded and handled.

- **_raise_for_params**  
  A helper function that raises errors when unexpected or unsupported parameters are passed during routing, ensuring robustness and clear error reporting.

- **_routing_enabled**  
  A flag or function used internally to check whether routing is enabled for a given context or estimator.

Usage
-----

The Metadata Routing API is primarily used internally within meta-estimators to:

- Extend single-output estimators to multi-output estimators by routing calls appropriately.
- Manage method calls such as `fit`, `predict`, and `partial_fit` across multiple underlying estimators.
- Handle parameter validation and forwarding in a consistent manner.
- Enable flexible and dynamic method dispatch based on estimator capabilities and metadata.

By leveraging this API, meta-estimators can maintain clean interfaces while supporting complex behaviors involving multiple sub-estimators.

Example
-------

While the API is mostly used internally, a typical use case involves a meta-estimator that wraps a base estimator and uses the MetadataRouter to delegate method calls:

```python
from sklearn.utils.metadata_routing import MetadataRouter, MethodMapping

class MyMetaEstimator:
    def __init__(self, base_estimator):
        self.base_estimator = base_estimator
        self.router = MetadataRouter(
            method_mapping=MethodMapping({
                "fit": self.base_estimator.fit,
                "predict": self.base_estimator.predict,
            })
        )

    def fit(self, X, y, **params):
        return self.router.route("fit", X, y, **params)

    def predict(self, X, **params):
        return self.router.route("predict", X, **params)
```

This approach abstracts the routing logic and parameter management, allowing the meta-estimator to focus on higher-level functionality.

Notes
-----

- The Metadata Routing API is an advanced feature intended for developers extending the library with custom meta-estimators.
- Proper use of this API requires understanding of estimator interfaces and parameter validation mechanisms.
- It integrates closely with other utility modules such as parameter validation and meta-estimator mixins.

For more details, refer to the source code and examples within the `sklearn.utils.metadata_routing` module.