Isotonic Regression Module
==========================

The isotonic regression module provides tools for performing isotonic regression, a type of regression that fits a non-decreasing (or non-increasing) function to data. This is useful when there is a known order or monotonic relationship between the independent variable and the target.

Functions
---------

check_increasing(x, y)
~~~~~~~~~~~~~~~~~~~~~~

Determine whether `y` is monotonically correlated with `x`.

Parameters
^^^^^^^^^^
- **x** : array-like of shape (n_samples,)
  Training data.

- **y** : array-like of shape (n_samples,)
  Training target.

Returns
^^^^^^^
- **increasing_bool** : boolean
  Whether the relationship is increasing or decreasing.

Notes
^^^^^
The Spearman correlation coefficient is estimated from the data, and the sign of the resulting estimate is used as the result.

If the 95% confidence interval based on Fisher transform spans zero, a warning is raised indicating that the determination of monotonicity may be suspect.

References
^^^^^^^^^^
- Fisher transformation. Wikipedia.
  https://en.wikipedia.org/wiki/Fisher_transformation


isotonic_regression(y, *, sample_weight=None, y_min=None, y_max=None, increasing=True)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Solve the isotonic regression model.

Parameters
^^^^^^^^^^
- **y** : array-like of shape (n_samples,)
  The data to fit.

- **sample_weight** : array-like of shape (n_samples,), default=None
  Weights on each point of the regression. If None, equal weights are assumed.

- **y_min** : float, default=None
  Lower bound on the lowest predicted value. If not set, defaults to -inf.

- **y_max** : float, default=None
  Upper bound on the highest predicted value. If not set, defaults to +inf.

- **increasing** : bool, default=True
  Whether to compute an increasing (True) or decreasing (False) isotonic fit.

Returns
^^^^^^^
- **y_** : ndarray of shape (n_samples,)
  Isotonic fit of `y`.

References
^^^^^^^^^^
- "Active set algorithms for isotonic regression; A unifying framework" by Michael J. Best and Nilotpal Chakravarti, section 3.


Class: IsotonicRegression
-------------------------

Isotonic regression model.

.. versionadded:: 0.13

This estimator fits a non-decreasing or non-increasing function to data, optionally bounded and with configurable behavior for out-of-bounds predictions.

Parameters
^^^^^^^^^^
- **y_min** : float, default=None
  Lower bound on the lowest predicted value. If not set, defaults to -inf.

- **y_max** : float, default=None
  Upper bound on the highest predicted value. If not set, defaults to +inf.

- **increasing** : bool or 'auto', default=True
  Determines whether the predictions should be constrained to increase or decrease with `X`. If set to 'auto', the direction is decided based on the sign of the Spearman correlation estimate between `X` and `y`.

- **out_of_bounds** : {'nan', 'clip', 'raise'}, default='nan'
  Specifies how to handle `X` values outside the training domain during prediction:
  
  - 'nan': predictions will be NaN.
  - 'clip': predictions will be clipped to the nearest training interval endpoint.
  - 'raise': a `ValueError` is raised.

Attributes
^^^^^^^^^^
- **X_min_** : float
  Minimum value of input array `X_` for left bound.

- **X_max_** : float
  Maximum value of input array `X_` for right bound.

- **X_thresholds_** : ndarray of shape (n_thresholds,)
  Unique ascending `X` values used to interpolate the monotonic function.

  .. versionadded:: 0.24

- **y_thresholds_** : ndarray of shape (n_thresholds,)
  Corresponding `y` values at the thresholds defining the isotonic function.

Usage
-----

The isotonic regression model can be used to fit data where a monotonic relationship is expected or desired. It can be used as a regressor or transformer in machine learning pipelines.

Example
-------

```python
from sklearn.isotonic import IsotonicRegression

X = [1, 2, 3, 4, 5]
y = [1, 2, 2, 3, 5]

iso_reg = IsotonicRegression(increasing=True)
iso_reg.fit(X, y)
y_pred = iso_reg.predict(X)
```

This will fit a non-decreasing function to the data points `(X, y)`.

See Also
--------

- :ref:`User Guide <isotonic>` for detailed explanations and examples.

---

This module is part of the scikit-learn library and is licensed under the BSD 3-Clause License.

Authors
-------

- Fabian Pedregosa <fabian@fseoane.net>
- Alexandre Gramfort <alexandre.gramfort@inria.fr>
- Nelle Varoquaux <nelle.varoquaux@gmail.com>