Mixed Linear Effects Models
=============================

Overview
--------

The mixed_linear module provides tools for fitting and analyzing linear mixed effects models, which are regression models designed for dependent data. These models are also known as multilevel or hierarchical linear models and are useful for estimating relationships involving both means and variances across grouped data.

Key Components
--------------

### The MixedLM Class

The core of the module is the `MixedLM` class, which fits linear mixed effects models to data and supports common post-estimation tasks. It is optimized for models where data can be partitioned into independent groups, although it can handle some models with crossed effects by specifying a single group.

### Model Specification

The models assume the following structure for each group `i`:

Y = X * beta + Z * gamma + epsilon

where:

- `Y` is the response vector (endog)
- `X` is the design matrix for fixed effects (exog)
- `beta` is the vector of fixed effects parameters (fe_params)
- `Z` is the design matrix for random effects (exog_re)
- `gamma` is a random vector with mean zero and covariance structure (cov_re)
- `epsilon` is the vector of iid normal errors with variance sigma^2

The model estimates parameters such as fixed effects (`beta`), random effects covariance (`cov_re`), and residual variance (`sigma^2`) using maximum likelihood (ML) or restricted maximum likelihood (REML).

Model Structure and Parameterizations
-------------------------------------

The module supports three parameterizations:

- User Parameterization: cov(endog) = scale * I + Z * cov_re * Z'
- Profile Parameterization: cov(endog) = I + Z * cov_re1 * Z'
- Square Root Parameterization: working with the Cholesky factor of cov_re1

These parameterizations facilitate different stages of estimation and inference, with internal conversions ensuring consistency.

Estimation and Optimization
----------------------------

The module employs generalized least squares (GLS) for numerical optimization, profiling over fixed effects and scale parameters. It implements score methods for inference on covariance parameters and avoids explicit Hessian calculations, making it suitable for models where the likelihood is profiled over certain parameters.

References
----------

The implementation is based on the methodology described in Lindstrom and Bates (1988), with adaptations for variance components. Additional resources include user-focused documents and technical papers providing further insights into mixed effects modeling.

Usage
-----

The module is designed for users familiar with statistical modeling and provides a flexible interface for specifying and fitting complex hierarchical models, with support for variance components and crossed random effects.

Note
----

The module emphasizes efficiency and robustness in estimation, with internal handling of different parameterizations and optimization strategies to accommodate various modeling scenarios.