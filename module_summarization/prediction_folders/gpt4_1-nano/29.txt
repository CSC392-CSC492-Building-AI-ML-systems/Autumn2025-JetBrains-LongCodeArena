w_ntop
=======

Overview
--------

The `w_ntop` command is a tool for selecting walkers from bins based on their weights or randomly, using an assignment file that maps walkers to bins at each timepoint. It allows users to extract a specified number of walkers per bin, with options to select the highest-weighted, lowest-weighted, or randomly chosen walkers.

Features
--------

- Selects a specified number of walkers (`--count`) from each bin at each iteration.
- Supports selection based on different criteria:
  - Highest weights (`--highweight`)
  - Lowest weights (`--lowweight`)
  - Random selection (`--random`)
- Operates on assignment files (`assign.h5` by default) that contain bin assignments for walkers.
- Outputs data including iteration numbers, number of segments per bin, matching segment IDs, and their weights.

Output Format
-------------

The output file (default: `ntop.h5`) contains the following datasets:

- `/n_iter` [integer]: Iteration numbers corresponding to each set of selected walkers.
- `/n_segs` [integer]: Number of segments in each bin for each iteration.
- `/seg_ids` [integer]: Segment IDs of the selected walkers, organized by iteration, bin, and count.
- `/weights` [float]: Weights associated with each selected segment.

Command-line Options
--------------------

- `-a`, `--assignments`: Specify the assignments file (default: `assign.h5`).
- `-n`, `--count`: Number of walkers to select per bin (default: 1).
- `-t`, `--timepoint`: Timepoint within each iteration to base selection on (default: last timepoint).
- Selection criteria (mutually exclusive):
  - `--highweight`: Select top-weighted walkers.
  - `--lowweight`: Select lowest-weighted walkers.
  - `--random`: Select walkers randomly.
- `-o`, `--output`: Output filename (default: `ntop.h5`).

Usage
-----

The `w_ntop` command reads assignment data and walker weights, then processes the specified range of iterations and timepoints to select walkers according to the chosen criteria. The selected walkers' segment IDs and weights are saved in the output file for further analysis.

Notes
-----

- The command requires an assignment file that maps walkers to bins at each timepoint.
- The selection process can be customized via command-line options to suit different analysis needs.
- Efficient chunking and compression are used for output datasets to handle large data efficiently.