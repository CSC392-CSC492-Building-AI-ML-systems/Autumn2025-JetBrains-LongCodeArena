w_select
========

Description
-----------
The `w_select` command is a tool for selecting dynamics segments from a WESTPA simulation based on user-defined criteria. It allows users to specify a predicate function that determines which segments are selected in each iteration. The command can include segments that match the predicate as well as their ancestors if desired.

Features
--------
- Select segments matching a custom predicate function.
- Invert selection with the `-v/--invert` option.
- Include ancestors of matched segments with the `-a/--include-ancestors` option.
- Output the selected segments, their weights, and related data to an HDF5 file.

Predicate Function
------------------
Segments are selected based on a predicate function specified by the user. This function must be callable as:

```python
predicate(n_iter, iter_group)
```

where `n_iter` is the iteration number, and `iter_group` is the HDF5 group corresponding to that iteration. The function should return a sequence of segment IDs that match the criteria.

Command-line Arguments
----------------------
- `-p`, `--predicate-function`: Specify the module and function name for the predicate function.
- `-v`, `--invert`: Invert the predicate match.
- `-a`, `--include-ancestors`: Include ancestors of matched segments in the output.
- `-o`, `--output`: Output filename (default: `select.h5`).

Output Format
-------------
The output HDF5 file contains the following datasets:

- `/n_iter`: Integer array of iteration numbers.
- `/n_segs`: Integer array indicating the number of matching segments per iteration.
- `/seg_ids`: Variable-length array of segment IDs for each iteration.
- `/weights`: Floating-point array of weights for each matching segment.

Usage
-----
Configure the predicate function and options via command-line arguments, then run `w_select` to generate an HDF5 file containing the selected segments and their associated data.