Markov Chain Monte Carlo (MCMC) Framework
===========================================

Overview
--------
This framework provides tools for equilibrium sampling from a specified thermodynamic state of a biomolecule using various Markov chain Monte Carlo (MCMC) methods. It supports multiple move types, including Langevin dynamics, hybrid Monte Carlo, generalized hybrid Monte Carlo, and Monte Carlo barostat moves. These moves can be combined flexibly through sequence or weighted schemes to enhance sampling efficiency.

Supported Moves
---------------
- Langevin Dynamics (assumed to be free of integration error; use at your own risk)
- Hybrid Monte Carlo (HMC)
- Generalized Hybrid Monte Carlo (GHMC)
- Monte Carlo Barostat Moves

Configuration and Usage
-----------------------
The framework defaults to utilizing the fastest available OpenMM platform with a shared global ContextCache, minimizing the overhead of creating simulation contexts. Users can customize the platform and cache settings to optimize performance for their specific systems.

Example Workflow
----------------
1. Initialize the system and states:
   - Create a biomolecular system (e.g., alanine dipeptide in vacuum).
   - Define the thermodynamic state with temperature and system parameters.
   - Set the initial sampler state with positions and other relevant data.

2. Define MCMC moves:
   - Instantiate move objects such as GHMCMove, LangevinDynamicsMove, etc.
   - Combine moves into sequences or assign weights for stochastic selection.

3. Configure caching:
   - Use the global context cache for efficiency.
   - Alternatively, create local caches or dummy caches if needed.

4. Run the simulation:
   - Minimize the system if necessary.
   - Execute the run for a specified number of iterations.

Classes and Interfaces
----------------------
### MCMCMove (Abstract Base Class)
Defines the interface for all MCMC move implementations.

- `apply(thermodynamic_state, sampler_state)`: Apply the move, potentially modifying the states.
- Keeps internal statistics such as move attempts and acceptance rates.

### MCMCSampler
Manages the execution of the MCMC simulation.

- **Attributes:**
  - `thermodynamic_state`: Current thermodynamic state.
  - `sampler_state`: Current sampler state.
  - `move_set`: Collection of moves to attempt each iteration.

- **Methods:**
  - `minimize()`: Performs energy minimization before sampling.
  - `run(n_iterations)`: Executes the MCMC sampling for the specified number of iterations.

Customization
-------------
Users can tailor the caching strategy:
- Use the global context cache for shared, efficient context management.
- Create local context caches with specific capacities and time-to-live settings.
- Use dummy caches to create a new context for each move without caching.

References
----------
- Jun S. Liu. Monte Carlo Strategies in Scientific Computing. Springer, 2008.

This framework facilitates flexible and efficient MCMC simulations, enabling detailed control over move types, caching strategies, and sampling protocols to suit diverse biomolecular simulation needs.