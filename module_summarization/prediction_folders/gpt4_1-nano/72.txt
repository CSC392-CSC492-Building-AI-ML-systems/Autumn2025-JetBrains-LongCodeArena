Metrics Module Documentation
=============================

Overview
--------
This module provides utility functions for validating, processing, and managing data arrays used in distance computations and other metric-related operations. It ensures input data integrity, compatibility, and proper formatting for various algorithms and distance measures.

Functions
---------
### _return_float_dtype(X, Y)
Determines the appropriate floating-point data type for input arrays X and Y.
- Returns X, Y, and the selected dtype (float32 if both are float32, otherwise float).

### check_pairwise_arrays(
    X,
    Y,
    *,
    precomputed=False,
    dtype=None,
    accept_sparse="csr",
    force_all_finite=True,
    copy=False
)
----------
Validates and prepares input arrays X and Y for pairwise distance computations.
- Ensures arrays are numpy arrays or sparse matrices.
- Checks that arrays are at least two-dimensional.
- Validates data types, converting to float if necessary.
- Checks shape compatibility:
  - For precomputed matrices, verifies shape (n_queries, n_indexed).
  - For feature matrices, verifies matching feature dimensions.
- Returns processed arrays safe_X and safe_Y.

Parameters:
- X: array-like or sparse matrix of shape (n_samples_X, n_features)
- Y: array-like or sparse matrix of shape (n_samples_Y, n_features)
- precomputed: bool, indicates if X is a precomputed distance matrix.
- dtype: data type for arrays; if None, determined automatically.
- accept_sparse: allowed sparse matrix formats.
- force_all_finite: whether to enforce finite values.
- copy: whether to copy data during processing.

Returns:
- safe_X: validated array or sparse matrix, guaranteed to be a numpy array.
- safe_Y: validated array or sparse matrix, or pointer to X if Y is None.

### check_paired_arrays(X, Y)
-----------------------------
Validates and prepares paired arrays for distance computations involving paired data.
- Ensures arrays are numpy arrays or sparse matrices.
- Checks for at least two dimensions.
- Validates data types and shape compatibility for paired data.

Usage
-----
Use these functions prior to distance calculations or other metric operations to ensure data integrity and compatibility, preventing runtime errors and ensuring accurate computations.

Notes
-----
- These utilities handle sparse and dense data formats.
- They enforce data quality by checking for infinite or NaN values.
- They facilitate consistent data preprocessing across different metric functions.

Dependencies
------------
- numpy
- scipy.sparse
- scipy.spatial.distance
- joblib
- scikit-learn utils and exceptions

This module is essential for preparing data in metric and distance-based algorithms, ensuring robustness and correctness in computations.