w_red
=====

The `w_red` command provides functions to calculate and analyze rate constants from simulation data, with options for red-correction based on duration histograms.

Functions
---------

**DurationCorrector**

- `from_kinetics_file(directh5, istate, fstate, dtau, n_iters=None)`: Creates a `DurationCorrector` instance from kinetics data stored in an HDF5 file or group, filtering durations based on initial and final states.

- `correction(iters, freqs=None)`: Computes the correction factor for a set of iterations, accounting for duration-dependent effects. Returns a scalar correction value.

- `event_duration_histogram`: Property that returns the histogram of event durations (`f_tilde`).

- `cumulative_event_duration_histogram`: Property that returns the integrated histogram (`f_int1`).

**Rate Calculation**

- `get_raw_rates(directh5, istate, fstate, n_iters=None)`: Retrieves raw expected rate values for specified states and iterations.

- `calc_avg_rate(directh5_path, istate, fstate, **kwargs)`: Calculates the average rate constant, optionally applying red-correction. Accepts parameters such as:
  - `n_iters`: Number of iterations to consider.
  - `report_interval`: Interval between reports (default: 20).
  - `n_steps_iter`: Number of steps per iteration (default: 1000).
  - `callback`: Optional callback function invoked with correction data.
  - `red`: Boolean flag to apply red-correction.

- `calc_rates(directh5_path, istate, fstate, **kwargs)`: Computes both raw and red-corrected rate constants across iterations efficiently.

Usage
-----

Use these functions to analyze simulation data stored in HDF5 format, obtaining corrected rate constants and histograms for kinetic analysis. The `calc_avg_rate` function is particularly useful for obtaining a single, corrected rate estimate, while `calc_rates` provides a detailed iteration-wise rate profile.