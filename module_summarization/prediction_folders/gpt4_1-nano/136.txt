Image Extraction
==================

The image extraction module provides algorithms to process waveforms from camera pixels and extract meaningful charge and timing information. These algorithms are designed to reduce the waveform data to a single charge value per pixel, facilitating subsequent analysis steps such as image parameterization and event reconstruction.

Available Extraction Algorithms
-----------------------------

- **Charge Extraction Algorithms**
  - `FullWaveformSum`: Sums all samples in the waveform to compute the total charge.
  - `FixedWindowSum`: Integrates waveform samples within a fixed window.
  - `GlobalPeakWindowSum`: Uses the global maximum to define the integration window.
  - `LocalPeakWindowSum`: Uses local peaks for window positioning.
  - `SlidingWindowMaxSum`: Finds the maximum sum over a sliding window.
  - `NeighborPeakWindowSum`: Considers neighboring pixels for peak detection.
  - `BaselineSubtractedNeighborPeakWindowSum`: Subtracts baseline before neighbor peak summation.
  - `TwoPassWindowSum`: Performs a two-pass summation for improved accuracy.

- **Extraction Functions**
  - `extract_around_peak`: Extracts charge and timing around a specified peak index with a defined window width and shift.
  - `extract_sliding_window`: Finds the maximum sum over a sliding window and computes the corresponding timing.

Core Functions and Methods
--------------------------

### `extract_around_peak`

Performs summation of waveform samples within a window centered around a peak index, with adjustable width and shift. It also calculates the pulse time as a weighted average of the samples within the window, providing a precise timing estimate in nanoseconds.

**Parameters:**
- `waveforms`: Array of waveform samples, shape `(n_pix, n_samples)`.
- `peak_index`: Peak position indices per pixel.
- `width`: Integration window size.
- `shift`: Offset applied to the peak index to define the window start.
- `sampling_rate_ghz`: Camera sampling rate in GHz.

**Returns:**
- `charge`: Total charge within the window.
- `peak_time`: Estimated pulse time in nanoseconds.

### `extract_sliding_window`

Identifies the window with the maximum sum of samples across the waveform, then computes the pulse time as a weighted average within that window. This method is useful for detecting the most significant signal region in the waveform.

**Parameters:**
- `waveforms`: Array of waveform samples, shape `(n_pix, n_samples)`.
- `width`: Size of the sliding window.
- `sampling_rate_ghz`: Camera sampling rate in GHz.

**Returns:**
- `charge`: Total charge within the maximum sum window.
- `peak_time`: Estimated pulse time in nanoseconds.

Implementation Details
----------------------

- The algorithms utilize Numba's `guvectorize` and `njit` decorators for performance optimization.
- Summation and timing calculations are performed efficiently using cumulative sums and weighted averages.
- The functions handle waveform data in a vectorized manner, enabling processing of multiple pixels simultaneously.

Usage
-----

These extraction algorithms are integrated into the camera data processing pipeline and can be configured or extended as needed. They serve as fundamental building blocks for analyzing Cherenkov telescope camera images, enabling accurate charge and timing extraction essential for event reconstruction.

