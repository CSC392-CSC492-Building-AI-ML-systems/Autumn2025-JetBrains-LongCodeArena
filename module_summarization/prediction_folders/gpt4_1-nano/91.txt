rand_augment
============

The `rand_augment` function applies the RandAugment augmentation scheme to a batch of images or videos. This method introduces random transformations to enhance the diversity of training data, following the approach described in https://arxiv.org/abs/1909.13719.

Overview
--------

This function takes a batch of data and applies a specified number of random augmentation operations, each with a given magnitude. It supports various transformation parameters, including shape-dependent magnitudes, translation limits, interpolation methods, and exclusion of specific augmentations.

Arguments
---------

- **data** (`DataNode`):  
  A batch of samples to be processed. Supported data types are images with `HWC` layout and videos with `FHWC` layout, with data type `uint8`.

- **n** (`int`):  
  The number of random augmentation operations to apply to each sample.

- **m** (`int`):  
  The magnitude (strength) of each operation, specified as an integer within `[0, num_magnitude_bins - 1]`.

- **num_magnitude_bins** (`int`, optional):  
  The number of bins dividing the magnitude range. Default is 31.

- **shape** (`Union[DataNode, Tuple[int, int]]`, optional):  
  The size (height and width) of the input images or video frames. If provided, the magnitude of translation operations depends on this shape.

- **fill_value** (`int`, optional):  
  The padding value used during warp transformations. Defaults to 128.

- **interp_type** (`types.DALIInterpType`, optional):  
  The interpolation method used during warp operations. Supported values are `types.INTERP_LINEAR` (default) and `types.INTERP_NN`.

- **max_translate_abs** (`Union[int, Tuple[int, int]]`, optional):  
  The maximum absolute translation in pixels when shape is not specified. Defaults to 100.

- **max_translate_rel** (`Union[float, Tuple[float, float]]`, optional):  
  The maximum relative translation as a fraction of shape dimensions when shape is provided. Defaults to approximately 0.45.

- **seed** (`int`, optional):  
  Seed for random number generation to ensure reproducibility.

- **monotonic_mag** (`bool`, optional):  
  If `True`, the strength of operations increases with the magnitude bin. If `False`, some operations have non-monotonic strength behavior.

- **excluded** (`List[str]`, optional):  
  A list of augmentation operation names to exclude from the default augmentation suite.

Returns
-------

- **DataNode**:  
  A batch of augmented samples with transformations applied as specified.

Details
-------

The function constructs a suite of augmentation operations based on the `monotonic_mag` flag and other parameters. It then filters out any excluded operations and applies a randomly selected subset of augmentations to each sample in the batch.

Usage
-----

This function is suitable for data augmentation in training pipelines, especially for image and video datasets, to improve model robustness by increasing data variability.

See Also
--------

- `get_rand_augment_suite`: Retrieves the default suite of augmentations.
- `get_rand_augment_non_monotonic_suite`: Retrieves a non-monotonic suite of augmentations.
- `apply_rand_augment`: Applies a list of augmentations to data.

Note
----

Ensure that the `nvidia.dali` library and its submodules are properly installed and configured to use this function effectively.