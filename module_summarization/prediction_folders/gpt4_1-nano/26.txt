w_kinavg
==========

Command-line interface for calculating average rates and associated errors from weighted ensemble data.

Description
-----------

The `w_kinavg` command performs analysis to compute average rates, total fluxes, and conditional fluxes based on pre-generated bin assignments and kinetics data files. It supports both standard and trace modes, providing detailed statistical information such as confidence intervals and correlation lengths.

Usage
-----

```bash
w_kinavg [subcommand] [options]
```

Subcommands
-----------

- `trace`: Performs path-tracing kinetics analysis, generating datasets related to state-to-state rates, fluxes, and their evolution over specified windows.

Output Files
------------

The primary output is an HDF5 file (default: `kinavg.h5`) containing datasets with the following information:

- `/avg_rates`: State-to-state average rates over the entire selected window.
- `/avg_total_fluxes`: Total fluxes into each state.
- `/avg_conditional_fluxes`: State-to-state fluxes conditioned on the current state.

If `--evolution-mode` is specified, additional datasets are generated:

- `/rate_evolution`: Rates computed over windows of varying widths.
- `/target_flux_evolution`: Total fluxes into macro states over evolving windows.
- `/conditional_flux_evolution`: State-to-state fluxes over evolving windows.

Dataset Structure
-----------------

Each dataset includes:

- `iter_start`: Starting iteration of the window.
- `iter_stop`: Ending iteration of the window.
- `expected`: Mean rate within the window.
- `ci_lbound`: Lower bound of the confidence interval.
- `ci_ubound`: Upper bound of the confidence interval.
- `corr_len`: Correlation length within the window.

Attributes associated with datasets:

- `mcbs_alpha`: Confidence interval alpha value (e.g., 0.05 for 95% CI).
- `mcbs_nsets`: Number of bootstrap datasets used.
- `mcbs_acalpha`: Alpha value for correlation length determination.

Options
-------

The command-line options allow customization of the analysis, including specifying the input kinetics file (`--kinetics-file`), output file (`--output`), and parameters for evolution mode (`--evolution-mode`, `--start-iter`, `--step-iter`).

Note
----

`w_kinavg` is a wrapper around the core analysis functionality, providing a user-friendly interface for kinetic rate analysis in weighted ensemble simulations. It is recommended to consult the help (`w_kinavg --help`) for detailed options and usage examples.