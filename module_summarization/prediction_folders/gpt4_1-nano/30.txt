w_pdist
========

Calculate time-resolved, multi-dimensional probability distributions of WE datasets.

Description
-----------
The `w_pdist` command computes probability distributions from weighted ensemble (WE) simulation datasets. It supports flexible data input sources, customizable histogram binning, and parallel processing capabilities.

Source Data
-----------
Source data can be provided either via a user-defined function (`--construct-dataset`) or a list of dataset specifications (`--dsspecs`). If neither is specified, the default dataset `pcoord` from the main WEST HDF5 file (`west.h5`) is used.

- **Custom Function**: Specify a Python function in `MODULE.FUNCTION` syntax. This function is called as `function(n_iter, iter_group)` and must return data indexable as `[segment][timepoint][dimension]`.
- **Dataset Specifications**: List datasets with optional file and slice parameters, formatted as `NAME[,file=FILENAME,slice=SLICE]`. This allows selecting specific datasets and slices within HDF5 files.

Histogram Binning
-----------------
Histograms are constructed with configurable bins:

- **Default**: 100 bins per dimension.
- **Number of Bins**: Use `-b/--bins` with:
  - A single integer `N` for uniform bins in all dimensions.
  - A comma-separated list `N1,N2,...` for per-dimension bins.
  - A list of lists `[[B11, B12,...], [B21, B22,...], ...]` for explicit bin boundaries per dimension.

Explicit bin boundaries avoid expensive data scans and can be specified using Python expressions evaluated with `eval`.

Output Format
-------------
The output is stored in an HDF5 file (default `pdist.h5`) containing:

- **`histograms`**: Normalized histograms with axes for iterations and dataset dimensions.
- **`/binbounds_0`, `/binbounds_1`, ...**: Bin boundaries for each dimension.
- **`/midpoints_0`, `/midpoints_1`, ...**: Bin midpoints for each dimension.
- **`n_iter`**: Vector of iteration numbers corresponding to histograms.

Subsequent processing with tools like `plothist` can generate visualizations or further data analysis.

Parallelization
---------------
`w_pdist` supports parallel processing, including data reading and histogram computation. Parallel execution is enabled by default, but serial processing (`--serial`) can be used for simpler or smaller datasets to improve efficiency.

Command-line Options
--------------------
Refer to the command-line options documentation for detailed configuration parameters, including dataset sources, binning options, output file specification, and parallelization controls.