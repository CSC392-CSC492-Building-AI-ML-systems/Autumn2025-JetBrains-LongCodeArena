How to Generate Pydantic Models from Tortoise Models
======================================================

Tortoise ORM provides a convenient way to generate Pydantic models directly from your Tortoise models. This allows for seamless data validation, serialization, and API schema generation based on your database models.

Using `pydantic_model_creator`
------------------------------

The primary function for generating Pydantic models is `pydantic_model_creator`. It creates a Pydantic model class based on a specified Tortoise model.

```python
pydantic_model_creator(
    cls: Type[Model],
    *,
    name: Optional[str] = None,
    exclude: Tuple[str, ...] = (),
    include: Tuple[str, ...] = (),
    computed: Tuple[str, ...] = (),
    allow_cycles: Optional[bool] = None,
    sort_alphabetically: Optional[bool] = None,
    _stack: Tuple = (),
    exclude_readonly: bool = False,
) -> Type[PydanticModel]
```

Parameters:
- `cls`: The Tortoise ORM model class to generate the Pydantic model from.
- `name`: Optional custom name for the generated Pydantic model.
- `exclude`: Tuple of field names to exclude from the model.
- `include`: Tuple of field names to include in the model.
- `computed`: Tuple of computed fields to include.
- `allow_cycles`: Whether to allow cyclic references in the model (useful for recursive models).
- `sort_alphabetically`: If set to `True`, fields will be sorted alphabetically.
- `_stack`: Internal parameter used for recursion tracking.
- `exclude_readonly`: If `True`, readonly fields will be excluded.

Example Usage:
```python
from myapp.models import MyModel
from tortoise.contrib.pydantic import pydantic_model_creator

# Generate a Pydantic model for MyModel
MyModel_Pydantic = pydantic_model_creator(MyModel)
```

Configuring Model Generation with `PydanticMeta`
--------------------------------------------------

You can customize the behavior of Pydantic model generation by defining a nested `PydanticMeta` class inside your Tortoise model:

```python
class MyModel(Model):
    # model fields...

    class PydanticMeta:
        exclude = ("field_to_exclude",)
        computed = ("computed_field",)
        include = ("field1", "field2")
        max_recursion = 5
        backward_relations = False
        exclude_raw_fields = True
        sort_alphabetically = True
```

Available options:
- `exclude`: Fields to exclude from the generated Pydantic model.
- `computed`: Fields that are computed and should be included.
- `include`: Fields to explicitly include.
- `max_recursion`: Maximum recursion depth for nested models.
- `backward_relations`: Whether to include backward relations without annotations.
- `exclude_raw_fields`: Exclude raw relation fields ending with `_id`.
- `sort_alphabetically`: Sort fields alphabetically in the generated model.

Handling Recursion and Cycles
-----------------------------

The model generator includes mechanisms to handle recursive relationships and cyclic references. The `_pydantic_recursion_protector` function ensures that models do not infinitely recurse by respecting the `max_recursion` setting and the `allow_cycles` flag.

This allows for safe generation of models even in complex relational schemas, with control over recursion depth and cycle allowance.

Summary
-------

By leveraging `pydantic_model_creator` and configuring `PydanticMeta`, developers can efficiently generate Pydantic models from Tortoise ORM models, facilitating data validation, serialization, and API schema creation with minimal boilerplate.
