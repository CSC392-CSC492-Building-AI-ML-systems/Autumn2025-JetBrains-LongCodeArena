Cubes Module
============

Overview
--------
The `cubes` module provides tools for working with 3D data cubes, including functionalities for extracting, manipulating, and visualizing spectral and spatial data. It is designed to facilitate interactive analysis and plotting of cube data, integrating with visualization libraries such as Matplotlib and APLpy.

Classes
-------
MapPlotter
~~~~~~~~~~
A class to create interactive plots of data cubes, allowing users to visualize spatial maps, connect plots to spectra, and perform interactive analysis.

Initialization
--------------
`MapPlotter(Cube=None, figure=None, doplot=False, **kwargs)`
- Creates a new map plotter instance.
- Parameters:
  - `Cube`: The data cube to visualize.
  - `figure`: Matplotlib figure or figure number to use.
  - `doplot`: If True, automatically generates the plot upon initialization.
  - `**kwargs`: Additional keyword arguments for customization.

Methods
-------
mapplot(convention='calabretta', colorbar=True, useaplpy=True, vmin=None, vmax=None, cmap=None, plotkwargs={}, **kwargs)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- Generates a spatial map of the cube data.
- Parameters:
  - `convention`: Projection convention ('calabretta' or 'griesen').
  - `colorbar`: Boolean to display a colorbar.
  - `useaplpy`: Use APLpy for plotting if available.
  - `vmin`, `vmax`: Data value limits for color scaling.
  - `cmap`: Colormap for visualization.
  - `plotkwargs`: Additional keyword arguments for plotting functions.
  - `**kwargs`: Other options, including estimator for data reduction.

Private Methods
---------------
`_connect()`
- Connects mouse and keyboard events for interactive plotting.

`_disconnect()`
- Disconnects event handlers to disable interactivity.

Usage
-----
The `MapPlotter` class enables users to create interactive spatial maps from cube data, allowing for pixel selection, spectrum plotting, and region averaging through mouse clicks and key presses. It integrates with APLpy when available for high-quality publication plots and falls back to Matplotlib's imshow for basic visualization.

Dependencies
------------
- `matplotlib`: For plotting and figure management.
- `numpy`: For numerical operations.
- `astropy.wcs` and `astropy.io.fits`: For handling WCS information and FITS files.
- `aplpy`: Optional, for advanced FITS visualization.
- `cubes`: The module itself, providing auxiliary functions such as header flattening.

Note
----
This module is primarily intended for interactive analysis and visualization of spectral cubes. It is not optimized for publication-quality plots but can leverage APLpy for high-quality outputs when available.

Authors and Date
----------------
- Author: Adam Ginsburg
- Date: 03/17/2011