# Executing Notebooks

The execution of notebooks is facilitated through the `ExecutePreprocessor` class, which inherits from both `Preprocessor` and `NotebookClient`. This class allows for executing all code cells within a notebook, managing kernel resources, and updating cell outputs accordingly.

## `ExecutePreprocessor` Class

### Initialization
- The `__init__` method initializes the preprocessor with optional parameters, including the notebook object (`nb`). If no notebook is provided, an empty `NotebookNode` is created.
- It inherits initialization from both `Preprocessor` and `NotebookClient`, ensuring proper setup for notebook execution.

### Preprocessing Notebooks
- The `preprocess` method executes all code cells in the provided notebook (`nb`).
- It optionally accepts a resources dictionary and a `KernelManager` instance.
- The method resets execution trackers, sets up the kernel, and executes each cell sequentially.
- Metadata such as language information is updated based on kernel responses.
- The input notebook is modified in-place, and the method returns the executed notebook along with any additional resources.

### Cell Processing
- The `preprocess_cell` method can be overridden to apply custom preprocessing to each cell.
- By default, it executes the cell using the `execute_cell` method, storing execution history and outputs.

## Deprecated Function
- The `executenb` function is deprecated and redirects to `nbclient.execute`. It issues a warning advising users to import `execute` directly from `nbclient`.

## Supporting Preprocessors

### `HighlightMagicsPreprocessor`
- Detects code cells that use magic extensions for different languages, such as `%%R`, `%%bash`, `%%julia`, etc.
- Maintains a dictionary of default language extensions and allows user customization.
- Uses regular expressions to identify magic language extensions in cell sources.
- Tags cells with the detected language in their metadata (`magics_language`), enabling appropriate syntax highlighting during rendering.

This suite of preprocessors provides robust tools for executing notebooks programmatically and managing multi-language code cells, ensuring seamless notebook processing workflows.