Mixed Effects Models
====================

Introduction
------------
Generalized Linear Mixed Effects Models (GLMMs) extend generalized linear models by incorporating random effects to account for correlation and variability within grouped data. They are widely used in various fields such as biostatistics, social sciences, and ecology to model complex data structures with hierarchical or clustered observations.

Model Specification
-------------------
The joint density of data and parameters in GLMMs factors as:

.. math::

    p(y | vc, fep) \times p(vc | vcp) \times p(vcp) \times p(fe)

where:
- :math:`p(y | vc, fep)` is the likelihood of the data given fixed effects (:math:`fep`) and random effects (:math:`vc`).
- :math:`p(vc | vcp)` is the distribution of random effects conditioned on variance parameters (:math:`vcp`).
- :math:`p(vcp)` and :math:`p(fe)` are prior distributions for variance parameters and fixed effects, respectively.

Random Effects
--------------
Random effects are modeled as mutually independent Gaussian variables with mean zero. The design matrix `exog_vc` specifies the random effects structure, with each column representing an independent realization. The standard deviations of these effects are constrained to be equal within subsets defined by the `ident` array or formulas, allowing for grouped variance components.

Prior Distributions
-------------------
- Variance component parameters (`vcp`) have log-normal priors with mean zero and standard deviation `vcp_p`.
- Fixed effects parameters (`fep`) have Gaussian priors with mean zero and standard deviation `fe_p`.

Estimation Approaches
---------------------
Two Bayesian estimation methods are supported:
- **Laplace approximation (`fit_map`)**: Provides a mode-based estimate of the posterior distribution.
- **Variational Bayes (`fit_vb`)**: Approximates the posterior using a mean-field approach, offering a scalable alternative.

Implementation Details
----------------------
- The model assumes all realizations of random effects are mutually independent.
- The `exog_vc` matrix can be sparse, facilitating efficient modeling of high-dimensional random effects.
- The implementation supports families without additional scale or shape parameters, such as binomial and Poisson.

Usage
-----
To fit a GLMM, specify the response variable, fixed effects covariates, random effects covariates, and other parameters such as priors and family. The result is a `MixedGLMResults` object containing estimates of fixed effects, random effects realizations, and variance components.

References
----------
- Introduction to generalized linear mixed models:
  https://stats.idre.ucla.edu/other/mult-pkg/introduction-to-generalized-linear-mixed-models

- SAS documentation:
  https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_intromix_a0000000215.htm

- An assessment of estimation methods for generalized linear mixed models with binary outcomes:
  https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3866838/
