w_assign
========

Command to assign walkers to bins and generate an output file for subsequent analysis.

Description
-----------
The `w_assign` command assigns walkers (segments) to spatial or kinetic bins based on progress coordinates or other specified datasets. It produces an HDF5 file (default name: "assign.h5") containing detailed assignment information, which is essential for analyzing trajectory data and performing kinetic or other statistical analyses.

Key Features
------------
- Assigns each segment at each timepoint to a bin.
- Supports custom source data through user-defined functions or dataset specifications.
- Allows defining macrostates based on bins, either via command-line arguments, YAML files, or user functions.
- Produces comprehensive output datasets including assignments, population labels, and metadata.

Source Data
-----------
The source data for assignment can be specified in two ways:
- By providing a Python function (`--construct-dataset`) in MODULE.FUNCTION format, which is called as `function(n_iter, iter_group)` and must return indexable data.
- By listing dataset specifications (`--dsspecs`), each formatted as `NAME[,file=FILENAME,slice=SLICE]`, indicating the dataset name, optional file, and optional slice.

Macrostate Specification
------------------------
Macrosates can be defined in three ways:
1. Single bins via `--states` with coordinate tuples and optional labels.
2. Multiple bins via a YAML file specified with `--states-from-file`.
3. Arbitrary states via a user-defined function (`--states-from-function=MODULE.FUNCTION`) that returns state definitions based on bin coordinates.

Output Format
-------------
The output HDF5 file contains the following attributes and datasets:

- `nbins` (Integer): Total number of valid bins.
- `nstates` (Integer): Number of defined macrostates.
- `/assignments` [iteration][segment][timepoint]: Integer dataset indicating bin assignments.
- `/npts` [iteration]: Number of timepoints per iteration.
- `/nsegs` [iteration]: Number of segments per iteration.
- `/labeled_populations` [iterations][state][bin]: Floating-point dataset with bin populations labeled by the most recent macrostate.
- `/bin_labels` [bin]: Labels for each bin.

Usage
-----
The `w_assign` command is used to process trajectory data, assign segments to bins, and generate datasets necessary for kinetic and other analyses. It ensures that all segments are assigned consistently across iterations, facilitating accurate trajectory tracing and statistical evaluation.

Note
----
For detailed options and configuration, refer to the command-line help or the full documentation.