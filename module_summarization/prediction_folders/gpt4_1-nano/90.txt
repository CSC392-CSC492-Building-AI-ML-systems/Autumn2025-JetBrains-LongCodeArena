auto_augment
============

The `auto_augment` module provides functions to apply AutoAugment policies to image and video data, enhancing data augmentation strategies for training machine learning models.

Overview
--------

This module implements the application of predefined AutoAugment policies, as described in the paper "AutoAugment: Learning Augmentation Strategies from Data" (https://arxiv.org/abs/1805.09501). It supports various policies tailored for different datasets and tasks, such as ImageNet, SVHN, and CIFAR-10.

Functions
---------

auto_augment
------------

```python
auto_augment(
    data: DataNode,
    policy_name: str = 'image_net',
    shape: Optional[Union[DataNode, Tuple[int, int]]] = None,
    fill_value: Optional[int] = 128,
    interp_type: Optional[types.DALIInterpType] = None,
    max_translate_abs: Optional[int] = None,
    max_translate_rel: Optional[float] = None,
    seed: Optional[int] = None,
) -> DataNode
```

Applies a specified AutoAugment policy to a batch of samples.

**Arguments:**

- `data`: A batch of samples (images or videos) with `HWC` or `FHWC` layout, of type `uint8`.
- `policy_name`: Name of the predefined policy to apply. Options include `'image_net'`, `'reduced_image_net'`, `'svhn'`, `'reduced_cifar10'`. Defaults to `'image_net'`.
- `shape`: Optional shape of the images or frames as a DataNode or `(height, width)` tuple. Influences the magnitude of translation augmentations.
- `fill_value`: Padding value used during warp operations. Defaults to 128.
- `interp_type`: Interpolation method for warp operations (`types.INTERP_LINEAR` or `types.INTERP_NN`).
- `max_translate_abs`: Max absolute translation in pixels when `shape` is not provided.
- `max_translate_rel`: Max relative translation as a fraction of shape when `shape` is provided.
- `seed`: Random seed for reproducibility.

**Returns:**

- Transformed batch of samples as a `DataNode`.

**Notes:**

- The function selects a policy based on `policy_name` and applies relevant augmentations.
- Certain policies do not support translation parameters; attempting to specify them will raise an exception.

auto_augment_image_net
----------------------

```python
auto_augment_image_net(
    data: DataNode,
    shape: Optional[Union[DataNode, Tuple[int, int]]] = None,
    fill_value: Optional[int] = 128,
    interp_type: Optional[types.DALIInterpType] = None,
    max_translate_abs: Optional[int] = None,
    max_translate_rel: Optional[float] = None,
    seed: Optional[int] = None,
) -> DataNode
```

Convenience function that applies the `image_net` policy from AutoAugment to the input data.

**Arguments:**

Same as `auto_augment`, with the policy fixed to `'image_net'`.

**Returns:**

- Transformed batch of samples as a `DataNode`.

Usage
-----

Use `auto_augment` to apply AutoAugment policies to your datasets for improved data diversity and model robustness. Select the appropriate policy based on your dataset and task requirements.

Examples
--------

```python
# Apply ImageNet policy to a batch of images
augmented_data = auto_augment(data, policy_name='image_net', shape=(224, 224))
```

See also
--------

- [AutoAugment Paper](https://arxiv.org/abs/1805.09501)
- NVIDIA DALI documentation for data augmentation and image processing utilities.

This module is part of NVIDIA DALI's auto augmentation suite, designed to facilitate advanced data augmentation workflows in deep learning pipelines.