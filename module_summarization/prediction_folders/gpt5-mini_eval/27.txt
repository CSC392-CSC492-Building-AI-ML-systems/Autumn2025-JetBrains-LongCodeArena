w_kinetics — averages and CIs for path‑tracing kinetics analysis
===============================================================

Note
----
This wrapper is deprecated. Use ``w_direct`` instead. The legacy ``w_kinetics``
entry inserts the ``trace`` subcommand and invokes the underlying
``w_direct trace`` implementation.

Synopsis
--------
w_kinetics trace [OPTIONS]

Description
-----------
Calculate state-to-state rates and transition event durations by tracing
trajectories. A bin assignment file (typically ``assign.h5``) containing
trajectory labeling is required (see ``w_assign``).

The output produced by this command (by default ``kintrace.h5``) contains
measured fluxes and recorded transition durations. These fluxes are
conditional fluxes and are not normalized by the population of the
initial macrostate; they must be processed by ``w_kinavg`` (see
``w_kinavg trace``) to obtain normalized rates with confidence intervals.

Default output
--------------
-o, --output FILE
    Output HDF5 file (default: ``kintrace.h5``).

Output format
-------------
The output HDF5 file contains the following datasets:

- /conditional_fluxes [iteration][state][state]
  Floating-point. Macrostate-to-macrostate conditional fluxes (not
  normalized by the initial macrostate population).

- /conditional_arrivals [iteration][stateA][stateB]
  Integer. Number of trajectories arriving at macrostate stateB in a given
  iteration that departed from stateA.

- /total_fluxes [iteration][state]
  Floating-point. Total flux into a given macrostate (these do not require
  normalization to be interpreted as target fluxes).

- /arrivals [iteration][state]
  Integer. Number of trajectories arriving at a given state in a given
  iteration, regardless of origin.

- /duration_count [iteration]
  Integer. Number of event durations recorded in each iteration.

- /durations [iteration][event]
  Structured array. Recorded event durations for transitions that end
  during the given iteration. Each element contains the fields:
    - istate (Integer): initial macrostate of the transition event.
    - fstate (Integer): final macrostate of the transition event.
    - duration (Float): duration of the transition, in units of tau.
    - weight (Float): weight of the trajectory at the end of the transition
      (not normalized by initial-state population).

Notes
-----
- Because conditional fluxes are not normalized by the initial-state
  population, they are not directly interpretable as rates. Use
  ``w_kinavg trace`` to compute normalized rates with confidence intervals,
  taking statistical fluctuations and correlations into account.
- Input requires a bin assignment file (e.g., ``assign.h5``) with trajectory
  labeling.

See also
--------
w_direct (preferred), w_kinavg (trace mode), w_assign