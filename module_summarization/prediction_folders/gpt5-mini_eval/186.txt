Imputation of missing values
===========================

This module provides utilities to impute missing values in feature matrices.
The main public estimator is SimpleImputer, a univariate imputer that replaces
missing values using a descriptive statistic (mean, median, most frequent), or
a constant value. Imputers operate column-wise (per feature).

SimpleImputer
-------------

SimpleImputer replaces missing values for each feature by a single value
derived from the non-missing values in that feature.

Usage
~~~~~
.. code-block:: python

    from sklearn.impute import SimpleImputer
    import numpy as np

    X = np.array([[1, 2], [np.nan, 3], [7, np.nan]])
    imputer = SimpleImputer(strategy="mean")
    X_imputed = imputer.fit_transform(X)

Parameters
~~~~~~~~~~
missing_values : int, float, str, np.nan, None or pandas.NA, default=np.nan
    The placeholder for the missing values. All occurrences of
    ``missing_values`` will be imputed. For pandas nullable integer dtypes
    with missing values, ``missing_values`` can be either ``np.nan`` or
    ``pd.NA``. When ``missing_values`` is a pandas sentinel (e.g. ``pd.NA``)
    numerical arrays are allowed to be imputed.

strategy : {'mean', 'median', 'most_frequent', 'constant'}, default='mean'
    The imputation strategy:

    - 'mean' : replace missing values using the mean along each column.
      Can only be used with numeric data.
    - 'median' : replace missing values using the median along each column.
      Can only be used with numeric data.
    - 'most_frequent' : replace missing values using the most frequent value
      along each column. Can be used with numeric or object/string data. If
      multiple values are equally frequent, the smallest value is returned
      (tie-breaking like scipy.stats.mode).
    - 'constant' : replace missing values with ``fill_value``. Can be used
      with numeric or string/object data.

fill_value : str or numeric, default=None
    When ``strategy == 'constant'``, ``fill_value`` is used to replace all
    occurrences of ``missing_values``. For string or object dtypes,
    ``fill_value`` must be a string. If ``None``, defaults to 0 for numeric
    data and to the string ``"missing_value"`` for string/object data.

add_indicator : bool, default=False
    If True, a boolean indicator matrix is appended to the output of
    ``transform``. The indicator has a column per input feature that
    indicates which values were missing. This can be useful to preserve
    information about which values were imputed. The indicator is implemented
    by a MissingIndicator fitted on the original missing mask; when used,
    the transformed output will have the imputed data concatenated with the
    indicator columns.

keep_empty_features : bool, default=False
    Whether to keep features that consist only of missing values after
    imputation. If False, such empty features might be dropped.

copy : bool, default=True
    If True, a copy of X will be created. If False, imputation may be done
    in-place when possible.

Attributes after fit
~~~~~~~~~~~~~~~~~~~~
statistics_ : ndarray of shape (n_features,)
    The computed statistics for each feature (mean, median, most frequent
    value, or the constant ``fill_value``). These are used to impute missing
    values during transform.

indicator_ : MissingIndicator or None
    Present only when ``add_indicator=True``. The indicator is fitted on the
    training data and used to produce the boolean mask of missing values.

Behavior and restrictions
~~~~~~~~~~~~~~~~~~~~~~~~~
- When ``strategy`` is 'mean' or 'median', features are expected to be numeric.
  If your input dtype is integer with pandas nullable integers and you use
  a pandas missing sentinel (e.g. ``pd.NA``) as ``missing_values``, imputation
  is supported.
- When ``strategy`` is 'most_frequent' the most frequent value is determined
  per column. For object dtype arrays, Python's Counter is used for speed;
  for numeric arrays an optimized mode implementation is used. When comparing
  a candidate value against a repeated extra value (internal tie handling),
  ties are broken in a consistent, deterministic manner.
- If ``missing_values`` is not a numeric real and X is a numeric numpy array,
  a ``ValueError`` is raised (except when ``missing_values`` is a pandas
  NA sentinel).
- When ``add_indicator=True``, the indicator is computed from the original
  input mask. If imputation is performed in-place, make sure to provide the
  original data to the indicator routines.

Example
~~~~~~~
.. code-block:: python

    import numpy as np
    from sklearn.impute import SimpleImputer

    X = np.array([
        [np.nan, 2, "a"],
        [6, np.nan, "b"],
        [7, 6, "b"]
    ], dtype=object)

    imputer = SimpleImputer(missing_values=np.nan, strategy="most_frequent",
                            add_indicator=True)
    X_imputed = imputer.fit_transform(X)
    # X_imputed will contain imputed values and appended indicator columns.

Notes
~~~~~
- SimpleImputer is univariate: it imputes each feature independently using the
  statistic computed from that feature alone. For multivariate imputation
  strategies, see other estimators (e.g. iterative imputation).
- The imputer supports both dense numpy arrays and scipy sparse matrices where
  appropriate for the chosen strategy.

See also
~~~~~~~~
MissingIndicator
    Transformer that can be used to append binary indicators for missing
    values.

IterativeImputer
    Multivariate imputer that models each feature with missing values as a
    function of other features for more sophisticated imputation strategies.

References
~~~~~~~~~~
- scikit-learn user guide: Imputation of missing values (User Guide section).
- For algorithmic details about mode/most frequent computation and tie
  breaking, internal implementations use optimized routines and
  deterministic tie-breaking consistent with scipy.stats.mode behavior.