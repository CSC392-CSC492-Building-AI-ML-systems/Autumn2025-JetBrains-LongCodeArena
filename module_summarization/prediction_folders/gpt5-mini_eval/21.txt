w_eddist — Time-resolved transition-event duration distributions
================================================================

Synopsis
--------
w_eddist [OPTIONS]

Purpose
-------
Calculate time-resolved transition-event duration distributions from kinetics
results. The program reads datasets produced by the "w_kinetics trace" command
and produces per-iteration histograms of transition-event durations (and
other tracked dimensions, if present).

Source data
-----------
Source data is taken from the output of "w_kinetics trace" (see
"w_kinetics trace --help" for details on producing the input dataset). The
tool reads duration and weight datasets (duration-like datasets are wrapped by
an internal DurationDataset facade that applies masks and supplies per-iteration
arrays).

Histogram binning
-----------------
By default, histograms are constructed with 100 bins in each dimension. The
-b / --bins option accepts several forms:

- A single integer N
  - Use N uniformly spaced bins in every dimension.

- A sequence of integers N1,N2,...
  - Use N1 bins for the first dimension, N2 for the second, etc.

- A list-of-lists [[B11,B12,...],[B21,B22,...],...]
  - Explicit bin boundaries for each dimension. Boundaries need not be uniform.
    These expressions are evaluated with Python's eval; "np" (NumPy) is
    available (for example, to supply boundaries via np.arange()).

When the integer or sequence-of-integers forms are used, the code scans the
input data to determine per-dimension minima and maxima; for large datasets
this scan can be expensive. If you can, provide explicit bin boundaries (the
list-of-lists form) to avoid that scan.

Notes on binning behavior
- Bins are independent of the bins used to drive WE sampling.
- Histograms are computed per iteration and normalized so each stored
  histogram represents a probability distribution over the binned space.
- Points outside explicitly provided bin bounds can be ignored (see option
  to control "ignore out of range" behavior).

Output format
-------------
The output is an HDF5 file (default "pdist.h5") containing the computed
histograms and associated binning metadata. Datasets created include:

- histograms
  - A normalized histogram array. The first axis indexes iterations; remaining
    axes correspond to the histogram dimensions.

- /binbounds_0, /binbounds_1, ...
  - Vectors of bin boundaries for each histogram dimension.

- /midpoints_0, /midpoints_1, ...
  - Vectors of bin midpoints for each histogram dimension.

- n_iter
  - Vector of iteration numbers corresponding to the first axis of
    "histograms".

Subsequent processing
---------------------
The output file (default "pdist.h5") can be visualized with the "plothist"
program (see "plothist --help") or further processed with custom tools.

Parallelization
---------------
w_eddist supports parallelized histogram binning (including parallel input
reading). Parallel processing is the default and is suitable for large
datasets and heavy computation. For simple cases (pre-computed input data or
small segment counts), serial processing (--serial) may be more efficient.

Defaults and important options
------------------------------
- Default kinetics input filename: kintrace.h5
- Default output filename: pdist.h5
- Default bins: 100 per dimension
- Key command-line options:
  - -b, --bins   : Specify bins (see "Histogram binning" above)
  - -o, --output : Output HDF5 filename (default "pdist.h5")
  - --serial     : Run without parallelization

See also
--------
w_kinetics trace — producing the kinetics/trace input datasets used by
w_eddist
plothist — plotting and visualizing histogram output produced by w_eddist

Notes
-----
- The tool normalizes per-iteration histograms so each stored slice is a
  probability distribution over the binned space.
- When providing explicit bin boundaries, you eliminate the need for an
  expensive global min/max scan.