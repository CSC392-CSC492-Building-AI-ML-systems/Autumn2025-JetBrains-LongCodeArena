w_kinavg — averages and confidence intervals for path‑tracing kinetics analysis
=============================================================================

Deprecated
----------
w_kinavg is deprecated. Use w_direct instead. The w_kinavg command is retained
for backwards compatibility and behaves as the "trace" subcommand of w_direct.

Synopsis
--------
w_kinavg trace [OPTIONS]

Description
-----------
Calculate average rates and associated errors from weighted‑ensemble data.
Bin assignments (typically assignments.h5) and kinetics data (typically
kintrace.h5 or kinmat.h5) must have been previously generated.

Output format
-------------
The output file (option -o/--output, default: kinavg.h5) contains the following
datasets:

/avg_rates [state,state]
  Structured dataset. State‑to‑state rates averaged over the selected window
  of iterations.

/avg_total_fluxes [state]
  (Trace mode only.) Structured dataset. Total fluxes into each macrostate
  based on the selected window of iterations.

/avg_conditional_fluxes [state,state]
  (Trace mode only.) Structured dataset. State‑to‑state fluxes based on the
  selected window of iterations.

If --evolution-mode is specified, additional datasets are produced:

/rate_evolution [window][state][state]
  Structured dataset. State‑to‑state rates computed over windows of iterations
  whose widths vary according to the chosen evolution mode. If
  --evolution-mode=cumulative, windows begin at --start-iter and grow by
  --step-iter. If --evolution-mode=blocked, windows are of width --step-iter
  (the last may be shorter), beginning at --start-iter.

/target_flux_evolution [window,state]
  (Trace mode + evolution mode.) Total flux into each macrostate over the
  progression of windows described above.

/conditional_flux_evolution [window,state,state]
  (Trace mode + evolution mode.) State‑to‑state fluxes over the progression
  of windows described above.

Dataset field structure
-----------------------
Each structured dataset contains the following fields:

iter_start
  Integer. Iteration at which the averaging window begins (inclusive).

iter_stop
  Integer. Iteration at which the averaging window ends (exclusive).

expected
  Floating point. Expected (mean) value of the rate or flux over the window,
  in units of inverse tau.

ci_lbound
  Floating point. Lower bound of the confidence interval for the rate/flux,
  in units of inverse tau.

ci_ubound
  Floating point. Upper bound of the confidence interval for the rate/flux,
  in units of inverse tau.

corr_len
  Integer. Correlation length for the quantity in units of tau.

Dataset attributes
------------------
Each dataset is annotated with the following attributes:

mcbs_alpha
  Floating-point. Alpha value for confidence intervals (e.g., alpha=0.05 for a
  95% CI).

mcbs_nsets
  Integer. Number of bootstrap data sets used to generate confidence intervals.

mcbs_acalpha
  Floating-point. Alpha value used for determining correlation lengths.

Common file defaults
--------------------
Default kinetics input file: kintrace.h5
Default output file: kinavg.h5

Notes
-----
- Bin assignments and kinetics trace/matrix files must be produced beforehand
  (see w_assign and w_kinetics).
- The command implements the behavior of the "trace" subcommand; invoking
  w_kinavg without an explicit subcommand will default to trace mode.

Example
-------
w_kinavg trace -a assignments.h5 -k kintrace.h5 -o kinavg.h5 --evolution-mode=cumulative