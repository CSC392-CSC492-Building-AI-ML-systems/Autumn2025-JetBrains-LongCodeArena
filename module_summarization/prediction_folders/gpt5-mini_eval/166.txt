FileNode â€” simulating a filesystem with PyTables
===============================================

Overview
--------
The FileNode module provides a file-like interface for storing and accessing
binary file contents inside PyTables HDF5 files. File nodes behave like
normal Python binary files (io.RawIOBase-derived) while the underlying data
is stored as table rows inside the HDF5 container.

This implementation was rewritten in version 3.0 to be fully compliant with
the interfaces defined in the Python io module.

Quick guide
-----------
- Use new_node() to create a new file node.
- Use open_node() to open an existing file node for reading or append-style
  writing.
- Only binary I/O is supported.
- Read access is always available.
- Write access is append-only: existing bytes cannot be overwritten or
  deleted. Truncate() only supports growing the file (filling with zeros).

Key concepts and behavior
-------------------------
- Node system attributes:
  - NODE_TYPE: value is 'file'.
  - NODE_TYPE_VERSION: supported values are 1 and 2. The version controls how
    the file size is mapped to table row shapes and affects on-disk layout.
- API compatibility: file-like objects returned by this module implement the
  io.RawIOBase interface (seek, tell, readinto, readable, writable, flush,
  close, fileno, truncate, etc.).
- File positioning:
  - seek() and tell() are supported; objects are seekable.
  - Seeking with whence=0,1,2 is implemented; negative positions are rejected.
- Reading:
  - readinto(buffer) reads up to len(buffer) bytes and returns the number
    of bytes read (0 for EOF).
  - readline() is supported (returns bytes).
- Writing:
  - Files opened for writing support append operations only. Writes always
    increase node size; existing regions cannot be rewritten.
  - truncate(pos) may be used to grow a file node by filling the new region
    with zeros. Truncating to a smaller size is not allowed.
- File descriptor:
  - fileno() returns the underlying PyTables file descriptor when available.
- Flush/close:
  - flush() forces the PyTables node to flush.
  - close() releases the node; if the host PyTables file is already closed a
    warning is issued.

Version-specific details
------------------------
- Internal data mapping depends on NODE_TYPE_VERSION:
  - Version 1 uses a two-dimensional shape mapping for stored rows.
  - Version 2 uses a one-dimensional shape mapping.
- The code inspects node.attrs.NODE_TYPE_VERSION to select the appropriate
  in-memory/out-of-disk layout and the node.atom dtype for element type.

Limitations and notes
---------------------
- Only binary (bytes) I/O is supported; text-mode helpers are not provided.
- The append-only model means existing data cannot be mutated in-place.
- The file-node object depends on the hosting PyTables file remaining open;
  operations on nodes whose parent file has been closed may raise warnings or
  errors.
- The implementation relies on PyTables internals (node atom, nrows,
  read/write semantics) and therefore follows PyTables file semantics.

Example (sketch)
----------------
Simple usage pattern:

from filenode import new_node, open_node

# create a new file node (example signature varies)
fn = new_node(...)

# open for reading
with open_node(fn, mode='r') as f:
    data = f.read()

# open for append (write)
with open_node(fn, mode='a+') as f:
    f.seek(0, 2)     # go to end
    f.write(b'new data')

References
----------
See the user guide reference :ref:`filenode_usersguide` for full usage
examples and migration notes.