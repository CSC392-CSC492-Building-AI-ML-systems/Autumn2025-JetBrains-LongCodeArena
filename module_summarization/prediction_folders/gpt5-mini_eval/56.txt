mixed_glm — Bayesian inference for generalized linear mixed models
=================================================================

Overview
--------
This module implements Bayesian inference for generalized linear mixed
models (GLMMs). It currently supports families without additional scale
or shape parameters (notably binomial and Poisson). Two estimation
approaches are provided:

- Laplace approximation (maximum a posteriori), via fit_map.
- Variational Bayes (mean-field approximation to the posterior), via
  fit_vb.

All realizations of random effects are modeled as mutually independent
given their variance parameters.

Model and parameterization
--------------------------
The joint density of data and parameters factors as:

.. math::

    p(y \mid vc, fep)\; p(vc \mid vcp)\; p(vcp)\; p(fe)

Priors:
- p(fe) and p(vcp) are Gaussian in the parameterization used. The
  variance-component parameters vcp are modeled on the log standard
  deviation scale (so the corresponding standard deviations are
  log-normal).
- p(vc | vcp) is an independent Gaussian distribution for the random
  effect realizations.

Random effects structure
------------------------
- exog_vc is the design matrix for random effects. Each column of
  exog_vc corresponds to a distinct realized random effect (vc).
- ident is used to group columns of exog_vc that share the same
  standard deviation: ident must have length equal to the number of
  columns of exog_vc; equal ident values indicate a common variance.
- When model formulas are used to construct exog_vc, columns derived
  from the same formula are constrained to share the same standard
  deviation (ident is constructed internally).
- All random effects are assumed independent within and between ident
  groups.

Priors and hyperparameters
--------------------------
- vcp_p: prior standard deviation for variance-component parameters
  (the standard deviation of the log(s) prior; s is the random-effect
  standard deviation).
- fe_p: prior standard deviation for fixed-effect parameters.
- Fixed effects (fep) prior is Gaussian with mean zero and standard
  deviation fe_p.
- Random-effect standard deviations (vcp) have Gaussian priors on the
  log scale (center 0, sd vcp_p).

Data types and sparsity
-----------------------
- exog_vc may be provided as a scipy.sparse matrix; dense inputs are
  converted internally to sparse format.
- When using formulas, a temporary dense version of exog_vc may be
  created internally; there is no current way to avoid this.
- Sparse design matrices are recommended for large models.

Estimation methods
------------------
- fit_map: Laplace approximation to obtain a posterior mode (MAP).
  Finding the posterior mode can be sensitive to the choice of vcp_p,
  especially for binomial families; moderate values (e.g., vcp_p ≈ 0.5)
  are often helpful.
- fit_vb: Mean-field variational Bayes approximation to the posterior.

Notes and limitations
---------------------
- Only families without additional scale/shape parameters are supported
  (examples: binomial, Poisson).
- All random-effect realizations are modeled as independent (no
  within-group correlation beyond variance-component grouping by
  ident).
- Numerical quadrature utilities (Gauss–Legendre nodes/weights) are
  available in the module for integration tasks.

API highlights
--------------
Constructor arguments (summary)
- endog : response vector.
- exog : fixed-effects design matrix.
- exog_vc : random-effects design matrix (sparse or dense).
- ident : integer labels grouping exog_vc columns that share a
  variance-component parameter.
- vcp_p : prior sd for log-standard-deviations of random effects.
- fe_p : prior sd for fixed-effects parameters.
- family : statsmodels.genmod.families instance (e.g., Binomial, Poisson).
- fep_names, vcp_names, vc_names : optional names for parameters.

Primary results
- Estimation methods return a MixedGLMResults-like object containing
  parameter estimates, posterior summaries, and model diagnostics.

Examples
--------
A basic usage flow:
- Construct the model with endog, exog, exog_vc (and optionally ident
  or formulas).
- Call fit_map() or fit_vb() to obtain parameter estimates and posterior
  approximations.
(See the module docstrings and method docstrings for detailed usage
examples.)

References
----------
- Introduction to generalized linear mixed models:
  https://stats.idre.ucla.edu/other/mult-pkg/introduction-to-generalized-linear-mixed-models
- SAS intromix documentation:
  https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_intromix_a0000000215.htm
- An assessment of estimation methods for generalized linear mixed
  models with binary outcomes:
  https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3866838/