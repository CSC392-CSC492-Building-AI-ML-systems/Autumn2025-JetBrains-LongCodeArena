statsmodels.discrete.discretemod
================================

Overview
--------
Module providing generic zero-inflated count models and concrete
implementations for common count distributions.  These models mix a
binary "inflation" process (probability of an extra structural zero)
with a main count model (e.g. Poisson, Generalized Poisson,
Negative Binomial P).

Exported names
--------------
__all__ = ["ZeroInflatedPoisson",
           "ZeroInflatedGeneralizedPoisson",
           "ZeroInflatedNegativeBinomialP"]

Main classes
------------

GenericZeroInflated
~~~~~~~~~~~~~~~~~~~
Generiz Zero Inflated model for count data.

Signature
    GenericZeroInflated(endog, exog, exog_infl=None, offset=None,
                        inflation='logit', exposure=None, missing='none',
                        **kwargs)

Description
    Generic implementation of zero-inflated count models. The model is a
    mixture of an inflation (binary) model that governs the probability
    w_i of a structural zero, and a main count model (provided by
    subclasses) that governs the distribution of counts when not
    inflated.

    The default inflation model is Logit; Probit is also supported.

Parameters
    endog : array_like
        Response/count variable (n observations).
    exog : array_like
        Exogenous design matrix for the main count model.
    exog_infl : array_like or None
        Explanatory variables for the binary inflation model. If None,
        a column of ones (intercept only) is used.
    offset : array_like or None
        Offset term added to the main model linear predictor (coefficient
        fixed to 1).
    exposure : array_like or None
        Log(exposure) is added to the main model linear predictor
        (coefficient fixed to 1).
    inflation : {'logit', 'probit'}
        Model for the zero inflation (default 'logit').
    missing : str
        Missing-data handling passed to base CountModel.
    **kwargs : dict
        Additional keyword arguments passed to base classes.

Behavior and design notes
    - exog_infl is converted to numeric ndarray; if None, an intercept-only
      inflation design is created.
    - The lengths of exog and exog_infl must match. A ValueError is raised
      if they differ.
    - The inflation model is implemented via a Logit or Probit model object
      (self.model_infl). The names of inflation parameters are prefixed
      with "inflate_".
    - Parameter ordering: the full parameter vector passed to loglike/fit
      has the inflation parameters first (length k_inflate), followed by
      the main-model parameters.
    - The attribute self.model_main is expected to be provided by
      subclasses and implements the main model loglikelihood and other
      behavior.

Attributes
    endog, exog : arrays
        References to endogenous and exogenous data.
    exog_infl : array
        Inflation design matrix.
    k_inflate : int
        Number of parameters in the inflation model.
    k_exog : int
        Number of regressors in the main model (exog).
    k_extra : int
        Alias for k_inflate.
    infl / inflation : str
        Inflation model type ('logit' or 'probit').
    model_infl : Logit or Probit instance
        Underlying binary model for inflation.
    exog_names : list
        Parameter names for the combined model (inflation names prefixed
        and then main model names).

Methods
    loglike(params)
        Returns scalar log-likelihood of the model (sum over observations).

    loglikeobs(params)
        Returns log-likelihood for each observation. For observations
        y_i = 0, loglikeobs = ln( w_i + (1 - w_i) * P_main(y=0) ). For
        y_i > 0, loglikeobs = ln(1 - w_i) + ln P_main(y_i).

        Here w_i is the inflation probability from the binary model and
        P_main is the main-model probability mass function / likelihood
        contribution.

    fit(start_params=None, method='bfgs', maxiter=35, full_output=1,
        disp=1, callback=None, cov_type='nonrobust', cov_kwds=None,
        use_t=None, **kwargs)
        Fit the model by maximum likelihood. If start_params is None,
        a starting vector is obtained from the model's _get_start_params.
        The fit call uses base class infrastructure and returns a results
        instance compatible with CountResults behavior.

Errors
    ValueError is raised when inflation is not one of the supported
    options or when exog and exog_infl have different numbers of
    observations.

Log-likelihood (note)
    The log-likelihood implemented follows the mixture form:

    ln L = sum_{i: y_i = 0} ln( w_i + (1 - w_i) * P_main(y_i=0) )
         + sum_{i: y_i > 0} [ ln(1 - w_i) + ln P_main(y_i) ]

Concrete zero-inflated models
-----------------------------

ZeroInflatedPoisson
~~~~~~~~~~~~~~~~~~~
Zero-inflated Poisson regression.

Description
    Subclass of GenericZeroInflated that uses a Poisson main model.
    It models counts with extra zeros relative to a Poisson baseline.

Usage
    model = ZeroInflatedPoisson(endog, exog, exog_infl=..., inflation='logit')

ZeroInflatedGeneralizedPoisson
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Zero-inflated Generalized Poisson regression.

Description
    Subclass of GenericZeroInflated that uses a Generalized Poisson main
    model (handles dispersion beyond standard Poisson). Useful when
    data exhibit over- or under-dispersion relative to Poisson,
    together with excess zeros.

Usage
    model = ZeroInflatedGeneralizedPoisson(endog, exog, exog_infl=..., inflation='probit')

ZeroInflatedNegativeBinomialP
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Zero-inflated Negative Binomial (P) regression.

Description
    Subclass of GenericZeroInflated that uses a Negative Binomial P
    main model (a common parameterization for overdispersed count data).
    Suitable when overdispersion and zero-inflation are both present.

Usage
    model = ZeroInflatedNegativeBinomialP(endog, exog, exog_infl=..., inflation='logit')

Other module elements
---------------------
Distributions and helpers used
    - statsmodels.distributions.zipoisson, zigenpoisson, zinegbin:
      distribution implementations used for likelihood evaluations.
    - Numerical differentiation helpers: approx_fprime, approx_hess.
    - Internal utilities: cache_readonly, ConvergenceWarning.

Examples
--------
Minimal usage pattern:

    from statsmodels.discrete.discretemod import ZeroInflatedPoisson
    model = ZeroInflatedPoisson(endog, exog, exog_infl=None, inflation='logit')
    results = model.fit()

Notes
-----
- Inflation probabilities are constrained to (eps, 1 - eps) internally
  to avoid numerical issues.
- The inflation parameter names are prefixed with "inflate_" in the
  combined parameter vector and in exog_names.
- The module relies on the base CountModel/DiscreteModel infrastructure
  from statsmodels for estimation and result objects.

See Also
--------
- statsmodels.discrete.discrete_model.CountModel
- statsmodels.distributions.zipoisson, zigenpoisson, zinegbin

End of module documentation.