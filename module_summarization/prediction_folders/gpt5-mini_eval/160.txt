Compatibility Policy
====================

This document describes the compatibility commitments and expectations for the numpy.random component as built and installed from the sources in this tree. It covers the public Python surface, the C/Cython extension boundaries, build-time dependencies and layout, deprecation rules, and platform-specific considerations.

Scope
-----
This policy applies to:
- The public Python package numpy.random (modules, functions, classes, tests and examples installed under numpy/random).
- Binary extension modules built from C/Cython sources (extension modules in numpy/random and the supporting static library npyrandom).
- Build-time and source-level artifacts that consumers may depend on (pxd files, generated C/PYX files, installed libraries and headers).

Versioning and compatibility guarantees
--------------------------------------
- Public Python API: Backwards compatibility for documented public Python APIs in numpy.random is expected to be preserved across patch releases. Additions are allowed in minor releases. Breaking changes to the public Python API may occur only in major releases and will be documented in release notes.
- Binary/API (C ABI) and C extensions: The C-level ABI used by third-party compiled extensions is more restricted. Binary compatibility for compiled extensions is not guaranteed across major NumPy releases; maintainers will attempt to preserve ABI across patch/minor releases where feasible, but extensions should be considered potentially incompatible with different NumPy major releases.
- Cython pxd/API surface: .pxd files installed into numpy/random are a build-time API used by Cython modules that import the package’s internals. These are not a stable, public C API for third parties unless explicitly documented. Changes to .pxd files may occur between minor or major releases; third parties must pin to a specific NumPy release or vendor a copy if they require stability.
- Internal C APIs and static libraries (npyrandom): Internal C sources and static libraries are considered implementation details. Third-party code should not link against internal static libraries (such as npyrandom) unless the project explicitly documents them as supported. Internal C API changes can occur between minor and major releases.

Cython and generated code
-------------------------
- The build process depends on a set of .pxd and __init__ files being available at build-time because Cython-generated C/PYX outputs import and declare types from those files. Consumers building extensions against the numpy.random sources must reproduce the same source layout.
- Generated C code (from .pyx) and temporary input templates (e.g., files produced by tempita) are build artifacts and may change between releases. Do not rely on a specific generated C source layout or content unless it is part of a documented stable API.

Deprecation policy
------------------
- Deprecated Python features that are part of the public numpy.random API will be announced in release notes and (when possible) will remain available for a deprecation period measured across releases (minor or major as appropriate). Deprecation removals will be communicated clearly.
- The codebase currently compiles with NPY_NO_DEPRECATED_API=0 to retain older NumPy C API uses during transition. This flag indicates that deprecated C API usage may still exist and can be removed in future releases; C extension authors should migrate to the modern NumPy C API to avoid breakage.

Build, installation layout and files
------------------------------------
Files installed by the build described here include:
- Python package modules and type stubs under numpy/random (including __init__.py, .pxd, .pyi, .py files).
- Cython extension modules under the numpy/random package (built extensions such as _mt19937, _philox, _pcg64, _sfc64, bit_generator, _generator, mtrand).
- A static library (npyrandom) installed to the library directory under numpy/random/lib when building with the provided meson setup.
- Tests, test data files, examples, and LICENSE.md installed under numpy/random and subdirectories.
- Template/auxiliary files produced by the build (e.g., files produced by tempita) may be installed if required for packaging.

Third-party extension authors should:
- Prefer building against a stable NumPy release and use the public Python-level APIs when possible.
- When using Cython and importing pxd files from numpy.random, vendor/pin the exact release or include a copy of the required pxd files to avoid breakage when those internal declarations change.

Platform-specific and link considerations
-----------------------------------------
- Platform-specific linker or compiler flags may be used during build (for example, additional symbol-export options on Cygwin). Binary extensions built on one platform may not be portable to different platforms or different toolchains.
- Some build configurations may export additional symbols (e.g., on Cygwin) which affect linking and symbol visibility. Consumers relying on symbol layouts should treat these as implementation details.

Legacy features
---------------
- Legacy distributions and compatibility macros (for example NP_RANDOM_LEGACY) may be used to retain historical behaviour for certain components. These macros are subject to change and should not be relied upon as a long-term stable interface unless documented.

Testing and data files
----------------------
- Tests and test datasets are installed under numpy/random/tests and numpy/random/tests/data and may be used to validate builds. Tests may depend on internal behavior and thus are not a formal API for third-party code.

Licensing
---------
This software is dual-licensed under the University of Illinois/NCSA Open Source License (NCSA). Refer to the distributed LICENSE.md for full license text and obligations.

Practices for downstream packagers and integrators
-------------------------------------------------
- Build and test against the exact NumPy release intended for deployment.
- Vendor or pin internal .pxd and header files if third-party Cython modules must import internal declarations.
- Prefer the public Python API over C-level or internal interfaces for long-term compatibility.
- Monitor release notes for deprecations and ABI changes and run the packaged test-suite included in numpy/random during packaging.

Contact and changes
-------------------
Compatibility commitments will be reflected in release notes and changelogs. For questions about specific compatibility guarantees, consult project release documentation or reach out via the project’s official communication channels.