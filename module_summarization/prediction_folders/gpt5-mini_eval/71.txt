kernel_ridge — Kernel ridge regression
=====================================

.. currentmodule:: sklearn.kernel_ridge

Module-level summary
--------------------
Module :mod:`sklearn.kernel_ridge` implements kernel ridge regression (KRR).
KRR combines ridge regression with the kernel trick to learn a linear model in
the feature space induced by the chosen kernel. For non-linear kernels this
corresponds to a non-linear model in the original input space. Fitting KRR has
a closed-form solution and the learned model is typically non-sparse.

Classes
-------
.. autosummary::
   :toctree: generated
   :nosignatures:

   KernelRidge

KernelRidge
-----------

.. autoclass:: sklearn.kernel_ridge.KernelRidge
    :members:
    :undoc-members:
    :inherited-members:
    :show-inheritance:

Notes
-----
- KernelRidge fits a model equivalent in form to support vector regression (SVR)
  but uses squared error loss combined with L2 regularization instead of the
  epsilon-insensitive loss used by SVR. This typically yields a closed-form
  solution that is efficient for medium-sized datasets; prediction-time cost is
  higher than sparse methods because the solution is non-sparse.
- Multi-output regression is supported: when ``y`` is a 2D array of shape
  ``(n_samples, n_targets)`` the estimator fits one model per target.
- If ``kernel="precomputed"``, the input passed as ``X`` to ``fit`` is
  interpreted as a precomputed kernel matrix of shape ``(n_samples, n_samples)``.
- Internally, kernel evaluations are delegated to
  :func:`sklearn.metrics.pairwise.pairwise_kernels`. When ``kernel`` is a
  callable it is assumed to operate on pairs of samples; when ``kernel`` is a
  string it must be one of :data:`sklearn.metrics.pairwise.PAIRWISE_KERNEL_FUNCTIONS`
  or ``"precomputed"``.

Parameters (high level)
-----------------------
- alpha : float or array-like of shape (n_targets,), default=1.0
  Regularization strength; must be non-negative. Larger values imply stronger
  regularization. If an array is provided, one penalty per target is assumed.
- kernel : str or callable, default="linear"
  Kernel mapping to use. If a string, must be one of the supported pairwise
  kernel names or ``"precomputed"``. If callable, it should accept two single
  samples (rows) and return a scalar kernel value.
- gamma : float, default=None
  Kernel coefficient for certain kernels (rbf, poly, sigmoid, laplacian, etc.).
- degree : int, default=3
  Degree for polynomial kernel.
- coef0 : float, default=1
  Independent term in poly/sigmoid kernels.
- kernel_params : dict, default=None
  Extra parameters (keyword arguments) passed to the kernel function.

Attributes (selected)
---------------------
- dual_coef_ : ndarray of shape (n_samples,) or (n_samples, n_targets)
  Representation of the fitted weights in kernel space.
- X_fit_ : ndarray or sparse matrix of shape (n_samples, n_features)
  Training data required for prediction. If ``kernel="precomputed"``, this is
  the precomputed training kernel matrix of shape ``(n_samples, n_samples)``.
- n_features_in_ : int
  Number of features seen during fit.
- feature_names_in_ : ndarray of str
  Names of features seen during fit (if provided).

See Also
--------
- :class:`sklearn.linear_model.Ridge` — Linear ridge regression.
- :class:`sklearn.linear_model.RidgeCV` — Ridge with built-in cross-validation.
- :class:`sklearn.svm.SVR` — Support Vector Regression accepting many kernels.
- :class:`sklearn.gaussian_process.GaussianProcessRegressor` — Gaussian
  Process regressor (provides kernel hyperparameter tuning and uncertainty).

References
----------
Kevin P. Murphy, "Machine Learning: A Probabilistic Perspective", MIT Press,
chapter 14.4.3, pp. 492–493.

Examples
--------
Basic usage:

.. code-block:: python

    from sklearn.kernel_ridge import KernelRidge
    import numpy as np

    n_samples, n_features = 10, 5
    rng = np.random.RandomState(0)
    y = rng.randn(n_samples)
    X = rng.randn(n_samples, n_features)

    krr = KernelRidge(alpha=1.0)
    krr.fit(X, y)
    y_pred = krr.predict(X)