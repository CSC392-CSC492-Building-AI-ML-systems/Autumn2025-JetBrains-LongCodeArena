Plothist command
================

Synopsis
--------
plothist INPUT [DIMENSION] [options]

Brief description
-----------------
Generate and save plots of histogram data stored in a WESTPA-format HDF5 file. Supports 1-D and 2-D histograms, multiple plotting scales (energy, linear, log10), optional contour overlays for 2-D heatmaps, and exporting of plot data to an HDF5 dataset.

Inputs
------
INPUT
    HDF5 file containing histogram data (WESTPA format).

DIMENSION (optional)
    Dimension specification selecting which histogram dimension to plot. Syntax:
    INT[:[LB,UB]:LABEL]
    - INT  : zero-based index of the histogram dimension (required).
    - LB,UB: optional lower and upper plotting bounds for that dimension.
    - LABEL: optional axis label to use in the plot.
    If omitted, dimension 0 (label "dimension 0") is used.

Output
------
-o, --output, --plot-output PLOT_OUTPUT
    File in which to store the plot. The output file format is inferred from the filename extension (default: "hist.pdf"). Set to an empty string (e.g. --plot-output='') to suppress plotting entirely.

--hdf5-output HDF5_OUTPUT
    Store plot data into the named HDF5 file.

--plot-contour
    For 2-D histograms, superimpose a contour plot over the heatmap.

Plotting options
----------------
--title TITLE
    Include TITLE as the top-of-graph title.

--linear
    Plot the histogram on a linear scale.

--energy
    Plot the histogram on an inverted natural-log scale corresponding to (free) energy (default).

--log10
    Plot the histogram on a base-10 log scale.

--zero-energy E
    Set the zero of energy to E. E may be a scalar float, or the strings "min" or "max". Default is "min".

--range LB,UB
    Restrict the plotted ordinate (for 1-D: y axis; for 2-D: colorbar) to the given lower and upper bounds.

--postprocess-function MODULE.FUNCTION
    Provide a Python callable (importable as module.function) that will be invoked immediately prior to saving the plot to allow user modifications. The function is called as:
        postprocess(hist, midpoints, binbounds)
    - hist: the ndarray that was plotted
    - midpoints: list/array of bin midpoints for each plotted dimension
    - binbounds: for 2-D plots, the bin boundaries for each dimension; otherwise None
    The callable must modify the plot in place using matplotlib.pyplot's stateful interface.

Behavior and defaults
---------------------
- Default plotting scale is "energy" (inverted natural log).
- If no DIMENSION is specified, the first dimension (index 0) is plotted over its full range.
- The energy zero point may be set to a numeric value or the current histogram minimum/maximum via "min"/"max".
- For 2-D plots the main visualization is a heatmap with an optional contour overlay (--plot-contour).
- The plot file is written according to the provided filename extension; common formats such as .pdf, .png are supported.
- Plot data may be written to an HDF5 file with --hdf5-output for downstream processing.

Examples
--------
- Basic plot of the first dimension to the default PDF:
  plothist hist.h5

- Plot dimension 1 with label and bounds to PNG using a linear scale:
  plothist hist.h5 1:0.0,10.0:distance -o distance.png --linear

- 2-D heatmap with contour overlay and custom color-range, exporting plot data:
  plothist hist.h5 2: -o heatmap.pdf --plot-contour --range -5.0,5.0 --hdf5-output plotdata.h5

- Use a postprocessing function to tweak axes before saving:
  plothist hist.h5 0 --postprocess-function mymodule.adjust_style -o out.png

Notes
-----
- The command expects histogram data in the WESTPA HDF5 layout (histogram datasets and iteration metadata).
- The postprocess function must be importable on the Python path and should perform in-place modifications using matplotlib.pyplot.