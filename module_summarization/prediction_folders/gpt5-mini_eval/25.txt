w_ipa — WESTPA Interactive Python Analysis
=========================================

Synopsis
--------
w_ipa provides an interactive, stateful analysis environment for WESTPA
projects. It launches a Python analysis session (WESTPA Interactive Python
Analysis — WIPI) that exposes the current analysis scheme and iteration,
allows tracing individual segments, inspecting weights, progress coordinates,
states, bins, and other iteration-level data.

By default w_ipa uses the first enabled analysis scheme from west.cfg and
starts at iteration 1. All data is pulled from the current analysis scheme
and the current iteration.

Quick start
-----------
- Start the interactive tool (typically via the w_ipa entry point).
- Inspect or set the current iteration:

  w.iteration
  w.iteration = 100

- List or switch analysis schemes:

  w.list_schemes
  w.scheme = <scheme-name-from-w.list_schemes>

- View scheme definitions:

  w.states
  w.bin_labels

- Inspect current iteration data:

  w.current
  (Contains: walkers, summary, states, seg_id, weights, parents, kinavg,
   pcoord, bins, populations, auxdata (if present))

- Trace a segment history (may be expensive — store the result):

  w.trace(seg_id)

Features
--------
- Stateful interactive analysis: the session always reflects the "current"
  analysis scheme and iteration.
- Uses WESTDataReader to determine available iterations and read data.
- Integrates progress reporting (ProgressIndicatorComponent).
- Uses WESTParallelTool infrastructure and the configured work manager.
- Supports hashing of analysis arguments to detect/regenerate derived files.
- Default plotting interface is matplotlib (interface can be set to 'text' for
  terminal plotting).

Defaults and attributes
-----------------------
- Default iteration: 1
- Default analysis scheme: first enabled scheme in the analysis section of
  west.cfg
- Default interface: 'matplotlib'
- Version: 1.0B
- Default work manager: parallel default work manager (wm_env.default_parallel_work_manager)
- Compression default for CLI parser: enabled (parser.set_defaults(compression=True))

Important properties exposed in the session
------------------------------------------
- w.iteration / west.iteration
- w.scheme (the current analysis scheme)
- w.list_schemes (list available schemes)
- w.states (state definitions for the current scheme)
- w.bin_labels (bin labels for the current scheme)
- w.current (object holding the current-iteration data: walkers, weights, traces, etc.)
- w.trace(seg_id) (returns a dictionary with the segment’s history)

Command-line options
--------------------
General runtime options (added by the tool):

- --analysis-only, -ao
  Run analysis and return to the terminal (do not drop into a longer interactive mode).

- --reanalyze, -ra
  Delete existing analysis files and reanalyze from scratch.

- --ignore-hash, -ih
  Ignore stored argument/file hash; do not regenerate files based on hash checks.

- --debug, -d
  Enable debug output (useful for development).

- --terminal, -t
  Use text-based plotting in the terminal (sets interface to 'text').

Other behavior and notes
------------------------
- The tool reads analysis configuration from westpa.rc.config['west']['analysis']
  and selects the first scheme whose "enabled" value is True (or unset).
- The tool sets internal flags from CLI arguments: analysis_mode, reanalyze,
  ignore_hash, debug_mode, and stores parsed args in data_args.
- The data reader is used (with context manager) to determine niters (current_iteration - 1).
- The tool implements argument hashing via hash_args(args, extra=None, path=None)
  which produces an MD5 hash of a base64-encoded representation of the arguments
  (used to detect when analysis-derived files must be regenerated).
- Files can be stamped with stored argument hashes via stamp_hash(h5file_name, new_hash).

Developer notes (concise)
-------------------------
- Main class: WIPI (subclass of WESTParallelTool)
- Key methods: add_args(parser), process_args(args), hash_args(...), stamp_hash(...)
- Integrates: WESTDataReader, ProgressIndicatorComponent, WESTParallelTool infrastructure

Example (interactive)
---------------------
Start w_ipa, then in the interactive session:

  >>> w.iteration
  1
  >>> w.current  # view available current-iteration data
  >>> tr = w.trace(12345)  # get history for segment id 12345

See also
--------
- west.cfg (analysis section) — for defining analysis schemes
- WESTPA documentation — for general usage of west commands and analysis schemes