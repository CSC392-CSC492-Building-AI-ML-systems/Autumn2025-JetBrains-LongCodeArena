Contributing to Qiskit Metal
============================

This guide describes how to contribute code, tests, and documentation to Qiskit Metal,
with specific notes for the analyses package and examples drawn from the cpw_calculations
tools included in this repository.

Why contribute
--------------
Qiskit Metal is an open-source toolkit for designing superconducting quantum devices.
Contributions improve functionality, robustness, and documentation for the whole community.
All contributions must follow the project coding standards and carry the project license header.

Project layout (relevant parts)
-------------------------------
- qiskit_metal/analyses
  - Submodules: cpw_calculations, lumped_capacitive, ...
  - Purpose: analytical and semi-analytical tools used by components and examples.

Example: cpw_calculations
-------------------------
The cpw_calculations module contains numerical utilities used by components and examples.
Functions follow a simple, well-documented interface. Examples included in the project:

- guided_wavelength(freq, line_width, line_gap, substrate_thickness, film_thickness, dielectric_constant=11.45)
  - Returns: (lambdaG, etfSqrt, q)
  - Purpose: compute guided wavelength and effective dielectric accounting for film thickness.

- lumped_cpw(freq, line_width, line_gap, substrate_thickness, film_thickness,
             dielectric_constant=11.45, loss_tangent=1e-5, london_penetration_depth=30e-9)
  - Returns: (Lk, Lext, C, G, Z0, etfSqrt**2, Cstar)
  - Purpose: compute lumped-element equivalent of a CPW at a frequency, including kinetic inductance.

When adding or modifying analyses, follow the patterns above: clear, typed arguments,
returned tuple meanings documented in the docstring, and unit-consistent SI units.

Getting started
---------------
1. Fork the repository and create a feature branch for your change.
2. Keep commits focused and descriptive. Use rebase/squash where appropriate before submitting a PR.
3. Ensure you keep the project license header in any new or modified files.

Coding conventions
------------------
- Python 3.x compatibility.
- Follow PEP8 for formatting; prefer 4-space indentation.
- Use clear, complete docstrings for public functions and classes. Docstrings should:
  - Briefly describe the purpose.
  - List arguments and units.
  - Describe return values and units.
- Use explicit imports and avoid wildcard imports.
- Use numpy for numerical work and scipy where needed (as in cpw_calculations).
- Keep top-level module state minimal; functions should be pure where practical.

Type hints and typing
---------------------
- Adding type hints to functions is encouraged for new code.
- Use typing annotations for public APIs where practical.

Tests
-----
- Add unit tests for new functionality under the tests/ directory, mirroring existing structure.
- Tests should be deterministic and not require network access or proprietary software.
- For numerical functions, use tolerances appropriate to floating-point calculations.
- Run the full test suite locally (or via CI) before submitting a PR.

Documentation
-------------
- Public APIs must have clear docstrings (see example functions in cpw_calculations).
- Include examples in docstrings where useful; keep examples concise and unit-correct.
- Update autosummary entries when adding new public submodules or top-level functions to ensure they appear in generated API docs.

Analyses and API stability
--------------------------
- Analyses are part of the public API: changes that affect function signatures or return formats must be flagged in PR descriptions and documented in release notes.
- Preserve backward compatibility where feasible. If an incompatible change is necessary, follow semantic versioning practices and document migration steps.

Performance and numerical robustness
------------------------------------
- For numerical routines (electromagnetics, CPW calculators, quantization helpers), prefer clear, well-tested algorithms.
- Validate inputs early (e.g., non-zero, positive dimensions) and raise informative exceptions.
- Document assumptions (e.g., relative permeability = 1, far-away grounds, lossless superconductor).

Licensing, copyright, and attributions
--------------------------------------
- All source files must carry the project license header (Apache License, Version 2.0).
- If you adapt third-party code, include proper attribution and ensure license compatibility.
- Modified files should have a note indicating the change from the original where appropriate.

Code review and pull requests
-----------------------------
- Open a Pull Request (PR) against the main repository branch from your feature branch.
- In your PR description:
  - Summarize what the change does and why it is needed.
  - Note any API changes or expected impacts on downstream code.
  - Reference any related issues.
- Add tests and doc updates to the PR.
- Address review comments promptly and keep commits tidy.

Issue reporting
---------------
- Open issues with a clear title, description, reproduction steps, and minimal code examples when applicable.
- Label issues as bug, enhancement, docs, or question to aid triage.

Maintainers and contacts
------------------------
- Respect maintainers’ time: provide sufficient context and tests for contributions.
- Engage on GitHub issues and PRs for discussion; maintainers will advise on design and review.

Authors and acknowledgements
----------------------------
- Original authors (as seen in code headers) should be retained in file headers where present.
- Keep author metadata when editing existing files.

Appendix: Checklist for contributors
------------------------------------
- [ ] License header present in new/modified files.
- [ ] Docstring for all new public functions/classes, with units and return description.
- [ ] Unit tests added and passing.
- [ ] Code follows PEP8 and project conventions.
- [ ] PR description documents changes and any API impacts.

Thank you for contributing to Qiskit Metal — your improvements help the community build better quantum devices.