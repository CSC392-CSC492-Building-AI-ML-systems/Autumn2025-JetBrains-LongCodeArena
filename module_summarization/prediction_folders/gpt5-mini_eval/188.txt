kernel_approximation — Functions that approximate kernel feature maps
====================================================================

The sklearn.kernel_approximation module implements several approximate kernel
feature maps based on random projections, Fourier transforms and Count Sketches.
These approximations enable the use of linear methods in the transformed
feature space to approximate non-linear kernels efficiently on large datasets.

Overview
--------
Approximating the feature map Phi(x) for a kernel K(x, y) allows one to apply
linear estimators on transformed features Z = Phi(X) such that

    K(x, y) ≈ <Phi(x), Phi(y)>.

Common approaches implemented in this module include random Fourier features
(for shift-invariant kernels such as the RBF kernel), Count Sketch / Tensor
Sketch for polynomial kernels, and other samplers for additive kernels.
These methods trade off statistical accuracy for computational and memory
efficiency and are especially useful when working with large numbers of
samples.

PolynomialCountSketch
---------------------
PolynomialCountSketch implements Tensor Sketch to approximate the feature
map of the polynomial kernel

    K(x, y) = (gamma * <x, y> + coef0) ** degree

by computing a Count Sketch of the outer product (tensor) of a vector with
itself using Fast Fourier Transforms (FFT). This yields a compact randomized
feature map of dimensionality n_components that approximates the full
polynomial feature map at much lower cost and memory.

Key parameters
- gamma : float (default=1.0)
  Scaling factor of the polynomial kernel.
- degree : int (default=2)
  Degree of the polynomial kernel.
- coef0 : float (default=0)
  Additive constant in the polynomial kernel.
- n_components : int (default=100)
  Dimensionality of the output approximate feature space. Larger values
  increase approximation fidelity at higher computational cost.
- random_state : int, RandomState instance or None
  Controls random initialization for hash functions used by Count Sketch.

Attributes (after fit)
- indexHash_ : ndarray, shape (degree, n_features)
  Integer indices in [0, n_components) representing the hash functions
  used to map tensor coordinates into the sketch.
- bitHash_ : ndarray, shape (degree, n_features)
  Random signs (+1 or -1) used by the Count Sketch.
- n_features_in_ : int
  Number of features seen during fit.
- feature_names_in_ : ndarray of feature names (if input provided with names)
  Present when X passed to fit has string feature names.

Notes
- If coef0 != 0, an additional constant feature is implicitly considered when
  constructing the sketch (matching the effect of the additive term in the
  polynomial kernel).
- The recommended n_components depends on the problem; practical trade-offs
  often place n_components on the order of 10 * n_features, but this varies
  with dataset and desired accuracy.

Example
-------
>>> from sklearn.kernel_approximation import PolynomialCountSketch
>>> from sklearn.linear_model import SGDClassifier
>>> X = [[0, 0], [1, 1], [1, 0], [0, 1]]
>>> y = [0, 0, 1, 1]
>>> ps = PolynomialCountSketch(degree=3, random_state=1)
>>> X_features = ps.fit_transform(X)
>>> clf = SGDClassifier(max_iter=10, tol=1e-3)
>>> clf.fit(X_features, y)
SGDClassifier(max_iter=10)
>>> clf.score(X_features, y)
1.0

Related approximations
----------------------
- RBFSampler
  Approximates the feature map of the RBF (Gaussian) kernel using random
  Fourier features.
- Nystroem
  Uses a subset of the training data to construct an approximate low-rank
  feature map for a generic kernel function.
- AdditiveChi2Sampler, SkewedChi2Sampler
  Samplers that approximate additive chi-squared and skewed chi-squared
  kernels respectively, suitable for non-negative histogram-like data.

See also
--------
sklearn.metrics.pairwise.kernel_metrics
    Reference list of built-in kernel functions and parameters.
sklearn.kernel_approximation.RBFSampler
sklearn.kernel_approximation.Nystroem
sklearn.kernel_approximation.AdditiveChi2Sampler
sklearn.kernel_approximation.SkewedChi2Sampler

Version notes
-------------
PolynomialCountSketch was added in scikit-learn 0.24.