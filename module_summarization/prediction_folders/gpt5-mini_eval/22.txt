w_fluxanl — Flux analysis and bootstrap confidence intervals
===========================================================

Synopsis
--------
w_fluxanl [DATA-OPTIONS] [ITERATION-RANGE] [OUTPUT-OPTIONS] [ANALYSIS-OPTIONS]

Description
-----------
w_fluxanl extracts fluxes into pre-defined target states from WEST HDF5 data, computes averages, and constructs confidence intervals using Monte Carlo bootstrapping to account for correlated and potentially non‑Gaussian statistical error in flux measurements.

All non‑graphical output (terminal and HDF5) assumes the WEST propagation/resampling interval tau = 1. To convert results to physical units, divide fluxes and multiply correlation lengths by the true tau.

Primary behaviors
- Read WEST HDF5 data (supports legacy file versions <7 and version >=7).
- Extract per-iteration flux entries for each target state (iteration number, flux, and count).
- Compute average flux, bootstrap confidence intervals, and an estimate of correlation length for each target.
- Optionally produce time‑evolution results (flux vs iteration) rather than or in addition to aggregate statistics.
- Write results to an HDF5 output file and print summary to the terminal.

Input data and extraction details
-------------------------------
- For HDF5 file versions < 7, recycling information is stored in each iteration group under a 'recycling' table. The tool reads per-target recycling rows (fields include weight/flux and count).
- For file versions >= 7, recycling/new weight information is stored in the "new_weights" group of the iteration *following* recycling events. The tool scans new_weights indices and associates recycled weights with the target state to build per‑iteration flux time series.
- The extractor returns, for each target (by label if available, otherwise by index), a 1-D array of entries of dtype fluxentry_dtype with fields:
  - n_iter: iteration number
  - flux: measured flux (units of 1/tau)
  - count: number of recycled trajectories (or -1 sentinel if target absent)

Output
------
w_fluxanl writes summary statistics and (optionally) evolution data to an HDF5 output group. The output includes, for each target:
- mean_flux: estimated mean flux (units of 1/tau)
- mean_flux_ci_lb, mean_flux_ci_ub: lower and upper confidence interval bounds
- mean_flux_correl_len: estimated correlation length (in iterations; scale by tau for real units)
- (optionally) time series of per-iteration flux entries and bootstrap sample results when evolution mode is requested

The tool tracks an internal output format version (currently 2) so downstream tools can parse the layout.

Analysis and statistical methods
-------------------------------
- Monte Carlo bootstrapping is used to form confidence intervals, explicitly accounting for correlation and non‑Gaussian behavior in the flux measurements.
- An autocorrelation correction/parameter (autocorrel_alpha) and related options control how correlated samples are treated during bootstrap resampling and during correlation length estimation.
- The tool estimates a correlation length for each target; this quantity describes the effective number of independent samples and is returned along with flux means and confidence intervals.

Main configurable options
-------------------------
(Names shown conceptually; the exact command-line flags are provided by the tool front-end.)
- Data selection:
  - Data source / WEST data directory or HDF5 data file selection options (as provided by the WESTDataReader helper).
  - Iteration selection: start/stop and other iteration range selectors (provided by IterRangeSelection).
- Output:
  - Output HDF5 file path and output group name.
  - Optionally specify per-target output groups or to append to an existing HDF5 file.
- Statistical parameters:
  - alpha: desired significance level for confidence intervals (e.g., 0.05 for 95% CIs).
  - autocorrel_alpha: parameter controlling autocorrelation handling in resampling or CI construction.
  - n_sets: number of Monte Carlo/bootstrap samples to draw.
- Evolution mode:
  - do_evol: enable computation of time‑evolving statistics (flux vs iteration).
  - evol_step: interval (in iterations) between reported evolution points.

Usage examples
--------------
Extract overall flux statistics into an HDF5 file with 95% confidence intervals using 2000 bootstrap samples:
  w_fluxanl -o flux_summary.h5 --alpha 0.05 --n-sets 2000 [DATA-OPTIONS] [ITER-RANGE]

Produce time‑evolving flux estimates reported every 5 iterations:
  w_fluxanl -o flux_evol.h5 --evol --evol-step 5 --n-sets 1000 [DATA-OPTIONS] [ITER-RANGE]

Notes and caveats
-----------------
- All fluxes are reported in units of 1/tau. Multiply fluxes by 1/tau_true and divide correlation lengths by 1/tau_true if tau != 1.
- For HDF5 files with version >= 7 the tool infers per-target fluxes by examining new_weights entries in the iteration following recycling events. This approach is efficient but does not trace individual trajectories; if target definitions change during a trajectory trace, results may not reflect that complexity.
- Targets are identified by label if available in the dataset; otherwise an index is used.

See also
--------
westpa.tools.WESTTool, westpa.tools.WESTDataReader, IterRangeSelection, westpa.core.we_driver.NewWeightEntry

Authors
-------
Implementation based on WESTPA tool suite (see package metadata for authorship).