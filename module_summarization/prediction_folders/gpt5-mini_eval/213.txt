Nonparametric Methods
=====================

Univariate Kernel Density Estimators
-----------------------------------

This module provides univariate kernel density estimation utilities centered
on the `KDEUnivariate` class. The implementation is FFT-accelerated for
continuous univariate data and provides a flexible interface for kernel and
bandwidth selection, optional weighting, and evaluation of density-related
quantities.

References
----------
Racine, Jeff. (2008). Nonparametric Econometrics: A Primer.
    Foundation and Trends in Econometrics: Vol 3: No 1, pp.1-88.
    http://dx.doi.org/10.1561/0800000009

Silverman, B. W. Density Estimation for Statistics and Data Analysis.

https://en.wikipedia.org/wiki/Kernel_%28statistics%29

Overview
--------
KDEUnivariate implements a univariate kernel density estimator (KDE). It is
highly optimized for the univariate continuous case using an FFT-based
algorithm (when applicable) and should be preferred over multivariate
implementations for single-variable density estimation. For mixed or
multidimensional data, use `KDEMultivariate`.

Key features
- FFT-based density estimator for speed (Gaussian kernel only).
- Direct (non-FFT) estimator for arbitrary kernels.
- Flexible bandwidth selection: built-in rules, user-specified floats, or a
  callable.
- Optional observation weights (not supported with FFT).
- Support for evaluation of density, cumulative distribution (CDF),
  survival function (SF), and related quantities.
- Kernel selection among common symmetric kernels.

Kernels
-------
Available kernel choices (short names used by the API) map to kernel
implementations:

- "gau"  — Gaussian
- "epa"  — Epanechnikov
- "uni"  — Uniform
- "tri"  — Triangular
- "biw"  — Biweight
- "triw" — Triweight
- "cos"  — Cosine
- "cos2" — Cosine2

(The FFT implementation currently supports only the Gaussian kernel.)

KDEUnivariate
-------------
Class: KDEUnivariate(endog)

Parameters
- endog : array_like
  One-dimensional input data for which the density estimate is desired.

Primary methods and attributes
- fit(kernel='gau', bw='normal_reference', fft=True, weights=None,
      gridsize=None, adjust=1, cut=3, clip=(-inf, inf))
  Fit the KDE and attach results to the instance.

  Parameters
  - kernel : str
    Kernel identifier (see Kernel list).
  - bw : str | float | callable
    Bandwidth specification. Supported string rules include:
      * "scott" — 1.059 * A * n ** (-1/5), A = min(std(x), IQR/1.34)
      * "silverman" — 0.9 * A * n ** (-1/5)
      * "normal_reference" — kernel-dependent constant * A * n ** (-1/5)
    If a float is provided it is used directly. If a callable is provided,
    it must accept exactly two arguments (x, kern) and return a float.
  - fft : bool
    Use FFT-based convolution (faster). Only available for the Gaussian
    kernel. When True, weights are not supported.
  - weights : array_like or None
    Observation weights. Not implemented for FFT mode.
  - gridsize : int or None
    Number of grid points for evaluation. If None, defaults to
    max(len(x), 50).
  - adjust : float
    Bandwidth adjustment multiplier (bw -> bw * adjust).
  - cut : float
    Extends the grid beyond the data extrema by cut * bw on each side.
  - clip : (low, high)
    Clip input data before estimation.

  Returns
  - self : KDEUnivariate (fitted). After fitting, the instance contains:
    * density : ndarray — estimated density evaluated on `support`.
    * support : ndarray — evaluation grid.
    * bw : float — final bandwidth used.
    * kernel : kernel instance — instantiated kernel (weights attached).
    * bw_method : str — name of bandwidth method used.
    * _cache : dict — internal cache cleared on re-fit.

Notes
- When FFT is used for fitting, some derived quantities (cdf, sf,
  cumhazard, entropy) are computed from the analytic kernel definition
  rather than from the FFT approximation to ensure correctness at the
  support points.
- If observation weights are provided, the kernel's weights are
  normalized to sum to 1.
- If a callable bandwidth is supplied, it receives the clipped input data
  and the kernel instance and must return a scalar bandwidth.

Evaluation helpers
- cdf (cached property)
  Returns the cumulative distribution function evaluated at the support.
  Requires the object to be fit first.

Internal utilities and related functions
- kdensity
  Direct (non-FFT) kernel density computation used when fft=False.
- kdensityfft
  FFT-based kernel density computation used when fft=True and kernel='gau'.
- kdetools, linbin, and bandwidths modules
  Provide helper routines for kernel evaluation, fast linear binning, and
  bandwidth selection rules.

Example
-------
Typical usage:

>>> import numpy as np
>>> from statsmodels.nonparametric import KDEUnivariate
>>> x = np.random.normal(size=300)
>>> kde = KDEUnivariate(x).fit()
>>> density = kde.density
>>> support = kde.support
>>> bw = kde.bw

See also
--------
- KDEMultivariate — multivariate and mixed data KDEs.
- kdensity, kdensityfft — underlying density computation functions.

Notes and Implementation Details
-------------------------------
- The class uses an internal mapping to instantiate kernel objects based on
  the short string names. The kernel instance is recreated on each fit to
  ensure state consistency.
- The FFT-based implementation is typically much faster and is the
  recommended choice for continuous univariate data when using the
  Gaussian kernel.