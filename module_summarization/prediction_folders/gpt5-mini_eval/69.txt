Isotonic regression
===================

This module provides utilities and estimators for isotonic (monotonic)
regression: a non-parametric regression technique that fits a monotone
function to data. The primary components are:

- check_increasing: determine whether two arrays are monotonically
  correlated using a Spearman correlation test.
- isotonic_regression: a low-level solver that returns the isotonic fit of
  a 1-D array.
- IsotonicRegression: an estimator/transformer implementing isotonic
  regression with options for bounds and out-of-range behavior.

Overview
--------

Isotonic regression finds a non-decreasing (or non-increasing) sequence
that best fits observed values, often used when a monotonic relationship
between the predictor and response is expected but the functional form is
unknown. The implementations use an active-set approach for efficient
computation.

Functions
---------

check_increasing(x, y)
    Determine whether `y` is monotonically correlated with `x` using the
    Spearman rank correlation coefficient.

    Parameters
    ----------
    x : array-like of shape (n_samples,)
        Input values.
    y : array-like of shape (n_samples,)
        Target values.

    Returns
    -------
    increasing_bool : bool
        True if the Spearman correlation estimate is non-negative
        (indicating an increasing relationship), False otherwise.

    Notes
    -----
    - The sign of the Spearman rho estimate is used to infer increasing vs.
      decreasing. A warning is raised if the 95% confidence interval (via
      Fisher transform) spans zero, indicating an uncertain determination.

isotonic_regression(y, *, sample_weight=None, y_min=None, y_max=None, increasing=True)
    Solve the isotonic regression problem for a 1-D array.

    Parameters
    ----------
    y : array-like of shape (n_samples,)
        The data to be fitted.
    sample_weight : array-like of shape (n_samples,), default=None
        Optional per-sample weights. If None, equal weights are used.
    y_min : float or None, default=None
        Optional lower bound on the fitted values (the minimum returned
        value may still be higher). If None, no lower bound is applied.
    y_max : float or None, default=None
        Optional upper bound on the fitted values (the maximum returned
        value may still be lower). If None, no upper bound is applied.
    increasing : bool, default=True
        If True, fit a non-decreasing sequence; if False, fit a
        non-increasing sequence.

    Returns
    -------
    y_ : ndarray of shape (n_samples,)
        The isotonic fit of `y`.

    Notes
    -----
    - The algorithm is an in-place, contiguous implementation of the
      active-set isotonic regression solver.
    - Bounds `y_min` and `y_max` are applied after solving (via clipping).

    References
    ----------
    Best, M. J. and Chakravarti, N., "Active set algorithms for isotonic
    regression; A unifying framework".

IsotonicRegression class
------------------------

class IsotonicRegression(y_min=None, y_max=None, increasing=True, out_of_bounds='nan', ...)
    Isotonic regression estimator and transformer.

    The estimator fits a monotonic function f such that f(X) is monotone
    (non-decreasing or non-increasing) and approximates the provided target
    values. It can be used both as a regressor (via fit/predict) and as a
    transformer (via transform) to map input values to fitted target
    values.

    Parameters
    ----------
    y_min : float, default=None
        Lower bound on the lowest predicted value. If None, no lower bound
        is enforced.
    y_max : float, default=None
        Upper bound on the highest predicted value. If None, no upper bound
        is enforced.
    increasing : bool or {'auto'}, default=True
        - If bool, forces the fitted function to be non-decreasing
          (True) or non-increasing (False).
        - If 'auto', the direction is decided automatically using a
          Spearman correlation test (see `check_increasing`).
    out_of_bounds : {'nan', 'clip', 'raise'}, default='nan'
        How to handle prediction for `X` values outside the domain seen at
        training time:
        - 'nan': return NaN for out-of-range inputs.
        - 'clip': clip to the nearest endpoint of the training domain and
          return that value.
        - 'raise': raise a ValueError for out-of-range inputs.

    Attributes
    ----------
    X_min_ : float
        Minimum value of training inputs used for left bound during
        prediction.
    X_max_ : float
        Maximum value of training inputs used for right bound during
        prediction.
    X_thresholds_ : ndarray of shape (n_thresholds,)
        Unique ascending `X` values used as interpolation knots for the
        fitted monotonic function.
    y_thresholds_ : ndarray of shape (n_thresholds,)
        Fitted `y` values corresponding to `X_thresholds_`. The monotonic
        mapping is defined by linear interpolation between these
        thresholds.

    Notes
    -----
    - This estimator implements the scikit-learn estimator API semantics:
      it provides `fit`, `predict`, and `transform` methods (inherited from
      base classes). Predictions for inputs between threshold knots are
      obtained by linear interpolation.
    - When `increasing='auto'`, the sign of the Spearman correlation
      estimate determines the monotonicity direction; a warning may be
      issued if the sign is uncertain.

Examples
--------

Basic usage of the functional API:

>>> from isotonic import isotonic_regression
>>> y = [3.0, 2.0, 4.0, 1.0]
>>> isotonic_regression(y, increasing=True)
array([2.5, 2.5, 3.5, 1.0])  # example output (illustrative)

Using the estimator:

>>> from isotonic import IsotonicRegression
>>> iso = IsotonicRegression(increasing='auto', out_of_bounds='clip')
>>> iso.fit(X_train, y_train)
>>> y_pred = iso.predict(X_test)

Warnings and error handling
---------------------------
- If the Spearman-based direction decision is ambiguous (confidence
  interval spans zero), `check_increasing` will issue a warning.
- The estimator's `out_of_bounds` parameter controls behavior for inputs
  outside the training range; invalid option values raise errors.

References
----------
- Best, M. J. and Chakravarti, N., "Active set algorithms for isotonic
  regression; A unifying framework".
- Fisher transformation. (Used for Spearman rho confidence intervals.)

See also
--------
- check_increasing
- isotonic_regression

(End of isotonic module documentation.)