Gaussian processes
==================

This module implements kernel objects and supporting utilities used for
Gaussian process regression and classification. It provides a flexible
kernel-engineering framework, hyperparameter specification, and support
for analytic gradient-based hyperparameter optimization.

Overview
--------
- Kernels represent covariance functions between input points and are the
  core building blocks of Gaussian process models.
- Kernels can be composed using algebraic operators to build expressive
  covariance models: sums (``+``), products (``*``) and scalar exponentiation
  (``**``). Scalar values appearing in such expressions are automatically
  converted to constant kernels.
- All kernels expose hyperparameters with bounds or can be marked as fixed.
  Hyperparameters support analytic gradients and can be optimized within a
  rectangular search space defined by per-parameter bounds.

Kernels and kernel composition
------------------------------
- Kernel objects implement covariance computations and encapsulate
  hyperparameters (e.g., length-scales, variances).
- Kernel expressions can be built by combining kernel instances using
  ``+`` and ``*`` operators; these expressions themselves behave as kernels.
- Exponentiation of kernels by scalars (``kernel ** scalar``) is supported.
- Scalars used in kernel expressions are implicitly treated as
  ``ConstantKernel`` instances (a constant kernel that contributes an
  additive constant covariance).

Hyperparameters
---------------
- Hyperparameters are described by the ``Hyperparameter`` namedtuple with
  fields:
  - ``name`` — string identifier for the hyperparameter (corresponds to the
    kernel attribute name).
  - ``value_type`` — type of the hyperparameter (currently ``'numeric'``).
  - ``bounds`` — either a pair of floats (lower and upper bound), a 2‑D
    array (for vector-valued parameters), or the string ``'fixed'`` to mark
    the hyperparameter as not optimizable.
  - ``n_elements`` — number of elements of the hyperparameter (1 for scalar,
    >1 for vector-valued quantities such as anisotropic length-scales).
  - ``fixed`` — boolean flag indicating whether the hyperparameter is fixed.
- When ``bounds`` are provided for a vector-valued hyperparameter with
  ``n_elements > 1``, a single pair of bounds can be broadcasted to all
  elements or a separate pair per element can be supplied.
- If ``fixed`` is not explicitly provided, it is derived from the value of
  ``bounds`` (``'fixed'`` bounds mark the hyperparameter as fixed).

Validation and utilities
------------------------
- The helper function ``_check_length_scale(X, length_scale)`` validates and
  normalizes length-scale inputs:
  - Converts to a squeezed float array.
  - Raises if ``length_scale`` has dimension > 1.
  - For anisotropic length-scales (1‑D array), checks that the number of
    length-scale entries matches the data dimensionality (``X.shape[1]``).
- Kernel implementations should validate and use this helper where
  appropriate.

Hyperparameter optimization
---------------------------
- Kernels expose analytic gradients for their hyperparameters where available,
  enabling gradient-based optimization of kernel hyperparameters.
- The optimization search space is rectangular: each hyperparameter has a
  lower and upper bound (or is fixed). Vector-valued hyperparameters are
  treated elementwise with corresponding bounds.
- Fixed hyperparameters are excluded from optimization.

Kernel API and parameter handling
---------------------------------
- Kernel classes derive from a common abstract ``Kernel`` base class.
- ``Kernel.get_params(deep=True)`` inspects the kernel constructor signature
  to return a mapping of parameter names to values (consistent with
  estimator-style parameter semantics).
- Kernel implementations are expected to declare all constructor parameters
  explicitly (no varargs in the constructor signature). A runtime error is
  raised if varargs are present, enforcing explicit parameter naming.

Examples
--------
- Build composite kernels:
  - Sum: ``k = k1 + k2``
  - Product: ``k = k1 * k2``
  - Scaled/constant contributions: ``k = 2.0 * k1`` (scalar converted to a
    constant kernel)
  - Power: ``k = k1 ** 2``

- Specify hyperparameter bounds and fixed flags when constructing kernels
  to control hyperparameter tuning and optimization.

See also
--------
- Kernel-specific implementations (e.g., radial basis, Matern, rational
  quadratic, constant kernels) for concrete hyperparameter names, default
  values and gradient implementations.
- Gaussian process regression and classification wrappers for usage of
  kernels within models that perform training and prediction.