w_bins â€” Display and modify binning for a WEST simulation
=========================================================

Synopsis
--------
w_bins <command> [OPTIONS] [binning options]

Description
-----------
w_bins inspects binning used in a WEST simulation and can optionally rebuild
the current iteration using a new binning (rebin). The tool reads the WEST HDF5
data file (via WESTDataReader) and uses the BinMappingComponent to construct or
interpret bin mappings.

Commands
--------
info
    Display information and statistics about the binning for a given iteration.

    Behavior
    - Opens the iteration group and reads initial pcoords for the specified
      iteration (default: current iteration).
    - Uses the configured bin mapper to assign initial points to bins.
    - Collects per-segment weights and target-state information.
    - Prints a summary of bin counts and weights. With --detail, prints
      detailed per-bin information in addition to the summary.

    Options
    - -n, --n-iter N_ITER
      Consider initial points of segment N_ITER (default: current iteration).
    - --detail
      Show detailed per-bin information.
    - Binning options (provided by BinMappingComponent)
      Configure or select the bin mapper; see the binning options for details.
      Bin-mapper arguments are accepted and parsed for this command.

rebin
    Rebuild the current iteration using a new binning definition.

    Behavior
    - Binning is performed on initial points for the specified iteration;
      recycling is not an issue because recycling for that iteration has
      already occurred.
    - The tool uses the WEST driver to perform new_iteration(), assign(),
      and rebin_current() to produce the next-iteration segments and their
      new bin assignments.
    - After computing new bin assignments and resultant weights, a summary
      (and optionally detailed per-bin information with --detail) is printed.
    - If --confirm is given, the tool commits the rebin:
      - prepares and replaces the iteration segments in the HDF5 backing store,
      - updates endpoint statuses for the previous iteration,
      - saves iteration binning information (mapper hash and pickle and
        bin-target-counts),
      - updates initial-state records and flushes changes to disk.

    Notes and constraints
    - Rebin is not supported for the first iteration (iteration 1); attempting
      to rebin iteration 1 exits with an error.
    - When running rebin, target-count arguments for bins are required (the
      tool enforces that bin-target-counts are supplied).
    - The rebin subcommand suppresses certain binning options that are not
      meaningful for rebuilding (for example, --bins-from-file is not
      available for rebin in this tool).

    Options
    - --confirm
      Commit the revised iteration to the HDF5 backing store. Without this
      option, the rebinning is only calculated and printed.
    - -n, --n-iter N_ITER
      Consider initial points of segment N_ITER (default: current iteration).
    - --detail
      Show detailed per-bin information.
    - Binning options (provided by BinMappingComponent, except options
      suppressed for rebin)
      Specify the new bin mapper and any mapper configuration.
    - Bin target counts
      Specify target counts per bin (these are required for rebin).

Common / global behavior
------------------------
- The tool opens the WEST HDF5 file in read/write mode (r+) to access
  iteration data (and to commit changes when --confirm is used).
- Default iteration is the current iteration stored in the HDF5 file,
  unless overridden with -n / --n-iter.
- For info, if no new bin mapper is provided, the tool will use the mapper
  information stored in the HDF5 file for the selected iteration.

Examples
--------
Show bin summary for the current iteration:
  w_bins info

Show detailed per-bin information for iteration 10:
  w_bins info -n 10 --detail

Compute and show effects of a proposed rebin for the current iteration
(without committing):
  w_bins rebin <binning options> <bin-target-count options>

Compute, show, and commit the rebin for iteration 5:
  w_bins rebin -n 5 --confirm --detail <binning options> <bin-target-count options>

Notes
-----
- Binning options and the syntax for specifying bin-target-counts come from
  the BinMappingComponent used by WESTTools; consult the binning documentation
  or the tool's help output (w_bins <command> --help) for the full list of
  available binning arguments.