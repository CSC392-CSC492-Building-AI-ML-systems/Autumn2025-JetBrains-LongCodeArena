w_stateprobs
=============

Deprecated
----------
w_stateprobs is deprecated. Use w_direct instead. Invoking w_stateprobs will emit a deprecation warning and dispatch to the equivalent w_direct subcommand.

Synopsis
--------
w_stateprobs trace [OPTIONS]

Brief description
-----------------
Calculate average state populations and associated confidence intervals from
weighted-ensemble trajectory data by tracing trajectories through bin/macrostate
assignments. Bin assignments (including macrostate definitions) are required
(see w_assign).

Defaults
--------
- default output file: stateprobs.h5
- default kinetics/assignments file: assign.h5

Output format
-------------
The output HDF5 file (specified with -o/--output, default usually "stateprobs.h5")
contains the following dataset(s):

/avg_state_pops [state]
  Structured array giving the averaged population of each state across the
  averaging range specified.

/state_pop_evolution [window][state]  (only when --evolution-mode is used)
  Structured array giving state populations computed over windows of
  iterations. If --evolution-mode=cumulative, windows begin at --start-iter and
  grow by --step-iter for each successive element. If --evolution-mode=blocked,
  windows are of width --step-iter (the last may be shorter), with the first
  window beginning at --start-iter.

Structure of dataset records
----------------------------
Each record in the structured arrays contains the following fields:

- iter_start
  (Integer) Iteration at which the averaging window begins (inclusive).

- iter_stop
  (Integer) Iteration at which the averaging window ends (exclusive).

- expected
  (Floating-point) Expected (mean) population value within this window
  (units: inverse tau for rate-like quantities; population is unitless).

- ci_lbound
  (Floating-point) Lower bound of the confidence interval within this window.

- ci_ubound
  (Floating-point) Upper bound of the confidence interval within this window.

- corr_len
  (Integer) Correlation length within this window (in units of tau).

Dataset attributes
------------------
The datasets include the following attributes:

- mcbs_alpha
  (Floating-point) Alpha value used for confidence intervals (e.g., 0.05 for
  95% CI).

- mcbs_nsets
  (Integer) Number of bootstrap data sets used to generate confidence intervals.

- mcbs_acalpha
  (Floating-point) Alpha used when determining correlation lengths.

Command-line options
--------------------
Common options include:

- -o, --output FILE
  Output HDF5 file (default: stateprobs.h5).

- --evolution-mode MODE
  If specified, produce /state_pop_evolution. MODE may be "cumulative" or
  "blocked" (see Output format).

- --start-iter N
  Starting iteration for evolution windows.

- --step-iter N
  Step (window width or growth increment) for evolution windows.

Notes
-----
Bin assignments/macrostates must be available (assignments typically come from
assign.h5). Output interpretation assumes iterations and tau-based units as
described above.