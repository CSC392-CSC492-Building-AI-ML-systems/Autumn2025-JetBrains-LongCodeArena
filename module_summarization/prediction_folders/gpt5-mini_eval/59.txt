Quantile Regression (QuantReg)
=============================

Overview
--------
This module implements a Quantile Regression estimator based on Iteratively
Reweighted Least Squares (IRLS). It provides tools to estimate conditional
quantiles of the response variable given explanatory variables, including
special-case Least Absolute Deviations (LAD) when the quantile is 0.5.
Asymptotic covariance matrices for parameter estimates are estimated using
kernel density methods.

Class: QuantReg
---------------
QuantReg(endog, exog, **kwargs)

A RegressionModel subclass that fits linear quantile regression models.

Parameters
- endog : array-like
  Endogenous (dependent) variable.
- exog : array-like
  Exogenous (independent) variables (design matrix). The model handles the
  usual constant column parsing through the parent RegressionModel.

Attributes set on fit
- params : ndarray
  Estimated regression coefficients.
- nobs : int
  Number of observations.
- rank : int
  Matrix rank of the regressors.
- df_model, df_resid : floats
  Degrees of freedom for the model and residuals (set from rank and constants).

Key methods
- whiten(data)
  - Returns data unchanged. Provided for compatibility with the RegressionModel
    interface; QuantReg does not apply a whitening transformation.
- fit(q=0.5, vcov='robust', kernel='epa', bandwidth='hsheather',
      max_iter=1000, p_tol=1e-6, **kwargs)
  Estimate quantile regression coefficients via IRLS.

  Parameters
  - q : float, optional
    Target quantile in (0, 1). q=0.5 corresponds to LAD.
  - vcov : {'robust', 'iid'}, optional
    Method for computing the variance-covariance matrix of parameter
    estimates:
      - 'robust' : heteroskedasticity-robust standard errors (default);
      - 'iid' : assume independent and identically distributed errors.
  - kernel : {'epa', 'cos', 'gau', 'par', 'biw'}, optional
    Kernel used in kernel density estimation for asymptotic covariance:
      - 'epa' : Epanechnikov
      - 'cos' : Cosine
      - 'gau' : Gaussian
      - 'par' : Parzen
      - 'biw' : biweight (available in implementation)
  - bandwidth : {'hsheather', 'bofinger', 'chamberlain'}, optional
    Bandwidth selection method for kernel density estimation:
      - 'hsheather' : Hall & Sheather (1988) [default]
      - 'bofinger'  : Bofinger (1975)
      - 'chamberlain': Chamberlain (1994)
  - max_iter : int, optional
    Maximum iterations for the IRLS algorithm (default 1000).
  - p_tol : float, optional
    Parameter convergence tolerance (default 1e-6).
  - **kwargs : dict
    Forwarded to result construction/other options as implemented.

Behavior and details
- Estimation algorithm
  The model is solved by repeated reweighted least squares: at each iteration
  residuals are reweighted according to the quantile loss function and a
  weighted least squares update is performed. Iteration continues until the
  maximum change in parameters is below p_tol or max_iter is reached.
- Starting values
  The routine uses an OLS-based starting point for iterations by default.
- Small-residual handling
  Very small residuals are adjusted to avoid division by zero in the
  reweighting step; the implementation safeguards against exact zeros.
- Variance estimation
  Asymptotic covariance matrix estimation follows Greene (2008) using a
  kernel density estimate of the error density at the targeted quantile.
  Choice of kernel and bandwidth selection method affect this estimate.
- Input validation
  The fit method validates q and ensures kernel and bandwidth arguments are
  among the supported options.

Return value
- The fit method returns an object consistent with the statsmodels
  RegressionResults conventions (RegressionResults / wrapper), containing
  estimated parameters, standard errors, covariances, and additional
  diagnostic attributes.

Notes
-----
- LAD (Least Absolute Deviations) corresponds to q=0.5.
- The implementation is intended for cross-sectional linear quantile
  regression and provides asymptotic inference using kernel-based density
  estimates; finite-sample properties depend on sample size and model fit.
- Users should ensure exogenous variables are appropriately specified (e.g.
  include a constant if an intercept is desired).

References
----------
- Koenker, R. (2005). Quantile Regression. Cambridge University Press.
- Greene, W. H. (2008). Econometric Analysis. 6th ed. (see kernel-based
  covariance estimation discussion).
- Hall, P. and S. Sheather (1988). On the distribution of the Studentized
  quantile. Journal of the Royal Statistical Society, Series B 50: 381–391.
- Bofinger, E. (1975). Estimation of a density function using order
  statistics. Australian Journal of Statistics 17: 1–18.
- Chamberlain, G. (1994). Quantile regression, censoring, and the
  structure of wages. In Advances in Econometrics, Vol. 1: Sixth World
  Congress.

Examples
--------
Basic usage example (conceptual)
- Create the model: mod = QuantReg(endog, exog)
- Fit the median (LAD) regression: res = mod.fit(q=0.5)
- Fit a 0.25-quantile with Gaussian kernel and Chamberlain bandwidth:
  res = mod.fit(q=0.25, kernel='gau', bandwidth='chamberlain')

See the class and method docstrings for parameter details and options.